System.register(["jimu-core","jimu-for-builder","jimu-for-builder/templates","jimu-layouts/layout-builder","jimu-layouts/layout-runtime","jimu-theme","jimu-ui","jimu-ui/advanced/resource-selector","jimu-ui/advanced/setting-components","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker","jimu-ui/basic/list-tree","jimu-ui/basic/sql-expression-runtime"],(function(e,t){var i={},s={},o={},n={},a={},l={},r={},c={},p={},d={},g={},h={},m={};return{setters:[function(e){i.APP_FRAME_NAME_IN_BUILDER=e.APP_FRAME_NAME_IN_BUILDER,i.AnimationPlayMode=e.AnimationPlayMode,i.AnimationType=e.AnimationType,i.AppMode=e.AppMode,i.BrowserSizeMode=e.BrowserSizeMode,i.DataActionManager=e.DataActionManager,i.DialogInteractionType=e.DialogInteractionType,i.DialogMode=e.DialogMode,i.DialogPosition=e.DialogPosition,i.ErrorBoundary=e.ErrorBoundary,i.Immutable=e.Immutable,i.LayoutItemType=e.LayoutItemType,i.LayoutType=e.LayoutType,i.LinkType=e.LinkType,i.PageMode=e.PageMode,i.PagePart=e.PagePart,i.PageType=e.PageType,i.React=e.React,i.ReactRedux=e.ReactRedux,i.WidgetManager=e.WidgetManager,i.WidgetType=e.WidgetType,i.appActions=e.appActions,i.appConfigUtils=e.appConfigUtils,i.classNames=e.classNames,i.css=e.css,i.defaultMessages=e.defaultMessages,i.getAppStore=e.getAppStore,i.getMessageTypeLabel=e.getMessageTypeLabel,i.getNextAnimationId=e.getNextAnimationId,i.i18n=e.i18n,i.injectIntl=e.injectIntl,i.jsx=e.jsx,i.lodash=e.lodash,i.moduleLoader=e.moduleLoader,i.polished=e.polished,i.urlUtils=e.urlUtils,i.utils=e.utils,i.version=e.version},function(e){s.AppDataActionManager=e.AppDataActionManager,s.AppMessageManager=e.AppMessageManager,s.WidgetSettingManager=e.WidgetSettingManager,s.appConfigUtils=e.appConfigUtils,s.builderAppSync=e.builderAppSync,s.getAppConfigAction=e.getAppConfigAction,s.helpUtils=e.helpUtils,s.templateUtils=e.templateUtils,s.utils=e.utils},function(e){o.getScreenTemplates=e.getScreenTemplates},function(e){n.ColumnLayoutItemSetting=e.ColumnLayoutItemSetting,n.FixedLayoutItemSetting=e.FixedLayoutItemSetting,n.FlowLayoutItemSetting=e.FlowLayoutItemSetting,n.FlowLayoutSetting=e.FlowLayoutSetting,n.GridLayoutItemSetting=e.GridLayoutItemSetting,n.GridLayoutSetting=e.GridLayoutSetting,n.RowLayoutItemSetting=e.RowLayoutItemSetting},function(e){a.DEFAULT_AUTOPLAY_INTERVAL=e.DEFAULT_AUTOPLAY_INTERVAL,a.LayoutItemSizeModes=e.LayoutItemSizeModes,a.searchUtils=e.searchUtils,a.utils=e.utils},function(e){l.withTheme=e.withTheme},function(e){r.Button=e.Button,r.ButtonGroup=e.ButtonGroup,r.Checkbox=e.Checkbox,r.Collapse=e.Collapse,r.DistanceUnits=e.DistanceUnits,r.Dropdown=e.Dropdown,r.DropdownButton=e.DropdownButton,r.DropdownItem=e.DropdownItem,r.DropdownMenu=e.DropdownMenu,r.FillType=e.FillType,r.Icon=e.Icon,r.Label=e.Label,r.Link=e.Link,r.Loading=e.Loading,r.LoadingType=e.LoadingType,r.MultiSelect=e.MultiSelect,r.NumericInput=e.NumericInput,r.PanelHeader=e.PanelHeader,r.Radio=e.Radio,r.Select=e.Select,r.Slider=e.Slider,r.Switch=e.Switch,r.Tab=e.Tab,r.Tabs=e.Tabs,r.TextArea=e.TextArea,r.TextInput=e.TextInput,r.Tooltip=e.Tooltip,r.defaultMessages=e.defaultMessages,r.utils=e.utils},function(e){c.IconPicker=e.IconPicker},function(e){p.CollapsableRadio=e.CollapsableRadio,p.DirectionSelector=e.DirectionSelector,p.LinkSelectorSidePopper=e.LinkSelectorSidePopper,p.OpenTypes=e.OpenTypes,p.SettingCollapse=e.SettingCollapse,p.SettingRow=e.SettingRow,p.SettingSection=e.SettingSection,p.SidePopper=e.SidePopper,p.TemplateSelector=e.TemplateSelector},function(e){d.AnimationSettingComponent=e.AnimationSettingComponent,d.BackgroundSetting=e.BackgroundSetting,d.InputUnit=e.InputUnit,d.Padding=e.Padding,d.SizeEditor=e.SizeEditor,d.ThemeBackgroundSection=e.ThemeBackgroundSection,d.ThemeBorderSection=e.ThemeBorderSection,d.ThemeBoxShadowSection=e.ThemeBoxShadowSection},function(e){g.ThemeColorPicker=e.ThemeColorPicker},function(e){h.List=e.List,h.TreeItemActionType=e.TreeItemActionType},function(e){m.getJimuFieldNamesBySqlExpression=e.getJimuFieldNamesBySqlExpression}],execute:function(){e((()=>{var e={8371:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m6.036 12.157 8.01-8.01a.5.5 0 1 1 .707.707l-8.01 8.01a1 1 0 0 1-1.415 0L1.146 8.682a.5.5 0 1 1 .708-.707l4.182 4.182Z" fill="#000"></path></svg>'},748:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5Zm-9 0a3.501 3.501 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5ZM15.5 11l-5 1-3 4-1-9.5 9 4.5Zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38-2.517.503Z" fill="#000"></path></svg>'},5537:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5 13H1a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1h-4l.78 2.342a.5.5 0 0 1-.474.658H4.694a.5.5 0 0 1-.475-.658L5 13ZM1 3h14v9H1V3Zm5.054 10-.667 2h5.226l-.667-2H6.054Z" fill="#000"></path></svg>'},3210:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 13a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M4 5a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5Zm1 0h6v10H5V5Z" fill="#000"></path></svg>'},5369:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z" fill="#000"></path></svg>'},9694:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.04 2a.242.242 0 0 0-.04.143v12.714c0 .073.023.12.04.143h9.92a.241.241 0 0 0 .04-.143V2.143A.241.241 0 0 0 12.96 2H3.04ZM3 1c-.552 0-1 .512-1 1.143v12.714C2 15.488 2.448 16 3 16h10c.552 0 1-.512 1-1.143V2.143C14 1.512 13.552 1 13 1H3Z" fill="#000"></path></svg>'},8683:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 5H2v6h4V5ZM1 4v8h6V4H1ZM14 5h-4v6h4V5ZM9 4v8h6V4H9Z" fill="#000"></path></svg>'},760:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 2h12v4H2V2ZM1 7V1h14v6H1Zm1 3h12v4H2v-4Zm-1 5V9h14v6H1Z" fill="#000"></path></svg>'},3211:e=>{e.exports='<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM15.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM18 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0ZM17 10.5a.5.5 0 0 0-.5-.5h-13a.5.5 0 0 0 0 1h13a.5.5 0 0 0 .5-.5ZM17 14.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0 0 1h7a.5.5 0 0 0 .5-.5Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h16Zm0 1H2a1 1 0 0 0-.993.883L1 2v2h18V2a1 1 0 0 0-.883-.993L18 1Zm1 4H1v13a1 1 0 0 0 .883.993L2 19h16a1 1 0 0 0 .993-.883L19 18V5Z" fill="#000"></path></svg>'},3401:e=>{e.exports='<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM4.5 3a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM7 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0ZM3 10.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5ZM3 14.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h16Zm0 1H2a1 1 0 0 0-.993.883L1 2v2h18V2a1 1 0 0 0-.883-.993L18 1Zm1 4H1v13a1 1 0 0 0 .883.993L2 19h16a1 1 0 0 0 .993-.883L19 18V5Z" fill="#000"></path></svg>'},4786:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8ZM13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97Z" fill="#000"></path><path d="M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828L5.515 9.657Z" fill="#000"></path></svg>'},9788:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z" fill="#000"></path></svg>'},1407:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.347 2.146a.485.485 0 0 1 0 .708L5.76 8l5.587 5.146a.486.486 0 0 1 0 .708.538.538 0 0 1-.738 0l-5.956-5.5a.485.485 0 0 1 0-.708l5.956-5.5a.538.538 0 0 1 .738 0Z" fill="#000"></path></svg>'},4201:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 14a.5.5 0 0 0 0-1h-6l3.953-3.459a.5.5 0 0 0-.658-.752L8 11.234V1.5a.5.5 0 0 0-1 0v9.734L4.206 8.789a.5.5 0 0 0-.659.752L7.5 13h-6a.5.5 0 0 0 0 1h12Z" fill="#000"></path></svg>'},4703:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 0a.5.5 0 0 0-.5.5v14a.5.5 0 0 0 1 0V.5a.5.5 0 0 0-.5-.5ZM0 7.5c0 .291.231.527.516.527h3.508L2.527 9.6a.535.535 0 0 0 0 .746.508.508 0 0 0 .73 0L6 7.5 3.257 4.654a.508.508 0 0 0-.73 0 .535.535 0 0 0 0 .746l1.497 1.573H.516A.522.522 0 0 0 0 7.5Zm15 0a.522.522 0 0 1-.516.527h-3.508L12.473 9.6a.535.535 0 0 1 0 .746.508.508 0 0 1-.73 0L9 7.5l2.743-2.846a.508.508 0 0 1 .73 0 .535.535 0 0 1 0 .746l-1.497 1.573h3.508c.285 0 .516.236.516.527Z" fill="#000"></path></svg>'},1528:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 13.5a.5.5 0 0 0 1 0v-6l3.459 3.953a.5.5 0 0 0 .752-.658L3.766 8H13.5a.5.5 0 0 0 0-1H3.766l2.445-2.794a.5.5 0 1 0-.752-.659L2 7.5v-6a.5.5 0 0 0-1 0v12Z" fill="#000"></path></svg>'},7319:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14 1.5a.5.5 0 0 0-1 0v6L9.541 3.547a.5.5 0 1 0-.752.658L11.234 7H1.5a.5.5 0 0 0 0 1h9.734l-2.445 2.794a.5.5 0 1 0 .752.659L13 7.5v6a.5.5 0 0 0 1 0v-12Z" fill="#000"></path></svg>'},3166:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 1a.5.5 0 0 0 0 1h6L3.547 5.459a.5.5 0 1 0 .658.752L7 3.766V13.5a.5.5 0 0 0 1 0V3.766l2.794 2.445a.5.5 0 1 0 .659-.752L7.5 2h6a.5.5 0 0 0 0-1h-12Z" fill="#000"></path></svg>'},5234:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 2h4v4H2V2ZM1 7V1h6v6H1Zm1 3h4v4H2v-4Zm-1 5V9h6v6H1ZM14 2h-4v4h4V2ZM9 1v6h6V1H9Zm2.5 14v-2.5H9v-1h2.5V9h1v2.5H15v1h-2.5V15h-1Z" fill="#000"></path></svg>'},5339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z" fill="#000"></path></svg>'},9395:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.973 11.484c0 .285.236.516.527.516a.522.522 0 0 0 .527-.516V1.976L10.6 4.473c.206.202.54.202.746 0a.508.508 0 0 0 0-.73L7.5 0 3.654 3.743a.508.508 0 0 0 0 .73c.206.202.54.202.746 0l2.573-2.497v9.508ZM1 8v7h13V8h1v8H0V8h1Z" fill="#000"></path></svg>'},840:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 0A3.5 3.5 0 0 1 11 3.5V6h1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1V3.5A3.5 3.5 0 0 1 7.5 0ZM5 6h5V3.5a2.5 2.5 0 0 0-2.336-2.495L7.5 1a2.5 2.5 0 0 0-2.495 2.336L5 3.5V6Zm6 1H3v8h9V7h-1Zm-3.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" fill="#000"></path></svg>'},4750:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5Z" fill="#000"></path></svg>'},224:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0Zm-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707l-4.137-4.137Z" fill="#000"></path></svg>'},7322:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 3.5a3.5 3.5 0 1 0-7 0V6H3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-2V3.5l.005-.164A2.5 2.5 0 0 1 12.5 1l.164.005A2.5 2.5 0 0 1 15 3.5a.5.5 0 0 0 1 0ZM9 7H3v8h9V7H9Zm-1.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" fill="#000"></path></svg>'},1397:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm1 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-7.676 2.228H7.34c-.213-1.138.621-2.13 1.375-3.025C9.28 6.532 9.8 5.914 9.8 5.328 9.8 4.5 9.2 3.9 7.976 3.9c-.816 0-1.572.36-2.268 1.092l-.648-.6C5.852 3.552 6.788 3 8.096 3c1.692 0 2.772.864 2.772 2.244 0 .864-.652 1.628-1.3 2.387-.71.831-1.413 1.655-1.244 2.597Zm.3 2.172c0 .48-.348.792-.768.792-.432 0-.78-.312-.78-.792 0-.48.348-.804.78-.804.42 0 .768.324.768.804Z" fill="#000"></path></svg>'},8866:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16Zm0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14Z" fill="#000"></path></svg>'},7893:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjEwN3B4IiBoZWlnaHQ9IjY4cHgiIHZpZXdCb3g9IjAgMCAxMDcgNjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2MS4xICg4OTY1MCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+DQogICAgPHRpdGxlPkF1dG88L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxnIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTA2LjAwMDAwMCwgLTMwOC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwNS4wMDAwMDAsIDMwNy4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjAwMDAwMCwgMS4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwNyIgaGVpZ2h0PSI2OCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjNTI1MjUyIiB4PSI2IiB5PSIxNCIgd2lkdGg9IjkwIiBoZWlnaHQ9IjQwIj48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgIDxyZWN0IGZpbGw9IiM2QTZBNkEiIHg9IjEwMSIgeT0iMyIgd2lkdGg9IjMiIGhlaWdodD0iNDAiIHJ4PSIxLjUiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},4479:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjEwN3B4IiBoZWlnaHQ9IjY4cHgiIHZpZXdCb3g9IjAgMCAxMDcgNjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2MS4xICg4OTY1MCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+DQogICAgPHRpdGxlPkN1c3RvbTwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zODcuMDAwMDAwLCAtMzA4LjAwMDAwMCkiPg0KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzg2LjAwMDAwMCwgMzA3LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjNTI1MjUyIiB4PSIyOCIgeT0iMTQiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0MCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjMjgyODI4IiB4PSI4NyIgeT0iMCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjY4Ij48L3JlY3Q+DQogICAgICAgICAgICAgICAgICAgIDxsaW5lIHgxPSI4NyIgeTE9IjAiIHgyPSI4NyIgeTI9IjY4IiBzdHJva2U9IiM1MjUyNTIiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiIHN0cm9rZS1kYXNoYXJyYXk9IjQsNCI+PC9saW5lPg0KICAgICAgICAgICAgICAgICAgICA8cmVjdCBmaWxsPSIjMjgyODI4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iNjgiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMCIgeDI9IjIwIiB5Mj0iNjgiIHN0cm9rZT0iIzUyNTI1MiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIgc3Ryb2tlLWRhc2hhcnJheT0iNCw0Ij48L2xpbmU+DQogICAgICAgICAgICAgICAgICAgIDxyZWN0IGZpbGw9IiM2QTZBNkEiIHg9IjEwMSIgeT0iMyIgd2lkdGg9IjMiIGhlaWdodD0iNDAiIHJ4PSIxLjUiPjwvcmVjdD4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},9063:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNCIgeT0iMTAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},2884:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MSIgeT0iOSIgd2lkdGg9IjEzIiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNCIgeT0iMTAiIHdpZHRoPSIzMyIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},1937:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCA2OCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHg9IjQiIHk9IjkiIHdpZHRoPSI2IiBoZWlnaHQ9IjYiIHJ4PSIyIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MSIgeT0iMTYiIHdpZHRoPSIxMyIgaGVpZ2h0PSI2IiByeD0iMiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTQiIHk9IjEwIiB3aWR0aD0iMzMiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPC9zdmc+DQo="},8891:e=>{"use strict";e.exports=i},3137:e=>{"use strict";e.exports=s},6262:e=>{"use strict";e.exports=o},7282:e=>{"use strict";e.exports=n},4758:e=>{"use strict";e.exports=a},4796:e=>{"use strict";e.exports=l},726:e=>{"use strict";e.exports=r},663:e=>{"use strict";e.exports=c},7756:e=>{"use strict";e.exports=p},5505:e=>{"use strict";e.exports=d},1362:e=>{"use strict";e.exports=g},9587:e=>{"use strict";e.exports=h},5506:e=>{"use strict";e.exports=m}},t={};function u(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,u),o.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var i in t)u.o(t,i)&&!u.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var f={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(f),u.d(f,{default:()=>Ft});var e=u(8891),t=u(3137),i=u(726);class s extends e.React.PureComponent{constructor(){super(...arguments),this.formatMessage=e=>this.props.formatMessage(e),this.onSettingChange=(e,i)=>(0,t.getAppConfigAction)().editWidget(e,i).exec(),this.renderWidgetSetting=s=>{const o=this.props.widgetsSettingRuntimeInfo[s]&&this.props.widgetsSettingRuntimeInfo[s].isClassLoaded?t.WidgetSettingManager.getInstance().getWidgetSettingClass(s):null;return o&&this.props.widgetJson.config?e.React.createElement(e.ErrorBoundary,null,e.React.createElement(o,{key:s,widgetId:s,onSettingChange:this.onSettingChange})):e.React.createElement(i.Loading,{type:i.LoadingType.Secondary})}}componentDidUpdate(){this.loadWidgetSettingClass()}componentDidMount(){this.loadWidgetSettingClass()}loadWidgetSettingClass(){const{widgetId:e}=this.props;e&&!t.WidgetSettingManager.getInstance().getWidgetSettingClass(e)&&t.WidgetSettingManager.getInstance().loadWidgetSettingClass(e)}render(){if(!this.props.widgetJson)return e.React.createElement(i.Loading,{type:i.LoadingType.Secondary});const{widgetId:t}=this.props;return e.React.createElement("div",{className:"setting-container h-100"},t?this.renderWidgetSetting(t):e.React.createElement("div",null,"  ",this.formatMessage("noWidget")))}}const o=e.ReactRedux.connect(((e,t)=>({widgetJson:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.widgets[t.widgetId]})))(s);var n=u(7756),a=u(1362),l=u(5505);const r={width:110};class c extends e.React.PureComponent{constructor(s){super(s),this.isOpen=()=>{const{pagePart:e,pageId:t}=this.props,i=this.getAppConfig();return"body"===e||!!(i&&i.pages[t]&&i[e]&&i.pages[t][e])},this.formatMessage=e=>this.props.formatMessage(e),this.onSwitchChange=()=>{const{pageId:i,pagePart:s,emptyLayout:o}=this.props,n=this.getAppConfig(),a=n.pages[i];let l=n[s];const r=(0,t.getAppConfigAction)();if(!l){const t=e.appConfigUtils.getUniqueId(n,"layout"),i=(0,e.Immutable)(Object.assign(Object.assign({},o),{id:t,type:e.LayoutType.FixedLayout})).setIn(["setting","lockDescendants"],!0);l=(0,e.Immutable)({}).setIn(["layout",e.BrowserSizeMode.Large],t).setIn(["height",e.BrowserSizeMode.Large],75),"header"===s?r.editHeader(l,[i]):r.editFooter(l,[i])}const c=a.set(s,!a[s]);r.editPage(c).exec(),"body"===s||c[s]||t.builderAppSync.publichActivePagePartChangeToApp(e.PagePart.Body),this.setState({isOpen:c[s]})},this.onHeightChange=e=>{const s=i.utils.stringOfLinearUnit(e),{pagePart:o,browserSizeMode:n}=this.props,a=this.getAppConfig();"header"===o?(0,t.getAppConfigAction)().editHeader(a.header.setIn(["height",n],s)).exec():(0,t.getAppConfigAction)().editFooter(a.footer.setIn(["height",n],s)).exec()},this.onStickHeaderChange=e=>{const i=this.getAppConfig();(0,t.getAppConfigAction)().editHeader(i.header.set("sticky",e.target.checked)).exec()},this.onBackgroundColorChange=e=>{const{pageId:i,pagePart:s}=this.props,o=this.getAppConfig(),n=o.pages[i];"body"===s?(0,t.getAppConfigAction)().editPage(n.set("bodyBackgroundColor",e)).exec():"header"===s?(0,t.getAppConfigAction)().editHeader(o.header.set("backgroundColor",e)).exec():(0,t.getAppConfigAction)().editFooter(o.footer.set("backgroundColor",e)).exec()},this.state={isOpen:this.isOpen()}}getAppConfig(){return(0,e.getAppStore)().getState().appStateInBuilder&&(0,e.getAppStore)().getState().appStateInBuilder.appConfig||{pages:{empty:{}}}}componentDidUpdate(e){if(this.props.pageId!==e.pageId){const{pageJson:e,pagePart:t}=this.props;this.setState({isOpen:"body"===t||e&&e[t]})}}render(){var t,s,o,c,p,d,g,h,m;const u={body:this.formatMessage("body"),header:this.formatMessage("header"),footer:this.formatMessage("footer")},{pageId:f,pagePart:v,browserSizeMode:x,theme:w,header:I}=this.props,b=this.getAppConfig(),y=b.pages[f];let S;S="body"===v?y.bodyBackgroundColor:null===(t=b[v])||void 0===t?void 0:t.backgroundColor,!S&&w&&(S="header"===v?null===(s=w.header)||void 0===s?void 0:s.bg:"footer"===v?null===(o=w.footer)||void 0===o?void 0:o.bg:null===(c=w.body)||void 0===c?void 0:c.bg);const C=e.React.createElement("div",{className:"setting-title d-flex justify-content-between"},e.React.createElement("div",null,e.React.createElement("span",null,u[this.props.pagePart])),e.React.createElement("div",{className:"d-flex align-items-center"},"body"===v?null:e.React.createElement(i.Switch,{checked:this.isOpen(),onChange:this.onSwitchChange,"aria-label":u[this.props.pagePart]}))),j=b.mainSizeMode,A=null===(d=null===(p=b[v])||void 0===p?void 0:p.height)||void 0===d?void 0:d[x],M=null===(h=null===(g=b[v])||void 0===g?void 0:g.height)||void 0===h?void 0:h[j],T=i.utils.stringOfLinearUnit(null!==(m=null!=A?A:M)&&void 0!==m?m:75);return e.React.createElement(n.SettingSection,{title:C,role:"group","aria-label":u[this.props.pagePart]},e.React.createElement(i.Collapse,{isOpen:this.state.isOpen},"body"===v?null:e.React.createElement(n.SettingRow,{label:`${this.formatMessage("dynamicHeight")}`},e.React.createElement(l.InputUnit,{value:T,min:0,onChange:this.onHeightChange,style:r,"aria-label":`${this.formatMessage("dynamicHeight")}`})),e.React.createElement(n.SettingRow,{label:this.formatMessage("dsFill")},e.React.createElement(a.ThemeColorPicker,{specificTheme:w,value:S,onChange:this.onBackgroundColorChange})),"header"===v&&y.mode===e.PageMode.AutoScroll&&e.React.createElement(n.SettingRow,{flow:"wrap"},e.React.createElement(i.Label,{centric:!0},e.React.createElement(i.Checkbox,{className:"mr-2",checked:Boolean(null==I?void 0:I.sticky),onChange:this.onStickHeaderChange}),this.formatMessage("keepFixedOnScroll")))))}}var p=u(7282),d=u(4758),g=u(8866),h=u.n(g);const m=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:h()},o)):e.React.createElement("svg",Object.assign({className:n},o))},v={};class x extends e.React.PureComponent{constructor(i){super(i),this.onMaxWidthChange=e=>{let i=this.props.pageJson;i=i.set("maxWidth",e),(0,t.getAppConfigAction)().editPage(i).exec()},this.formatMessage=e=>this.props.formatMessage(e),this.setPageWidthModeAuto=()=>{let e=this.props.pageJson;e=e.without("maxWidth"),(0,t.getAppConfigAction)().editPage(e).exec()},this.setPageWidthModeFixed=()=>{let e=this.props.pageJson;e=e.set("maxWidth",1024),(0,t.getAppConfigAction)().editPage(e).exec()},this.openWithDialogChanged=e=>{let i=this.props.pageJson;i=i.set("autoOpenDialogId",e.target.value),(0,t.getAppConfigAction)().editPage(i).exec()},this.onEffectSettingChange=(i,s)=>{const{pageJson:o}=this.props;(0,t.getAppConfigAction)().editPage(o.set("oneByOneEffect",s)).exec(),(null==s?void 0:s.type)!==e.AnimationType.None&&t.builderAppSync.publishAnimationPreviewToApp({pageId:o.id,playMode:i,id:(0,e.getNextAnimationId)()})},this.previewAnimation=i=>{const{pageJson:s}=this.props;s.oneByOneEffect&&s.oneByOneEffect.type!==e.AnimationType.None&&t.builderAppSync.publishAnimationPreviewToApp({pageId:s.id,playMode:i,id:(0,e.getNextAnimationId)()})},this.state={isSetImageUrl:!1,currentImgUrlInput:""},this.fileInput=e.React.createRef()}getAppConfig(){return(0,e.getAppStore)().getState().appStateInBuilder&&(0,e.getAppStore)().getState().appStateInBuilder.appConfig||{pages:{empty:{}}}}layoutSetting(){var t;const{pageId:i,appTheme:s}=this.props,o=this.getAppConfig(),n=o.pages[i];if(n&&n.layout){const i=d.searchUtils.findLayoutId(n.layout,null===(t=(0,e.getAppStore)().getState().appStateInBuilder)||void 0===t?void 0:t.browserSizeMode,o.mainSizeMode),a=o.layouts[i];if((null==a?void 0:a.type)===e.LayoutType.FlowLayout)return(0,e.jsx)(p.FlowLayoutSetting,{layoutId:i,formatMessage:this.props.formatMessage});if((null==a?void 0:a.type)===e.LayoutType.GridLayout)return(0,e.jsx)(p.GridLayoutSetting,{layouts:n.layout,appTheme:s,formatMessage:this.props.formatMessage})}}getDialogList(){const t=[{value:"",index:-1,label:this.formatMessage("none")}],i=this.props.dialogs;return i&&(Object.keys(i).forEach((s=>{i[s].isSplash||i[s].mode!==e.DialogMode.Fixed||t.push({value:s,index:i[s].index,label:i[s].label})})),t.sort(((e,t)=>e.index-t.index))),t}getStyle(){const{theme:t}=this.props;return e.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    input, select {
      width: 130px;
      max-width: 130px;
    }
    .setting-row-label{
      line-height: 30px;
      font-size: 0.8125rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: ${t.colors.palette.dark[400]};
    }
    .content-width-item {
      width: calc(50% - 4px);
      .img-container {
        width: auto;
        height: auto;
        cursor: pointer;
        outline: 1px solid ${t.colors.palette.light[800]};
        background-color: ${t.colors.white} !important;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 5px;
        &.active {
          outline: 2px solid ${t.colors.palette.primary[600]};
        }
      }
      span {
        overflow-x: hidden;
        text-overflow: ellipsis;
        width: 100%;
      }
    }

    `}render(){const{pageMode:t,maxWidth:s,pageJson:o}=this.props;if(!o)return null;const a=this.props.pageJson.autoOpenDialogId||"",r=o.oneByOneEffect,p=o.maxWidth>0?0:1;return(0,e.jsx)("div",{className:"setting-pane widget-builder-page-setting",css:this.getStyle()},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)("div",{className:"setting-row-label"},this.formatMessage("openWithWindow"),(0,e.jsx)(i.Tooltip,{title:this.formatMessage("openWithWindowTip"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",className:"d-inline jimu-outline-inside"},(0,e.jsx)(m,null)))),(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(i.Select,{size:"sm",value:a,onChange:this.openWithDialogChanged,"aria-label":this.formatMessage("openWithWindow")},this.getDialogList().map(((t,i)=>(0,e.jsx)("option",{value:t.value,key:i,selected:t.value===a},t.label)))))),t===e.PageMode.AutoScroll&&(0,e.jsx)(n.SettingSection,{role:"group",title:this.formatMessage("contentWidth"),"aria-label":this.formatMessage("contentWidth")},(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex w-100 justify-content-between"},(0,e.jsx)("div",{className:"d-flex flex-column align-items-center content-width-item"},(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",className:"img-container p-0 "+(0===p?"active":""),"aria-label":this.formatMessage("dsCustom"),"aria-pressed":0===p,onClick:this.setPageWidthModeFixed},(0,e.jsx)(i.Icon,{autoFlip:!0,width:0===p?105:107,height:0===p?66:68,icon:u(4479)})),(0,e.jsx)("span",{className:"text-center"},this.formatMessage("dsCustom"))),(0,e.jsx)("div",{className:"d-flex flex-column align-items-center content-width-item"},(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",className:"img-container p-0 "+(1===p?"active":""),"aria-label":this.formatMessage("dsAuto"),"aria-pressed":1===p,onClick:this.setPageWidthModeAuto},(0,e.jsx)(i.Icon,{autoFlip:!0,width:1===p?105:107,height:1===p?66:68,icon:u(7893)})),(0,e.jsx)("span",{className:"text-center"},this.formatMessage("dsAuto"))))),0===p&&(0,e.jsx)(n.SettingRow,{label:this.formatMessage("maxWidth")},(0,e.jsx)(i.NumericInput,{"aria-label":this.formatMessage("maxWidth"),className:"setting-input-select",min:300,onChange:this.onMaxWidthChange,value:isNaN(s)?"":s,style:{width:"110px"}}))),(0,e.jsx)(n.SettingSection,{role:"group","aria-label":this.formatMessage("animation"),title:this.formatMessage("animation")},(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(l.AnimationSettingComponent,{contentId:o.id,oneByOneSetting:r,onSettingChange:this.onEffectSettingChange,previewEnabled:!0,supportAsOne:!1,supportOneByOne:!0,isRoot:!0,onPreviewClicked:this.previewAnimation,formatMessage:this.formatMessage}))),(0,e.jsx)(c,{formatMessage:this.formatMessage,emptyLayout:v,dispatch:this.props.dispatch,pageId:this.props.pageId,pagePart:"body",pageJson:this.props.pageJson,theme:this.props.appTheme,browserSizeMode:this.props.browserSizeMode}),(0,e.jsx)(c,{formatMessage:this.formatMessage,emptyLayout:v,dispatch:this.props.dispatch,pageId:this.props.pageId,pagePart:"header",pageJson:this.props.pageJson,header:this.props.header,theme:this.props.appTheme,browserSizeMode:this.props.browserSizeMode}),(0,e.jsx)(c,{formatMessage:this.formatMessage,emptyLayout:v,dispatch:this.props.dispatch,pageJson:this.props.pageJson,pageId:this.props.pageId,pagePart:"footer",footer:this.props.footer,theme:this.props.appTheme,browserSizeMode:this.props.browserSizeMode}),this.layoutSetting())}}const w=e.ReactRedux.connect(((e,t)=>{var i,s,o,n,a,l,r,c;return{pageJson:null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.pages[t.pageId],dialogs:null===(n=null===(o=e.appStateInBuilder)||void 0===o?void 0:o.appConfig)||void 0===n?void 0:n.dialogs,header:null===(l=null===(a=e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===l?void 0:l.header,footer:null===(c=null===(r=e.appStateInBuilder)||void 0===r?void 0:r.appConfig)||void 0===c?void 0:c.footer}}))(x);var I=u(840),b=u.n(I),y=u(7322),S=u.n(y),C=u(5537),j=u.n(C),A=u(9694),M=u.n(A),T=u(3210),N=u.n(T),D=u(9063),k=u.n(D),P=u(2884),L=u.n(P),R=u(1937),B=u.n(R);const O="480px",z="432px",E="var(--light)";class U extends e.React.PureComponent{constructor(s){var o,a;super(s),this.getDefaultText=(e=this.props.dialogJson.confirmBeforeClose)=>{let t="";return this.props.dialogJson.interactionType&&(t=this.formatMessage(e?"dialogConfirmationDefaultText":"dialogPreventDisplayAgainDefaultText")),t},this.formatMessage=e=>this.props.formatMessage(e),this.getFormatedValue=(e,t)=>t.toFixed(e===i.DistanceUnits.PIXEL?0:1),this.onTextChanged=e=>{this.setState({text:e.target.value})},this.onButtonTextChanged=e=>{this.setState({buttonText:e.target.value})},this.onTextBLur=e=>{const t=this.defaultText;this.textBlur("text",e,t)},this.onButtonTextBLur=e=>{const t=this.formatMessage("ok");this.textBlur("buttonText",e,t)},this.textBlur=(e,t,i)=>{if(i===(t=t.trim())&&(t=""),this.interactionStyles[e]!==t&&this.updateInteractionStyles(e,t),""===t){const t={};t[e]=i,this.setState(t)}},this.updateDialogMask=e=>{this.editDialogProperty("overlayColor",e)},this.getDialogBackgroud=()=>{var e;const{dialogJson:t}=this.props;return(null===(e=t.dialogBackground)||void 0===e?void 0:e.color)===E?t.dialogBackground.set("color",""):t.dialogBackground},this.updateDialogQuickBackgroud=e=>{var t,i;const{dialogJson:s}=this.props;(null===(t=s.dialogBackground)||void 0===t?void 0:t.image)&&(e.image=null===(i=s.dialogBackground)||void 0===i?void 0:i.image),this.editDialogProperty("dialogBackground",e)},this.updateDialogBackgroud=e=>{""===e.color&&(e.color=E),this.editDialogProperty("dialogBackground",e)},this.updateBorder=e=>{this.editDialogProperty("border",e)},this.updateBorderRadius=e=>{this.editDialogProperty("borderRadius",e)},this.updateShadow=e=>{this.editDialogProperty("boxShadow",e)},this.onEffectSettingChange=(i,s)=>{const{dialogJson:o}=this.props,n=i===e.AnimationPlayMode.OneByOne?"oneByOneEffect":"effect";(0,t.getAppConfigAction)().editDialog(o.set(n,s)).exec(),t.builderAppSync.publishAnimationPreviewToApp({dialogId:o.id,playMode:i,id:(0,e.getNextAnimationId)()})},this.previewAnimation=i=>{const{dialogJson:s}=this.props;(s.effect||s.oneByOneEffect)&&t.builderAppSync.publishAnimationPreviewToApp({dialogId:s.id,playMode:i,id:(0,e.getNextAnimationId)()})},this.getBrowserIcons=t=>{const s=!this.props.dialogJson.layout[e.BrowserSizeMode.Medium],o=!this.props.dialogJson.layout[e.BrowserSizeMode.Small],n=this.props.browserSizeMode===e.BrowserSizeMode.Large||!this.props.dialogJson.layout[this.props.browserSizeMode],a=this.props.browserSizeMode===e.BrowserSizeMode.Large&&s||this.props.browserSizeMode===e.BrowserSizeMode.Medium||this.props.browserSizeMode===e.BrowserSizeMode.Small&&s&&o,l=this.props.browserSizeMode===e.BrowserSizeMode.Large&&o||this.props.browserSizeMode===e.BrowserSizeMode.Medium&&s&&o||this.props.browserSizeMode===e.BrowserSizeMode.Small,r=this.props.theme.colors.palette.dark[200],c=this.props.formatMessage("applyToLargeScreen"),p=this.props.formatMessage("applyToMediumScreen"),d=this.props.formatMessage("applyToSmallScreen");return(0,e.jsx)("div",{className:"d-flex justify-content-between align-items-center"},n&&(0,e.jsx)(i.Icon,{size:t,icon:j(),color:r,title:c}),a&&(0,e.jsx)(i.Icon,{size:t,icon:M(),color:r,className:n?"ml-1":"",title:p}),l&&(0,e.jsx)(i.Icon,{size:t,icon:N(),color:r,className:n||a?"ml-1":"",title:d}))},this.getConfirmationDOMs=t=>(0,e.jsx)("div",{className:"confirmation-container mt-3"},(0,e.jsx)(n.SettingRow,{className:"confirmation-item",label:this.formatMessage("checkboxText")}),(0,e.jsx)("div",{className:"confirmation-item"},(0,e.jsx)(i.TextArea,{className:"w-100",height:60,spellCheck:!1,placeholder:this.formatMessage("confirmationRequiredText"),value:this.state.text,onChange:this.onTextChanged,onAcceptValue:this.onTextBLur})),(0,e.jsx)(n.SettingRow,{label:this.formatMessage("fontSize")},(0,e.jsx)(l.InputUnit,{style:{width:"80px"},units:[i.DistanceUnits.PIXEL,i.DistanceUnits.REM],value:this.getFontSize("textSize"),onChange:e=>{this.updateCheckboxTextSize("textSize",e.distance+e.unit)}})),t.interactionType!==e.DialogInteractionType.NoButton&&(0,e.jsx)("div",null,(0,e.jsx)(n.SettingRow,{className:"confirmation-item",label:this.formatMessage("checkboxButtonText")}),(0,e.jsx)(n.SettingRow,{className:"confirmation-item"},(0,e.jsx)(i.TextInput,{type:"text",size:"sm",className:"w-100",spellCheck:!1,placeholder:this.formatMessage("confirmationRequiredText"),value:this.state.buttonText,onChange:this.onButtonTextChanged,onAcceptValue:this.onButtonTextBLur})),(0,e.jsx)(n.SettingRow,{label:this.formatMessage("fontSize")},(0,e.jsx)(l.InputUnit,{style:{width:"80px"},units:[i.DistanceUnits.PIXEL,i.DistanceUnits.REM],value:this.getFontSize("buttonTextSize"),onChange:e=>{this.updateCheckboxTextSize("buttonTextSize",e.distance+e.unit)}})))),this.defaultText=this.getDefaultText(),this.state={interactionPanel:s.dialogJson.confirmBeforeClose?"confirmation":"prevent",text:(null===(o=this.interactionStyles)||void 0===o?void 0:o.text)||this.defaultText,buttonText:(null===(a=this.interactionStyles)||void 0===a?void 0:a.buttonText)||this.formatMessage("ok")},this.isRTL=(0,e.getAppStore)().getState().appContext.isRTL}componentDidUpdate(e){var t,i,s,o,n,a;const{dialogJson:l}=this.props;l.interactionStyles&&((null===(t=l.interactionStyles)||void 0===t?void 0:t.text)===(null===(i=e.dialogJson.interactionStyles)||void 0===i?void 0:i.text)&&(null===(s=l.interactionStyles)||void 0===s?void 0:s.buttonText)===(null===(o=e.dialogJson.interactionStyles)||void 0===o?void 0:o.buttonText)||(this.defaultText=this.getDefaultText(),this.setState({text:(null===(n=this.interactionStyles)||void 0===n?void 0:n.text)||this.defaultText,buttonText:(null===(a=this.interactionStyles)||void 0===a?void 0:a.buttonText)||this.formatMessage("ok")})),l.confirmBeforeClose!==e.dialogJson.confirmBeforeClose&&this.setState({interactionPanel:l.confirmBeforeClose?"confirmation":"prevent"}))}getDialogBrowserSizeMode(){return this.props.dialogJson.layout[this.props.browserSizeMode]?this.props.browserSizeMode:e.BrowserSizeMode.Large}defaultInteractionStyles(){return{text:"",textSize:"13px",buttonText:"",buttonTextSize:"16px"}}getAppConfig(){return(0,e.getAppStore)().getState().appStateInBuilder&&(0,e.getAppStore)().getState().appStateInBuilder.appConfig||{dialogs:{empty:{}}}}editDialogProperty(e,i){(0,t.getAppConfigAction)().editDialogProperty(this.props.dialogId,e,i).exec()}editDialog(e){(0,t.getAppConfigAction)().editDialog(e).exec()}setDialogMode(t){let s=this.props.dialogJson;if(t===s.mode)return;const o=this.getDialogBrowserSizeMode();let n=s.sizeMode[o];if(t===e.DialogMode.Anchored){let t=O,a=z;if(n.position===e.DialogPosition.Center){const s=e.utils.findViewportSize(this.getAppConfig(),this.props.browserSizeMode);t=n.width.includes(i.DistanceUnits.PIXEL)?n.width:s.width*parseFloat(n.width.split("%")[0])/100+"px",a=n.height.includes(i.DistanceUnits.PIXEL)?n.height:s.height*parseFloat(n.height.split("%")[0])/100+"px"}n=n.set("width",t).set("height",a).set("position",null),s=s.setIn(["sizeMode",o],n).set("overlayColor",null)}else s=s.setIn(["sizeMode",o,"position"],e.DialogPosition.Center).set("overlayColor","var(--dark-900)");s=s.set("mode",t).set("interactionType",null).set("interactionStyles",null).set("confirmBeforeClose",!0).set("alwaysShowConfirmation",!1),this.editDialog(s)}setDialogPosition(t){const i=this.getDialogBrowserSizeMode();let s=this.props.dialogJson.sizeMode[i];s=s.set("position",t),s=t===e.DialogPosition.Left||t===e.DialogPosition.Right?s.set("aspectRatio",!1).set("width","260px"):t===e.DialogPosition.Top||t===e.DialogPosition.Bottom?s.set("aspectRatio",!1).set("height","300px"):s.set("width",O).set("height",z);const o=this.props.dialogJson.setIn(["sizeMode",i],s);this.editDialog(o)}getDialogSize(e){const t=this.props.dialogJson.sizeMode[this.getDialogBrowserSizeMode()][e];if(!t)return null;const s=t.indexOf(i.DistanceUnits.PIXEL)>=0?i.DistanceUnits.PIXEL:i.DistanceUnits.PERCENTAGE;return{distance:t.split(s)[0],unit:s}}setDialogSize(t,s){const o=this.getDialogBrowserSizeMode();let n=this.props.dialogJson;const a=n.sizeMode[o];if((a[t].indexOf(i.DistanceUnits.PIXEL)>=0?i.DistanceUnits.PIXEL:i.DistanceUnits.PERCENTAGE)!==s.unit){const o=e.utils.findViewportSize(this.getAppConfig(),this.props.browserSizeMode),n="height"===t?o.height:o.width;s.unit===i.DistanceUnits.PIXEL?s.distance=n*s.distance/100:s.distance=100*s.distance/n}else if(a.aspectRatio){const e="width"===t?"height":"width",l=a[e].indexOf(i.DistanceUnits.PIXEL)>=0?i.DistanceUnits.PIXEL:i.DistanceUnits.PERCENTAGE,r=s.distance*parseFloat(a[e].split(l)[0])/parseFloat(a[t].split(s.unit)[0]),c=this.getFormatedValue(l,r)+l;n=n.setIn(["sizeMode",o,e],c)}s.distance=this.getFormatedValue(s.unit,s.distance),n=n.setIn(["sizeMode",o,t],s.distance+s.unit),this.editDialog(n)}getFontSize(e){const t=this.interactionStyles[e],s=t.indexOf(i.DistanceUnits.PIXEL)>=0?i.DistanceUnits.PIXEL:i.DistanceUnits.REM;return{distance:t.split(s)[0],unit:s}}setInteraction(t){let i=this.props.dialogJson;i=i.set("interactionType",t?e.DialogInteractionType.NoButton:null).set("interactionStyles",t?this.defaultInteractionStyles():null).set("confirmBeforeClose",!0).set("alwaysShowConfirmation",!1),this.editDialog(i),this.setState({interactionPanel:t?"confirmation":""})}changeInteractionType(e){let t=this.props.dialogJson;e!==t.interactionType&&(t=t.set("interactionType",e),this.editDialog(t))}setConfirmationType(e){this.defaultText=this.getDefaultText(e),""===this.props.dialogJson.interactionStyles.text&&this.setState({text:this.defaultText});let t=this.props.dialogJson;t=t.set("confirmBeforeClose",e).set("alwaysShowConfirmation",!e),this.editDialog(t),this.setState({interactionPanel:e?"confirmation":"prevent"})}updateAspectRatio(e){const t=this.props.dialogJson.setIn(["sizeMode",this.getDialogBrowserSizeMode(),"aspectRatio"],e);this.editDialog(t)}updateInteractionStyles(e,t){this.editDialogProperty("interactionStyles",this.interactionStyles.set(e,t))}updateCheckboxTextSize(e,t){this.interactionStyles[e]!==t&&this.updateInteractionStyles(e,t)}getStyle(){return e.css`
      .mode-radio{
        cursor: pointer;
        &.mode-label-disabled{
          cursor: inherit;
        }
      }
      .mode-label{
        margin-left: 0.5rem;
        cursor: pointer;
        &.mode-label-disabled{
          cursor: inherit;
          color: var(--dark-200);
        }
      }
      .confirmation-container {
        .confirmation-item{
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
      }

      .position-size-setting{
        display: flex;
        justify-content: space-between;

        .position-container{
          position: relative;
          width: 90px;
          height: 90px;
          border: 1px solid var(--light-500);

          .content {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            padding: 6px;
            justify-content: space-between;
          }

          .w-part {
            width: 19px;
            position: relative;
            z-index: 0;
            &.w-center {
              width: 24px;
              justify-content: space-between;
            }
          }
          .h-part {
            width: 100%;
            height: 19px;
            position: relative;
            z-index: 0;
            &.h-center {
              height: 24px;
            }
          }

          .from-left {
            &.line-h{
              &:after {
                left: 6px;
              }
              &.is-selected:after {
                border-left: none;
              }
            }
          }
          .from-top {
            &.line-v{
              &:after {
                position: absolute;
                top: 6px;
              }
              &.is-selected:after {
                border-top: none;
              }
            }
          }

          .from-center {
            border: 2px solid var(--dark-100);
          }

          .from-right {
            &.line-h{
              &:before {
                position: absolute;
                right: 0;
              }
              &:after {

                right: 6px;
              }
              &.is-selected:after {
                border-right: none;
              }
            }
          }

          .from-bottom {
            &.line-v{
              &:before {
                position: absolute;
                bottom: 0;
              }
              &:after {
                position: absolute;
                top: -2px;
              }
              &.is-selected:after {
                border-bottom: none;
              }
            }
          }
          .line-h.is-selected,
          .line-v.is-selected {
            border-color: var(--primary-700);

            &:before, &:after{
              background: var(--primary-100);
              border: 2px solid var(--primary-700);
            }
          }
          .line-h {
            position: absolute;
            width: 100%;
            top: 50%;
            transform: translateY(-50%);
            height: 24px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            z-index: 0;
            cursor: pointer;

            &:before {
              content: '';
              width: 6px;
              height: 100%;
              background: var(--dark-100);
            }
            &.is-selected:before {
              width: 8px;
            }

            &:after {
              position: absolute;
              top: 9px;
              content: '';
              height: 6px;
              width: 15px;
              background: var(--dark-100);
            }
            &.is-selected:after {
              height: 8px;
            }
          }
          .line-v {
            position: absolute;
            height: 100%;
            width: 100%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            z-index: 0;
            cursor: pointer;

            &:before {
              content: '';
              width: 100%;
              height: 6px;
              background: var(--dark-100);
            }
            &.is-selected:before {
              height: 8px;
            }

            &:after {
              content: '';
              width: 6px;
              height: 15px;
              background: var(--dark-100);
            }
            &.is-selected:after {
              width: 8px;
            }
          }
          .line-center {
            height: 100%;
            width: 100%;
            z-index: 0;
            cursor: pointer;
            background: var(--dark-100);
            &.is-selected {
              background: var(--primary-100);
              border-color: var(--primary-700);
            }
          }
        }

        .size-container{
          width: calc(100% - 106px);
          height: 90px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;

          .size-label{
            color: var(--dark-400);
          }

          .size-input{
            margin-left: 6px;
            width: 100%;
            &.size-auto-input{
              color: var(--dark-400);
              background: var(--light-400);
            }
          }
        }
      }


      .size-setting{
        width: 100%;

        .size-container{
          height: 26px;
          display: flex;
          justify-content: space-between;

          .unit-container{
            display: flex;
            width: calc(50% - 18px);

            .size-label{
              color: var(--dark-400);
            }

            .size-input{
              margin-left: 6px;
            }
          }
        }

      }

      .interaction-container{
        .interaction-type-container{
          display: flex;
          justify-content: space-between;
          .jimu-btn{
            padding: 0;
            background-color: var(--light-200);
            border: 2px solid transparent;
            &.active{
              border: 2px solid var(--primary-600);
            }
          }
        }
      }

    `}render(){const{dialogJson:s}=this.props,o=s.isSplash||t.utils.getPageListByDialogId(this.getAppConfig().pages,s.id).length>0;if(!s.id)return null;const r=s.mode===e.DialogMode.Anchored?[i.DistanceUnits.PIXEL]:[i.DistanceUnits.PIXEL,i.DistanceUnits.PERCENTAGE];this.interactionStyles=s.interactionStyles?s.interactionStyles:this.defaultInteractionStyles();const c=s.sizeMode[this.getDialogBrowserSizeMode()];return(0,e.jsx)("div",{className:"setting-pane widget-builder-page-setting",css:this.getStyle()},(0,e.jsx)(n.SettingSection,{title:this.formatMessage("mode")},(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("fixedModeTip")},(0,e.jsx)("div",{className:"align-items-center d-flex"},(0,e.jsx)(i.Radio,{className:"mode-radio",onChange:()=>this.setDialogMode(e.DialogMode.Fixed),checked:s.mode===e.DialogMode.Fixed}),(0,e.jsx)("label",{className:"mode-label",onClick:()=>this.setDialogMode(e.DialogMode.Fixed)},this.formatMessage("fixedMode")))))),(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex justify-content-between w-100 align-items-center"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:o?this.formatMessage(s.isSplash?"splashDlgWarning":"pageDlgWarning"):this.formatMessage("anchoredModeTip")},(0,e.jsx)("div",{className:"align-items-center d-flex"},(0,e.jsx)(i.Radio,{className:(0,e.classNames)("mode-radio",o?"mode-radio-disabled":""),onChange:()=>this.setDialogMode(e.DialogMode.Anchored),checked:s.mode===e.DialogMode.Anchored,disabled:o}),(0,e.jsx)("label",{className:(0,e.classNames)("mode-label",o?"mode-label-disabled":""),onClick:()=>!o&&this.setDialogMode(e.DialogMode.Anchored)},this.formatMessage("anchoredMode"))))))),!this.props.lockLayout&&(0,e.jsx)(n.SettingSection,null,(0,e.jsx)("div",{className:"d-flex mb-3"},(0,e.jsx)("h6",{className:"flex-lg-grow-1 mb-0 text-truncate setting-text-level-1"},s.mode===e.DialogMode.Fixed?`${this.formatMessage("position")} & ${this.formatMessage("size")}`:this.formatMessage("size")),this.getBrowserIcons(12)),(0,e.jsx)(n.SettingRow,null,s.mode===e.DialogMode.Fixed?(0,e.jsx)("div",{className:"position-size-setting"},(0,e.jsx)("div",{className:"position-container"},(0,e.jsx)("div",{className:"content d-flex"},(0,e.jsx)("div",{className:"w-part flex-column justify-content-center align-items-center"},(0,e.jsx)("div",{className:"d-flex w-100 justify-content-center align-items-center"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("left")},(0,e.jsx)("div",{className:(0,e.classNames)("from-left line-h flex-grow-1 flex-shrink-1",{"is-selected":c.position===e.DialogPosition.Left}),onClick:()=>{this.setDialogPosition(e.DialogPosition.Left)}})))),(0,e.jsx)("div",{className:"d-flex w-part w-center h-100 flex-column"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("top")},(0,e.jsx)("div",{className:"h-part"},(0,e.jsx)("div",{className:(0,e.classNames)("from-top line-v flex-grow-1 flex-shrink-1",{"is-selected":c.position===e.DialogPosition.Top}),onClick:()=>{this.setDialogPosition(e.DialogPosition.Top)}}))),(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("center")},(0,e.jsx)("div",{className:"h-part h-center"},(0,e.jsx)("div",{className:(0,e.classNames)("from-center line-center flex-grow-1 flex-shrink-1",{"is-selected":c.position===e.DialogPosition.Center}),onClick:()=>{this.setDialogPosition(e.DialogPosition.Center)}}))),(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("bottom")},(0,e.jsx)("div",{className:"h-part"},(0,e.jsx)("div",{className:(0,e.classNames)("from-bottom line-v flex-grow-1 flex-shrink-1",{"is-selected":c.position===e.DialogPosition.Bottom}),onClick:()=>{this.setDialogPosition(e.DialogPosition.Bottom)}})))),(0,e.jsx)("div",{className:"w-part flex-column"},(0,e.jsx)("div",{className:"d-flex w-100 justify-content-center align-items-center"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("right")},(0,e.jsx)("div",{className:(0,e.classNames)("from-right line-h flex-grow-1 flex-shrink-1",{"is-selected":c.position===e.DialogPosition.Right}),onClick:()=>{this.setDialogPosition(e.DialogPosition.Right)}})))))),(0,e.jsx)("div",{className:"size-container"},(0,e.jsx)("div",{className:"d-flex"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("width")},(0,e.jsx)("label",{className:"size-label"},"W")),s.mode!==e.DialogMode.Fixed||c.position!==e.DialogPosition.Top&&c.position!==e.DialogPosition.Bottom?(0,e.jsx)(l.InputUnit,{className:"size-input",units:r,value:this.getDialogSize("width"),min:0,max:this.getDialogSize("width").unit===i.DistanceUnits.PERCENTAGE?100:Number.POSITIVE_INFINITY,onChange:e=>this.setDialogSize("width",e)}):(0,e.jsx)("div",{className:"size-input p-1 size-auto-input"},this.formatMessage("auto"))),(0,e.jsx)("div",{className:"d-flex justify-content-center"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:c.position!==e.DialogPosition.Center?"":this.formatMessage("aspectRatio")},(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",disabled:c.position!==e.DialogPosition.Center,onClick:()=>this.updateAspectRatio(!c.aspectRatio)},(0,e.jsx)(i.Icon,{size:12,icon:c.aspectRatio?b():S()})))),(0,e.jsx)("div",{className:"d-flex"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("height")},(0,e.jsx)("label",{className:"size-label"},"H")),s.mode!==e.DialogMode.Fixed||c.position!==e.DialogPosition.Left&&c.position!==e.DialogPosition.Right?(0,e.jsx)(l.InputUnit,{className:"size-input",units:r,value:this.getDialogSize("height"),min:0,onChange:e=>this.setDialogSize("height",e)}):(0,e.jsx)("div",{className:"size-input p-1 size-auto-input"},this.formatMessage("auto"))))):(0,e.jsx)("div",{className:"size-setting"},(0,e.jsx)("div",{className:"size-container"},(0,e.jsx)("div",{className:"unit-container"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("width")},(0,e.jsx)("label",{className:"size-label"},"W")),(0,e.jsx)(l.InputUnit,{className:"size-input",units:r,value:this.getDialogSize("width"),min:0,onChange:e=>this.setDialogSize("width",e)})),(0,e.jsx)("div",null,(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("aspectRatio")},(0,e.jsx)(i.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>this.updateAspectRatio(!c.aspectRatio)},(0,e.jsx)(i.Icon,{size:12,icon:c.aspectRatio?b():S()})))),(0,e.jsx)("div",{className:"unit-container"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:this.formatMessage("height")},(0,e.jsx)("label",{className:"size-label"},"H")),(0,e.jsx)(l.InputUnit,{className:"size-input",units:r,value:this.getDialogSize("height"),min:0,onChange:e=>this.setDialogSize("height",e)})))))),(0,e.jsx)(n.SettingSection,{title:this.formatMessage("closeOptions")},(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(i.Label,{check:!0,centric:!0},(0,e.jsx)(i.Checkbox,{style:{cursor:"pointer"},className:"mr-2",checked:s.closeWhenClickOverlay,onChange:()=>this.editDialogProperty("closeWhenClickOverlay",!s.closeWhenClickOverlay)}),this.formatMessage("clickOutside"))),s.mode===e.DialogMode.Fixed&&(0,e.jsx)("div",{className:"mt-3"},(0,e.jsx)(n.SettingRow,{label:this.formatMessage("interaction")},(0,e.jsx)(i.Switch,{checked:!!s.interactionType,onChange:(e,t)=>this.setInteraction(t)})),s.interactionType&&(0,e.jsx)("div",{className:"interaction-container mt-3"},(0,e.jsx)(n.SettingRow,{className:"confirmation-item",label:this.formatMessage("style")}),(0,e.jsx)("div",{className:"interaction-type-container mt-3 mb-3"},(0,e.jsx)(i.Tooltip,{title:this.formatMessage("interactionStyle1"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,size:"sm",type:"tertiary",onClick:()=>this.changeInteractionType(e.DialogInteractionType.NoButton),active:s.interactionType===e.DialogInteractionType.NoButton},(0,e.jsx)(i.Icon,{width:65,height:26,icon:k(),flip:this.isRTL?"horizontal":null}))),(0,e.jsx)(i.Tooltip,{title:this.formatMessage("interactionStyle2"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,size:"sm",type:"tertiary",onClick:()=>this.changeInteractionType(e.DialogInteractionType.ButtonInline),active:s.interactionType===e.DialogInteractionType.ButtonInline},(0,e.jsx)(i.Icon,{width:65,height:26,icon:L(),flip:this.isRTL?"horizontal":null}))),(0,e.jsx)(i.Tooltip,{title:this.formatMessage("interactionStyle3"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,size:"sm",type:"tertiary",onClick:()=>this.changeInteractionType(e.DialogInteractionType.ButtonBlock),active:s.interactionType===e.DialogInteractionType.ButtonBlock},(0,e.jsx)(i.Icon,{width:65,height:26,icon:B(),flip:this.isRTL?"horizontal":null})))),(0,e.jsx)(n.SettingRow,{className:"confirmation-item",label:this.formatMessage("type")}),(0,e.jsx)("div",{role:"radiogroup",className:"mt-2"},(0,e.jsx)(n.CollapsableRadio,{name:"collapsable-confirmation-radio",label:this.formatMessage("confirmation"),wrapLabel:!0,disableActionForUnchecked:!0,checked:s.confirmBeforeClose,isOpen:"confirmation"===this.state.interactionPanel,onRequestOpen:()=>this.setState({interactionPanel:"confirmation"}),onRequestClose:()=>this.setState({interactionPanel:""}),onCheckedChange:()=>this.setConfirmationType(!0)},(0,e.jsx)("div",{className:"pl-1 pr-1 mb-2"},this.getConfirmationDOMs(s),(0,e.jsx)(n.SettingRow,{className:"mt-2 mb-3"},(0,e.jsx)(i.Label,{check:!0,centric:!0},(0,e.jsx)(i.Checkbox,{style:{cursor:"pointer"},className:"mr-2",checked:s.alwaysShowConfirmation,onChange:()=>this.editDialogProperty("alwaysShowConfirmation",!s.alwaysShowConfirmation)}),this.formatMessage("alwaysShow"))))),(0,e.jsx)(n.CollapsableRadio,{name:"collapsable-confirmation-radio",label:this.formatMessage("preventDisplayAgain"),wrapLabel:!0,disableActionForUnchecked:!0,checked:!s.confirmBeforeClose,isOpen:"prevent"===this.state.interactionPanel,onRequestOpen:()=>this.setState({interactionPanel:"prevent"}),onRequestClose:()=>this.setState({interactionPanel:""}),onCheckedChange:()=>this.setConfirmationType(!1)},(0,e.jsx)("div",{className:"pl-1 pr-1 mb-2"},this.getConfirmationDOMs(s))))))),(0,e.jsx)(n.SettingSection,{title:this.formatMessage("animation")},(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(l.AnimationSettingComponent,{contentId:s.id,effectSetting:s.effect,oneByOneSetting:s.oneByOneEffect,onSettingChange:this.onEffectSettingChange,previewEnabled:!0,supportAsOne:!0,supportOneByOne:!0,onPreviewClicked:this.previewAnimation,formatMessage:this.formatMessage}))),s.mode===e.DialogMode.Fixed&&(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,{label:this.formatMessage("maskColor")},(0,e.jsx)(a.ThemeColorPicker,{specificTheme:this.props.appTheme,value:s.overlayColor,onChange:this.updateDialogMask}))),(0,e.jsx)(l.ThemeBackgroundSection,{background:this.getDialogBackgroud(),onChange:this.updateDialogBackgroud}),(0,e.jsx)(l.ThemeBorderSection,{border:s.border,borderRadius:s.borderRadius,onBorderChange:this.updateBorder,onBorderRasiusChange:this.updateBorderRadius}),(0,e.jsx)(l.ThemeBoxShadowSection,{value:s.boxShadow,onChange:this.updateShadow}))}}const W=e.ReactRedux.connect(((e,t)=>{var i,s,o;return{lockLayout:null===(o=null===(s=null===(i=null==e?void 0:e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.forBuilderAttributes)||void 0===o?void 0:o.lockLayout,dialogJson:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dialogs[t.dialogId]||{}}}))(U);var Z=u(4796),V=u(5339),H=u.n(V);const F=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:H()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var G=u(8371),$=u.n(G);const J=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:$()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var _=u(4786),Q=u.n(_);const K=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:Q()},o)):e.React.createElement("svg",Object.assign({className:n},o))},X={value:"",openType:n.OpenTypes.NewWindow,linkType:e.LinkType.WebAddress};class Y extends e.React.PureComponent{constructor(i){super(i),this.linkSettingTrigger=e.React.createRef(),this.getCurrentPageName=e=>{const{appConfig:t,pageId:i}=e;return t.pages[i].label||""},this.openBrowseImage=()=>{const e=this.fileInput.current.files;if(!e||!e[0])return;const t=new FileReader;t.readAsDataURL(e[0]),t.onload=e=>{const t=e.target;this.changeIcon(t.result)}},this.setImageUrl=()=>{const{currentImgUrlInput:e}=this.state;""!==e&&(this.setState({isSetImageUrl:!1}),this.changeIcon(e))},this.getPageType=e=>{const{pages:t}=this.props.appConfig;for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.settingLinkConfirm=e=>{this.setState({isShowLinkSetting:!1}),(e.value||""===e.value)&&this.setState({currentUrl:e.value}),this.changeUrl(e.value,e.openType)},this.changeUrl=(i,s)=>{const o=this.props.appConfig.pages[this.props.pageId],n=(0,e.Immutable)(o).merge({linkUrl:i||"#",openTarget:s});(0,t.getAppConfigAction)().editPage(n).exec(),X.value=i,X.openType=s},this.changeIcon=i=>{const s=this.props.appConfig.pages[this.props.pageId],o=(0,e.Immutable)(s).merge({icon:i});(0,t.getAppConfigAction)().editPage(o).exec()},this.formatMessage=e=>this.props.formatMessage(e),this.state={isSetImageUrl:!1,currentImgUrlInput:"",isShowLinkSetting:!1,currentUrl:this.props.currentUrl||""},this.fileInput=e.React.createRef()}resetLinkParam(){X.value="",X.openType=n.OpenTypes.NewWindow;const e=this.props.appConfig.pages[this.props.pageId];e&&e.linkUrl&&"#"!==e.linkUrl&&(X.value=e.linkUrl),e&&e.openTarget&&(X.openType=e.openTarget)}getStyle(t){return e.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    `}render(){var t;const{isSetImageUrl:s,currentImgUrlInput:o,isShowLinkSetting:a}=this.state;return this.resetLinkParam(),(0,e.jsx)("div",{className:"setting-pane widget-builder-page-setting widget-setting-image"},(0,e.jsx)(n.SettingSection,null,s&&(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex flex-row justify-content-around border w-100 align-items-center"},(0,e.jsx)(i.TextInput,{className:"border-0 w-100",value:o,placeholder:`${this.formatMessage("urlIsHere")}...`,onChange:e=>{this.setState({currentImgUrlInput:e.target.value})},onKeyUp:this.setImageUrl}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:this.setImageUrl},(0,e.jsx)(J,{className:"float-right"})),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:()=>{this.setState({isSetImageUrl:!1})}},(0,e.jsx)(F,{className:"float-right"})))),(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(i.Button,{className:"w-100 text-dark set-link-btn",onClick:()=>{this.setState({isShowLinkSetting:!a})},ref:this.linkSettingTrigger},(0,e.jsx)(K,{className:"mr-3"}),"Set link"))),a&&(0,e.jsx)(n.LinkSelectorSidePopper,{isOpen:a,isLinkPageSetting:!0,linkParam:(0,e.Immutable)(X),onSettingCancel:()=>{this.setState({isShowLinkSetting:!1})},onSettingConfirm:this.settingLinkConfirm,trigger:null===(t=this.linkSettingTrigger)||void 0===t?void 0:t.current}))}}Y.mapExtraStateProps=e=>({pageId:e.appRuntimeInfo.currentPageId});const q=(0,Z.withTheme)(Y);class ee extends e.React.PureComponent{constructor(i){super(i),this.getCurrentPageName=e=>{const{appConfig:t,pageId:i}=e;return t.pages[i].label||""},this.openBrowseImage=()=>{const e=this.fileInput.current.files;if(!e||!e[0])return;const t=new FileReader;t.readAsDataURL(e[0]),t.onload=e=>{const t=e.target;this.changeIcon(t.result)}},this.setImageUrl=()=>{const{currentImgUrlInput:e}=this.state;""!==e&&(this.setState({isSetImageUrl:!1}),this.changeIcon(e))},this.formatMessage=e=>this.props.formatMessage(e),this.getPageType=e=>{const{pages:t}=this.props.appConfig;for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.changeIcon=i=>{const s=this.props.appConfig.pages[this.props.pageId],o=(0,e.Immutable)(s).merge({icon:i});(0,t.getAppConfigAction)().editPage(o).exec()},this.state={isSetImageUrl:!1,currentImgUrlInput:""},this.fileInput=e.React.createRef()}getStyle(){return e.css`
    .image-setting-input {
      opacity: 0;
      position: absolute;
      left: 88px;
      width: 70px !important;
      height: 30px !important;
    }
    `}render(){const{isSetImageUrl:t,currentImgUrlInput:s}=this.state;return(0,e.jsx)("div",{className:"setting-pane widget-builder-page-setting widget-setting-image"},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(i.TextInput,{placeholder:this.formatMessage("noSettingOptions"),disabled:!0,style:{border:0,background:"transparent",userSelect:"none"}}),t&&(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex flex-row justify-content-around border w-100 align-items-center"},(0,e.jsx)(i.TextInput,{className:"border-0 w-100",value:s,placeholder:`${this.formatMessage("urlIsHere")}...`,onChange:e=>{this.setState({currentImgUrlInput:e.target.value})},onKeyUp:this.setImageUrl}),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:this.setImageUrl},(0,e.jsx)(J,{className:"float-right"})),(0,e.jsx)("div",{className:"btn btn-light pl-1 pr-1 h-100",onClick:()=>{this.setState({isSetImageUrl:!1})}},(0,e.jsx)(F,{className:"float-right"}))))))}}ee.mapExtraStateProps=e=>({pageId:e.appRuntimeInfo.currentPageId});var te=u(9587),ie=u(5369),se=u.n(ie);const oe=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:se()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class ne extends e.React.PureComponent{constructor(i){super(i),this.formatMessage=e=>this.props.formatMessage(e),this._enableEditing=e=>{e.stopPropagation(),this.setState({isEditingLabel:!0})},this._handleLabelInputBlur=e=>{const t=e.target.value,{valid:i}=this._checkLabel(t);i?this.setState({isEditingLabel:!1}):this.setState({isEditingLabel:!1,currentLabel:this.props.view.label})},this._handleLabelInputEnter=e=>{if("Enter"===e.key){const e=this.inputRef.value,{valid:t}=this._checkLabel(e);t&&this.setState({isEditingLabel:!1})}},this._onLabelChange=e=>{this.setState({currentLabel:e.target.value})},this._onLabelUpdate=i=>{if(i&&i.trim().length>0){const{view:s}=this.props,o=(0,e.Immutable)(s).set("label",i);(0,t.getAppConfigAction)().editView(o).exec()}else this.setState({currentLabel:this.props.view.label})},this._checkLabel=e=>{if(e.includes(","))return{valid:!1,msg:this.props.formatMessage("noCommaInLabel")};const{view:i}=this.props,s=(0,t.getAppConfigAction)().appConfig;return t.appConfigUtils.isLabelDuplicated(s,"view",i.id,e)?{valid:!1,msg:this.props.formatMessage("duplicatedLabel")}:{valid:!0}},this.toggleDropDown=e=>{null==e||e.stopPropagation(),this.setState({isDropDownOpen:!this.state.isDropDownOpen})},this.state={currentLabel:this.props.view.label,isEditingLabel:!1,isDropDownOpen:!1},this.dropDownItems=[(0,e.Immutable)({label:this.formatMessage("rename"),event:this._enableEditing.bind(this),visible:!0,a11yFocusBack:!1}),(0,e.Immutable)({label:this.formatMessage("duplicate"),event:this._duplicateView.bind(this),visible:!0}),(0,e.Immutable)({label:this.formatMessage("sectionDelete"),event:this._removeView.bind(this),visible:!0})],this.readonlyDropDownItems=[this.dropDownItems[0]],this.dropDownItemsWithoutDelete=[this.dropDownItems[0],this.dropDownItems[1]]}componentDidUpdate(e,t){!t.isEditingLabel&&this.state.isEditingLabel&&this._focusInput(),e.view.label!==this.props.view.label&&this.setState({currentLabel:this.props.view.label})}_removeView(){const{view:e,sectionId:i,selected:s}=this.props,o=(0,t.getAppConfigAction)().appConfig.sections[i].views;if(s){const s=o.indexOf(e.id);let n;n=s>0?o[s-1]:o[1],t.builderAppSync.publishSectionNavInfoToApp(i,{currentViewId:n,useProgress:!1})}(0,t.getAppConfigAction)().removeView(e.id,i).exec()}_duplicateView(){if(!this.props.view)return;const i=(0,t.getAppConfigAction)(),s=i.duplicateView(this.props.view.id,this.props.sectionId,!0);i.exec(),e.lodash.defer((()=>{this.props.onSelect(s.id)}))}_focusInput(){this.inputRef&&(this.inputRef.select(),this.inputRef.focus())}_getStyle(){return e.css`
    padding: 2px 2px 2px 10px;
    cursor: pointer;
    position: relative;
    .drop-down {
      text-align:right;
      .popover{
        .popover-inner {
          box-shadow: 0 0 0;
        }
      }
    }
    .view-item-drag:hover {
      cursor: pointer !important;
    }
    .label-con {
      max-width: 10rem;
    }
    .label-input {
      max-width: 10rem;
    }
    .view-item-drag {
      z-index: 1;
      background-color: transparent;
      box-shadow: none;
    }
    `}render(){const{editable:t}=this.props,{isEditingLabel:s,currentLabel:o}=this.state,n=t?this.props.canRemove?this.dropDownItems:this.dropDownItemsWithoutDelete:this.readonlyDropDownItems;return(0,e.jsx)("div",{css:this._getStyle(),className:"d-flex justify-content-between flex-grow-1","data-testid":"viewItem"},(0,e.jsx)("div",{className:"w-100 view-item-drag d-flex justify-content-between"},(0,e.jsx)("div",{className:"d-flex align-items-center"},!s&&(0,e.jsx)("div",{title:o,className:"label-con text-truncate",onDoubleClick:this._enableEditing},o),s&&(0,e.jsx)("div",null,(0,e.jsx)(i.TextInput,{title:o,className:"label-input",type:"text",value:o,ref:e=>{this.inputRef=e},checkValidityOnChange:this._checkLabel,checkValidityOnAccept:this._checkLabel,onChange:this._onLabelChange,onAcceptValue:this._onLabelUpdate,onBlur:this._handleLabelInputBlur,onKeyUp:this._handleLabelInputEnter}))),(0,e.jsx)("div",{className:"drop-down d-flex toc-item-icon"},(0,e.jsx)("div",{title:this.formatMessage("titleOption")},(0,e.jsx)(i.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:this.toggleDropDown,isOpen:this.state.isDropDownOpen},(0,e.jsx)(i.DropdownButton,{arrow:!1,icon:!0,onClick:this.toggleDropDown,type:"tertiary"},(0,e.jsx)(oe,{size:"s"})),(0,e.jsx)(i.DropdownMenu,null,n.map(((t,s)=>(0,e.jsx)(i.DropdownItem,{key:s,onClick:t.event,a11yFocusBack:t.a11yFocusBack},t.label)))))))))}}class ae extends e.React.PureComponent{constructor(){super(...arguments),this.getEchoBackground=()=>{var e;const{view:t,appTheme:s}=this.props,o=t.backgroundPosition?t.backgroundPosition.toUpperCase():"";let n,a;return n=null==t.backgroundColor&&s?null===(e=null==s?void 0:s.body)||void 0===e?void 0:e.bg:""===t.backgroundColor?"rgba(0,0,0,0)":t.backgroundColor?t.backgroundColor:"",t.backgroundIMage&&(a="object"==typeof t.backgroundIMage?t.backgroundIMage:{}),{fillType:o?i.FillType[o]:i.FillType.FIT,color:n,image:a}},this.onBackgroundStyleChange=i=>{this.setState({config:i});const s=i.image?i.image:{},o=(0,e.Immutable)({id:this.props.view.id,label:this.props.view.label,layout:this.props.view.layout,backgroundPosition:i.fillType,backgroundColor:i.color?i.color:null,backgroundIMage:s});(0,t.getAppConfigAction)().editView(o).exec()},this.onLazyLoadChange=i=>{const{view:s}=this.props;(0,t.getAppConfigAction)().editView((0,e.Immutable)(s).set("lazyLoad",i.target.checked)).exec()}}render(){var t;const{view:s}=this.props;return s?(0,e.jsx)("div",{role:"group","aria-label":s.label},(0,e.jsx)(n.SettingSection,{title:this.props.formatMessage("background")},(0,e.jsx)(n.SettingRow,{role:"group","aria-label":this.props.formatMessage("background"),className:"background-setting-con",flow:"wrap"},(0,e.jsx)(l.BackgroundSetting,{background:this.getEchoBackground(),onChange:e=>this.onBackgroundStyleChange(e)}))),(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"d-flex align-items-center w-100"},(0,e.jsx)("label",null,(0,e.jsx)(i.Checkbox,{checked:null!==(t=s.lazyLoad)&&void 0!==t&&t,onChange:this.onLazyLoadChange}),(0,e.jsx)("span",{className:"ml-2"},this.props.formatMessage("lazyLoading"))),(0,e.jsx)(i.Tooltip,{placement:"bottom",showArrow:!0,title:this.props.formatMessage("lazyLoadingTip")},(0,e.jsx)(i.Button,{className:"ml-auto",size:"sm",type:"tertiary",icon:!0},(0,e.jsx)(m,{size:"s"}))))))):null}}var le=u(1528),re=u.n(le);const ce=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:re()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var pe=u(3166),de=u.n(pe);const ge=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:de()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var he=u(7319),me=u.n(he);const ue=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:me()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var fe=u(4201),ve=u.n(fe);const xe=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:ve()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class we extends e.React.PureComponent{constructor(){super(...arguments),this.snapLeft=()=>{this.props.onDirectionChange("l")},this.snapRight=()=>{this.props.onDirectionChange("r")},this.snapTop=()=>{this.props.onDirectionChange("t")},this.snapBottom=()=>{this.props.onDirectionChange("b")}}render(){const{direction:t,formatMessage:s}=this.props;return(0,e.jsx)(i.ButtonGroup,{size:"sm"},(0,e.jsx)(i.Tooltip,{placement:"bottom",title:d.utils.isRTL()?s("right"):s("left")},(0,e.jsx)(i.Button,{icon:!0,active:"l"===t,"aria-pressed":"l"===t,onClick:this.snapLeft},(0,e.jsx)(ce,{size:"s",autoFlip:!0}))),(0,e.jsx)(i.Tooltip,{placement:"bottom",title:s("top")},(0,e.jsx)(i.Button,{icon:!0,active:"t"===t,"aria-pressed":"t"===t,onClick:this.snapTop},(0,e.jsx)(ge,{size:"s"}))),(0,e.jsx)(i.Tooltip,{placement:"bottom",title:d.utils.isRTL()?s("left"):s("right")},(0,e.jsx)(i.Button,{icon:!0,active:"r"===t,"aria-pressed":"r"===t,onClick:this.snapRight},(0,e.jsx)(ue,{size:"s",autoFlip:!0}))),(0,e.jsx)(i.Tooltip,{placement:"bottom",title:s("bottom")},(0,e.jsx)(i.Button,{icon:!0,active:"b"===t,"aria-pressed":"b"===t,onClick:this.snapBottom},(0,e.jsx)(xe,{size:"s"}))))}}var Ie=u(4750),be=u.n(Ie);const ye=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:be()},o)):e.React.createElement("svg",Object.assign({className:n},o))},Se=[i.DistanceUnits.PIXEL];class Ce extends e.React.PureComponent{constructor(i){super(i),this._addView=()=>{const{section:i,formatMessage:s}=this.props,o=(0,t.getAppConfigAction)().appConfig,n=(0,e.Immutable)({}).merge({id:e.appConfigUtils.getUniqueId(o,"view"),label:e.appConfigUtils.getUniqueLabel(o,"view",s("view"))});(0,t.getAppConfigAction)().addView(n,i.id).exec(),e.lodash.defer((()=>{this._selectView(n.id)}))},this._duplicateView=()=>{const{activeViewId:i,sectionId:s}=this.props,o=(0,t.getAppConfigAction)(),n=o.duplicateView(i,s,!0);o.exec(),e.lodash.defer((()=>{this._selectView(n.id)}))},this._showViewList=()=>{this.setState({isShowViewList:!0})},this._hideViewList=()=>{this.setState({isShowViewList:!1})},this._selectView=(e,i=!1)=>{const{section:s,activeViewId:o}=this.props;o!==e&&t.builderAppSync.publishSectionNavInfoToApp(s.id,{previousViewId:this.props.activeViewId,currentViewId:e,useProgress:!1}),i&&this.setState({showViewSetting:!0})},this.getStyle=()=>e.css`
      .toc-dropzone {
        margin-top: 0.5rem;
      }
      .toc-dropzone .jimu-widget-setting--row.row{
        margin-top: 0;
      }
      .jimu-widget-setting--row-label{
        color:${this.props.theme.colors.palette.dark[600]};
      }
    `,this.hideViewSetting=()=>{this.setState({showViewSetting:!1})},this.onAutoPlayChanged=i=>{const{section:s}=this.props,o=(0,e.Immutable)(s).set("autoPlay",i.target.checked);(0,t.getAppConfigAction)().editSection(o).exec()},this.onLoopChanged=i=>{const{section:s}=this.props,o=(0,e.Immutable)(s).set("loop",i.target.checked);(0,t.getAppConfigAction)().editSection(o).exec()},this.onIntervalChanged=i=>{const s=+i;if(s>=1){const{section:i}=this.props,o=(0,e.Immutable)(i).set("interval",s);(0,t.getAppConfigAction)().editSection(o).exec()}},this.updateNav=(i,s,o)=>{const{section:n}=this.props,a=(0,e.Immutable)(n).setIn([i,s],o);(0,t.getAppConfigAction)().editSection(a).exec()},this.viewListRef=e.React.createRef(),this.state={showViewSetting:!1,isShowViewList:!0}}render(){var s,o,a,r,c,p,g,h,m,u,f,v,x,w,I,b,y,S,C;const{section:j,views:A,theme:M,dispatch:T,activeViewId:N,editable:D,formatMessage:k}=this.props,{showViewSetting:P}=this.state;if(!j)return null;const L=e.css`
      cursor:pointer;
      margin-top: ${e.polished.rem(-8)};

      .toggle-view {
        transform: ${this.state.isShowViewList?null:"rotate(180deg)"};
      }
    `,R=A.find((e=>e.id===N)),B=null!==(o=null===(s=j.dotsNav)||void 0===s?void 0:s.position)&&void 0!==o?o:"b";return(0,e.jsx)("div",{className:"flexbox-layout-setting h-100",css:this.getStyle()},(0,e.jsx)("div",{className:"h-100 w-100"},(0,e.jsx)(n.SettingCollapse,{css:e.css`border-bottom: 1px solid var(--light-800)`,label:k("views"),className:"p-3",isOpen:this.state.isShowViewList,onRequestOpen:this._showViewList,onRequestClose:this._hideViewList},(0,e.jsx)(n.SettingRow,{className:"mt-3"},(0,e.jsx)(i.Button,{css:L,className:"w-100",type:"primary",onClick:this._addView,title:k("newView")},(0,e.jsx)(ye,{className:"mr-0"}),(0,e.jsx)("span",{className:"ml-2"},k("newView")))),(0,e.jsx)("div",{ref:this.viewListRef,className:"toc-dropzone"},(0,e.jsx)(te.List,{size:"sm",className:"selected-fields-list",itemsJson:Array.from(A).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`}))),dndEnabled:!0,onUpdateItem:(i,s)=>{const{itemJsons:o}=s.props,[,n]=o,a=n.map((e=>e.itemStateDetailContent)),l=(0,e.Immutable)(j).set("views",a.map((e=>e.id)));(0,t.getAppConfigAction)().editSection(l).exec(),this._selectView(N)},isItemFocused:(e,t)=>{const{itemJsons:[i]}=t.props;return N===i.itemStateDetailContent.id},onClickItemBody:(e,t)=>{const{itemJsons:i}=t.props,s=i[0].itemStateDetailContent;this._selectView(s.id,!0)},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:te.TreeItemActionType.RenderOverrideItem,children:[{name:te.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemBody,children:[{name:te.TreeItemActionType.RenderOverrideItemDragHandle},{name:te.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(t,i)=>{const{itemJsons:s}=i.props,o=s[0],n=o.itemStateDetailContent,a=+o.itemKey;return(0,e.jsx)(ne,{index:a,canRemove:A.length>1,formatMessage:k,isLastItem:a===A.length-1,dispatch:T,sectionId:j.id,theme:M,view:n,isFirstItem:0===a,onSelect:e=>this._selectView(e,!0),selected:N===n.id,editable:D})}}))),(0,e.jsx)(n.SettingSection,{role:"group","aria-label":k("tools"),title:k("tools")},(0,e.jsx)(n.SettingRow,{label:k("arrows")},(0,e.jsx)(i.Switch,{"aria-label":k("arrows"),checked:null===(a=j.arrowsNav)||void 0===a?void 0:a.visible,onChange:()=>{var e,t;return this.updateNav("arrowsNav","visible",!(null!==(t=null===(e=j.arrowsNav)||void 0===e?void 0:e.visible)&&void 0!==t&&t))}})),(null===(r=j.arrowsNav)||void 0===r?void 0:r.visible)&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(n.SettingRow,{label:k("direction")},(0,e.jsx)(n.DirectionSelector,{size:"sm",vertical:"v"===j.arrowsNav.direction,onChange:e=>this.updateNav("arrowsNav","direction",e?"v":"h")})),(0,e.jsx)(n.SettingRow,{label:k("size"),flow:"wrap"},(0,e.jsx)(i.Slider,{min:5,max:100,step:1,value:null!==(c=j.arrowsNav.size)&&void 0!==c?c:12,css:e.css`width: 50%`,"aria-label":k("size"),onChange:e=>this.updateNav("arrowsNav","size",e.target.value)}),(0,e.jsx)(l.InputUnit,{min:5,max:100,units:Se,value:`${null!==(p=j.arrowsNav.size)&&void 0!==p?p:12}px`,onChange:e=>this.updateNav("arrowsNav","size",e.distance),css:e.css`width: 40%; margin-left: auto;`})),(0,e.jsx)(n.SettingRow,{label:k("offset"),flow:"wrap"},(0,e.jsx)(i.Slider,{min:-100,max:100,step:1,value:null!==(g=j.arrowsNav.offset)&&void 0!==g?g:0,css:e.css`width: 50%`,"aria-label":k("offset"),onChange:e=>this.updateNav("arrowsNav","offset",e.target.value)}),(0,e.jsx)(l.InputUnit,{min:-100,max:100,units:Se,value:`${null!==(h=j.arrowsNav.offset)&&void 0!==h?h:0}px`,onChange:e=>this.updateNav("arrowsNav","offset",e.distance),css:e.css`width: 40%; margin-left: auto;`}))),(0,e.jsx)(n.SettingRow,{label:k("dots")},(0,e.jsx)(i.Switch,{checked:null===(m=j.dotsNav)||void 0===m?void 0:m.visible,"aria-label":k("dots"),onChange:()=>{var e,t;return this.updateNav("dotsNav","visible",!(null!==(t=null===(e=j.dotsNav)||void 0===e?void 0:e.visible)&&void 0!==t&&t))}})),(null===(u=j.dotsNav)||void 0===u?void 0:u.visible)&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(n.SettingRow,{label:k("position")},(0,e.jsx)(we,{direction:B,formatMessage:k,onDirectionChange:e=>this.updateNav("dotsNav","position",e)})),(0,e.jsx)(n.SettingRow,{label:k("size"),flow:"wrap"},(0,e.jsx)(i.Slider,{min:5,max:30,step:1,value:null!==(f=j.dotsNav.size)&&void 0!==f?f:8,css:e.css`width: 50%`,"aria-label":k("size"),onChange:e=>this.updateNav("dotsNav","size",e.target.value)}),(0,e.jsx)(l.InputUnit,{min:5,max:30,units:Se,value:`${null!==(v=j.dotsNav.size)&&void 0!==v?v:8}px`,onChange:e=>this.updateNav("dotsNav","size",e.distance),css:e.css`width: 40%; margin-left: auto;`})),(0,e.jsx)(n.SettingRow,{label:k("offset"),flow:"wrap"},(0,e.jsx)(i.Slider,{min:-100,max:100,step:1,value:null!==(x=j.dotsNav.offset)&&void 0!==x?x:50,css:e.css`width: 50%`,"aria-label":k("offset"),onChange:e=>this.updateNav("dotsNav","offset",e.target.value)}),(0,e.jsx)(l.InputUnit,{min:-100,max:100,units:Se,value:`${null!==(w=j.dotsNav.offset)&&void 0!==w?w:50}px`,onChange:e=>this.updateNav("dotsNav","offset",e.distance),css:e.css`width: 40%; margin-left: auto;`})),(0,e.jsx)(n.SettingRow,{label:k("spacing"),flow:"wrap"},(0,e.jsx)(i.Slider,{min:0,max:30,step:1,value:null!==(I=j.dotsNav.spacing)&&void 0!==I?I:10,css:e.css`width: 50%`,"aria-label":k("spacing"),onChange:e=>this.updateNav("dotsNav","spacing",e.target.value)}),(0,e.jsx)(l.InputUnit,{min:0,max:30,units:Se,value:`${null!==(b=j.dotsNav.spacing)&&void 0!==b?b:10}px`,onChange:e=>this.updateNav("dotsNav","spacing",e.distance),css:e.css`width: 40%; margin-left: auto;`})))),(0,e.jsx)(n.SettingSection,{role:"group"},(0,e.jsx)(n.SettingRow,{label:k("autoPlay")},(0,e.jsx)(i.Switch,{"aria-label":k("autoPlay"),checked:j.autoPlay,onChange:this.onAutoPlayChanged})),j.autoPlay&&(0,e.jsx)(n.SettingRow,{label:k("interval")},(0,e.jsx)(i.NumericInput,{size:"sm",css:e.css`width: 4rem`,value:null!==(y=j.interval)&&void 0!==y?y:d.DEFAULT_AUTOPLAY_INTERVAL,min:1,max:3600,"aria-label":k("interval"),onAcceptValue:this.onIntervalChanged})),j.autoPlay&&(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(i.Label,{check:!0},(0,e.jsx)(i.Checkbox,{checked:null===(S=j.loop)||void 0===S||S,onChange:this.onLoopChanged,className:"mr-2"}),k("loop")))),(0,e.jsx)(n.SidePopper,{isOpen:P,position:"right",toggle:this.hideViewSetting,trigger:null===(C=this.viewListRef)||void 0===C?void 0:C.current,title:null==R?void 0:R.label},(0,e.jsx)(ae,{formatMessage:k,appTheme:this.props.appTheme,view:R}))))}}const je=e.ReactRedux.connect(((t,i)=>{var s,o,n,a,l,r,c,p,d,g;const{sectionId:h}=i,{appConfig:m}=t.appStateInBuilder,u=m.sections[h];if(!u)return null;const f=u.views.map((e=>m.views[e])),v=null===(n=null===(o=null===(s=t.appStateInBuilder)||void 0===s?void 0:s.appRuntimeInfo)||void 0===o?void 0:o.sectionNavInfos)||void 0===n?void 0:n[u.id],x=null!==(a=null==v?void 0:v.currentViewId)&&void 0!==a?a:u.views[0],w=null!==(p=null===(c=null===(r=null===(l=t.appStateInBuilder)||void 0===l?void 0:l.appConfig)||void 0===r?void 0:r.forBuilderAttributes)||void 0===c?void 0:c.lockLayout)&&void 0!==p&&p,I=null===(g=null===(d=t.appStateInBuilder)||void 0===d?void 0:d.appRuntimeInfo)||void 0===g?void 0:g.appMode;return{section:u,views:f,activeViewId:x,browserSizeMode:t.appStateInBuilder&&t.appStateInBuilder.browserSizeMode,editable:I===e.AppMode.Design&&!w}}))(Ce);var Ae=u(6262);class Me extends e.React.PureComponent{constructor(i){super(i),this.formatMessage=e=>this.props.formatMessage(e),this._enableEditing=e=>{e.stopPropagation(),this.setState({isEditingLabel:!0})},this._disableEditing=()=>{this._onLabelUpdate(this.inputRef.value),this.setState({isEditingLabel:!1})},this._handleInputEnter=e=>{"Enter"===e.key&&this.setState({isEditingLabel:!1})},this._onLabelUpdate=i=>{const{screen:s}=this.props;if(i&&`${i}`.trim().length>0){const o=(0,e.Immutable)(s).set("label",i);(0,t.getAppConfigAction)().editScreen(o).exec()}else this.inputRef.value=s.label},this._onLabelChange=e=>{this.setState({currentLabel:e.target.value})},this.toggleDropDown=e=>{null==e||e.stopPropagation(),this.setState({isDropDownOpen:!this.state.isDropDownOpen})},this.state={isEditingLabel:!1,currentLabel:this.props.screen.label,isDropDownOpen:!1},this.dropDownItems=[(0,e.Immutable)({label:this.formatMessage("rename"),event:this._enableEditing.bind(this),visible:!0,a11yFocusBack:!1}),(0,e.Immutable)({label:this.formatMessage("duplicate"),event:this._duplicateView.bind(this),visible:!0}),(0,e.Immutable)({label:this.formatMessage("sectionDelete"),event:this._removeScreen.bind(this),visible:!0})],this.readonlyDropDownItems=[this.dropDownItems[0]],this.dropDownItemsWithoutDelete=[this.dropDownItems[0],this.dropDownItems[1]]}componentDidUpdate(e,t){!t.isEditingLabel&&this.state.isEditingLabel&&this._focusInput(),e.screen.label!==this.props.screen.label&&this.setState({currentLabel:this.props.screen.label})}_removeScreen(e){e.stopPropagation();const{index:t}=this.props;this.props.onRemove(t)}_duplicateView(){const{index:e}=this.props;this.props.onDuplicate(e)}_focusInput(){this.inputRef&&(this.inputRef.select(),this.inputRef.focus())}_getStyle(){const{theme:t}=this.props;return e.css`
      padding: 2px 2px 2px 10px;
      cursor: pointer;
      position: relative;
      height: ${e.polished.rem(32)};

      .drop-down {
        text-align: right;
        .popover {
          .popover-inner {
            box-shadow: 0 0 0;
          }
        }
      }
      .drag-icon {
        visibility: hidden;
        color: ${t.colors.palette.dark[600]};
        cursor: move;
      }
      .screen-item-drag:hover {
        cursor: pointer !important;
      }
      .label-con {
        max-width: 10rem;
      }
      .label-input {
        max-width: 10rem;
      }
      .screen-item-drag {
        z-index: 1;
        background-color: transparent;
        box-shadow: none;
      }
    `}render(){const{index:t,browserSizeMode:s,editable:o}=this.props,{label:n}=this.props.screen,{isEditingLabel:a}=this.state,l=o&&s===e.BrowserSizeMode.Large?this.props.canRemove?this.dropDownItems:this.dropDownItemsWithoutDelete:this.readonlyDropDownItems;return(0,e.jsx)("div",{css:this._getStyle(),className:"d-flex justify-content-between flex-grow-1","data-testid":"screenItem"},(0,e.jsx)("div",{className:"w-100 screen-item-drag d-flex justify-content-between","data-index":t},(0,e.jsx)("div",{className:"d-flex align-items-center"},!a&&(0,e.jsx)("div",{title:n,className:"label-con text-truncate",onDoubleClick:this._enableEditing},n),a&&(0,e.jsx)("div",null,(0,e.jsx)(i.TextInput,{title:n,className:"label-input",type:"text",value:this.state.currentLabel,ref:e=>{this.inputRef=e},onChange:this._onLabelChange,onAcceptValue:this._disableEditing,onKeyUp:this._handleInputEnter}))),(0,e.jsx)("div",{className:"drop-down d-flex toc-item-icon"},(0,e.jsx)("div",{title:this.formatMessage("titleOption"),css:e.css`
              & > div {
                height: 100%;
              }
            `},(0,e.jsx)(i.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:this.toggleDropDown,isOpen:this.state.isDropDownOpen},(0,e.jsx)(i.DropdownButton,{arrow:!1,icon:!0,onClick:this.toggleDropDown,type:"tertiary"},(0,e.jsx)(oe,{size:"s"})),(0,e.jsx)(i.DropdownMenu,null,l.map(((t,s)=>(0,e.jsx)(i.DropdownItem,{key:s,onClick:t.event,a11yFocusBack:t.a11yFocusBack},t.label)))))))))}}const Te=e.ReactRedux.connect(((e,t)=>{const{screenId:i}=t,{appConfig:s}=e.appStateInBuilder;return{screen:s.screens[i]}}))(Me);var Ne=u(4703),De=u.n(Ne);const ke=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:De()},o)):e.React.createElement("svg",Object.assign({className:n},o))},Pe=[i.DistanceUnits.PIXEL,i.DistanceUnits.PERCENTAGE];class Le extends e.React.PureComponent{constructor(s){super(s),this.onMainBackgroundChange=e=>{const{screen:i}=this.props,s=i.setIn(["main","background"],e);(0,t.getAppConfigAction)().editScreen(s).exec()},this.onSideBackgroundChange=e=>{const{screen:i}=this.props,s=i.setIn(["panel","background"],e);(0,t.getAppConfigAction)().editScreen(s).exec()},this.setOverlay=e=>{const{screen:i}=this.props;let s=i.setIn(["panel","overlay"],e);e||(s=s.setIn(["panel","offset"],0),"center"===i.panel.side&&(s=s.setIn(["panel","side"],"left"))),(0,t.getAppConfigAction)().editScreen(s).exec()},this.updateWidth=e=>{var s,o,n;const{screen:a,viewportSize:l}=this.props,{distance:r,unit:c}=e;let p;if(d.utils.isPercentage(null===(s=a.panel)||void 0===s?void 0:s.size)&&c===i.DistanceUnits.PIXEL){const t=d.utils.fromRatio(null===(o=a.panel)||void 0===o?void 0:o.size,l.width);p=a.setIn(["panel","size"],`${Math.round(t)}${e.unit}`)}else if(d.utils.isPercentage(null===(n=a.panel)||void 0===n?void 0:n.size)||c!==i.DistanceUnits.PERCENTAGE)p=a.setIn(["panel","size"],`${e.distance}${e.unit}`);else{const e=d.utils.toRatio(r,l.width);p=a.setIn(["panel","size"],`${e}`)}(0,t.getAppConfigAction)().editScreen(p).exec()},this.updateSide=e=>{const{screen:i}=this.props,s=i.setIn(["panel","side"],e);(0,t.getAppConfigAction)().editScreen(s).exec()},this.updateOffsetX=e=>{const{screen:i}=this.props,s=i.setIn(["panel","offset"],`${e}px`);(0,t.getAppConfigAction)().editScreen(s).exec()},this.updatePadding=e=>{const{screen:i}=this.props,s=i.setIn(["panel","padding"],e);(0,t.getAppConfigAction)().editScreen(s).exec()},this.handleGapChange=e=>{const{screen:i}=this.props,s=(0,t.getAppConfigAction)(),o=i.setIn(["panel","gap"],e.distance);s.editScreen(o),Object.keys(i.panel.layout).map((e=>i.panel.layout[e])).forEach((t=>{s.editLayoutSetting({layoutId:t},{space:e.distance})})),s.exec()},this._getStyle=()=>{const t=this.props.theme?this.props.theme.colors.palette.dark[600]:"#c5c5c5",i=this.props.theme?this.props.theme.colors.palette.dark[600]:"#a8a8a8";return e.css`
      height: calc(100% - 40px);
      overflow: auto;
      & {
        width: 100%;
      }
      .inner-section {
        border-bottom: none;
        padding-bottom: 0;
      }
      .back-btn-con {
        margin: 1rem 0.25rem 0;
        cursor: pointer;
        align-items: center;
      }
      .screen-group-title {
        margin: 1rem 1rem 0;
      }
      .background-set-back {
        color: ${i};
        font-weight: 500;
      }
      .background-setting-con .form-group {
        margin-bottom: ${e.polished.rem(16)};
      }
      .background-setting-header {
        color: ${t};
        font-weight: 500;
      }
    `},this.isRTL=(0,e.getAppStore)().getState().appContext.isRTL}render(){var t,s,o;const{screen:a,formatMessage:r}=this.props;return a?(0,e.jsx)("div",{css:this._getStyle(),className:"pb-2"},(0,e.jsx)("div",{role:"group","aria-label":r("mainStage")},(0,e.jsx)("div",{className:"screen-group-title"},r("mainStage")),(0,e.jsx)(n.SettingSection,{title:r("background")},(0,e.jsx)(n.SettingRow,{role:"group","aria-label":r("background")},(0,e.jsx)(l.BackgroundSetting,{background:a.main.background,onChange:e=>this.onMainBackgroundChange(e)})))),a.panel&&(0,e.jsx)("div",{role:"group","aria-label":r("scrollingPanel")},(0,e.jsx)("div",{className:"screen-group-title"},r("scrollingPanel")),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("mode")},(0,e.jsx)("div",null,(0,e.jsx)(i.Label,{className:"mr-3 d-flex align-items-center"},(0,e.jsx)(i.Radio,{className:"mr-2",onChange:()=>this.setOverlay(!1),value:"docked",checked:!(null!==(t=a.panel.overlay)&&void 0!==t&&t)}),r("docked"))),(0,e.jsx)("div",null,(0,e.jsx)(i.Label,{className:"mr-3 d-flex align-items-center"},(0,e.jsx)(i.Radio,{className:"mr-2",onChange:()=>this.setOverlay(!0),value:"floating",checked:a.panel.overlay}),r("floatingScreen")))),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("size")},(0,e.jsx)(n.SettingRow,{label:r("width"),role:"group","aria-label":r("width")},(0,e.jsx)("div",{style:{width:110}},(0,e.jsx)(l.SizeEditor,{label:"W",availableUnits:Pe,mode:d.LayoutItemSizeModes.Custom,disableModeSelect:!0,value:a.panel.size,onChange:this.updateWidth})))),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("position")},(0,e.jsx)(n.SettingRow,{label:r("align")},(0,e.jsx)(i.ButtonGroup,{size:"sm","aria-label":r("align")},(0,e.jsx)(i.Tooltip,{title:r(this.isRTL?"right":"left"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,active:"left"===a.panel.side,"aria-pressed":"left"===a.panel.side,onClick:()=>this.updateSide("left")},(0,e.jsx)(ce,{size:"s",autoFlip:!0}))),a.panel.overlay&&(0,e.jsx)(i.Tooltip,{title:r("center"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,active:"center"===a.panel.side,"aria-pressed":"center"===a.panel.side,onClick:()=>this.updateSide("center")},(0,e.jsx)(ke,{size:"s"}))),(0,e.jsx)(i.Tooltip,{title:r(this.isRTL?"left":"right"),placement:"bottom"},(0,e.jsx)(i.Button,{icon:!0,active:"right"===a.panel.side,"aria-pressed":"right"===a.panel.side,onClick:()=>this.updateSide("right")},(0,e.jsx)(ue,{size:"s",autoFlip:!0}))))),(null===(s=a.panel)||void 0===s?void 0:s.overlay)&&(0,e.jsx)(n.SettingRow,{label:r("offsetX")},(0,e.jsx)(i.NumericInput,{value:parseInt(null!==(o=a.panel.offset)&&void 0!==o?o:"0"),onChange:this.updateOffsetX,size:"sm",css:e.css`width: 110px`,"aria-label":r("offsetX")}))),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("gap")},(0,e.jsx)(n.SettingRow,{role:"group","aria-label":r("gap")},(0,e.jsx)(l.InputUnit,{className:"w-100",value:{distance:a.panel.gap>=0?a.panel.gap:10,unit:void 0},min:0,onChange:this.handleGapChange}))),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("padding")},(0,e.jsx)(n.SettingRow,{role:"group","aria-label":r("padding")},(0,e.jsx)(l.Padding,{value:a.panel.padding,onChange:this.updatePadding}))),(0,e.jsx)(n.SettingSection,{className:"inner-section",title:r("background")},(0,e.jsx)(n.SettingRow,{role:"group","aria-label":r("background")},(0,e.jsx)(l.BackgroundSetting,{background:a.panel.background,onChange:e=>this.onSideBackgroundChange(e)}))))):null}}const Re=e.ReactRedux.connect(((t,i)=>{const{screenId:s}=i,{appConfig:o}=t.appStateInBuilder,n=e.utils.findViewportSize(o,t.browserSizeMode||e.BrowserSizeMode.Large);return{screen:o.screens[s],viewportSize:n}}))(Le);class Be extends e.React.PureComponent{constructor(i){super(i),this.sidePopperTrigger=e.React.createRef(),this.formatMessage=(t,i=!1)=>i?this.props.intl.formatMessage({id:t,defaultMessage:e.defaultMessages[t]}):this.props.formatMessage(t),this._addScreen=e=>{const i=(0,t.getAppConfigAction)(),{screenGroupId:s}=this.props;t.templateUtils.createScreenFromTemplate(i.appConfig,e,e.screenId,{}).then((({appConfig:e,newScreenId:i})=>{e=e.setIn(["screenGroups",s,"screens"],[].concat(e.screenGroups[s].screens,i)),t.builderAppSync.publishAppConfigChangeToApp(e),t.builderAppSync.publishScreenGroupNavInfoToApp(s,e.screenGroups[s].screens.length-1)})),this.closeScreenPopper()},this._duplicateScreen=e=>{const{screenGroupId:i}=this.props,s=(0,t.getAppConfigAction)();s.duplicateScreenByIndex(e,i),s.exec(),t.builderAppSync.publishScreenGroupNavInfoToApp(i,e+1)},this._duplicateActiveScreen=()=>{this._duplicateScreen(this.props.activeScreen)},this._selectScreen=e=>{const{screenGroupId:i,activeScreen:s}=this.props;s!==e&&t.builderAppSync.publishScreenGroupNavInfoToApp(i,e),this.setState({showScreenSetting:!0})},this._removeScreen=e=>{const{screenGroupId:i,screens:s,activeScreen:o}=this.props;(0,t.getAppConfigAction)().removeScreen(s[e],i).exec(),(o>e||o===e&&o===s.length-1)&&t.builderAppSync.publishScreenGroupNavInfoToApp(i,o-1)},this.getStyle=()=>e.css`
      .screen-list {
        padding: 0 1rem;
      }

      .setting-header {
        margin-bottom: 1rem;
      }

      .screen-group-title {
        font-size: 14px;
        color: var(--dark-900);
      }
    `,this.hideScreenSetting=()=>{this.setState({showScreenSetting:!1})},this.toggleScreenPopper=()=>{if(this.props.hasPanel)this.setState({showPopper:!this.state.showPopper});else{const e=(0,Ae.getScreenTemplates)().find((e=>"nopanel"===e.name));e&&this._addScreen(e)}},this.closeScreenPopper=()=>{this.setState({showPopper:!1})},this.popperRef=e.React.createRef(),this.state={showPopper:!1,showScreenSetting:!1}}showEditButtons(){const{editable:t,browserSizeMode:i}=this.props,s=i===e.BrowserSizeMode.Large;return t&&s}render(){var s;const{screenGroupId:o,screens:a,theme:l,dispatch:r,activeScreen:c,browserSizeMode:p,editable:d}=this.props,{showScreenSetting:g}=this.state;if(!a)return null;const h=e.css`
      cursor: pointer;
      margin-top: ${e.polished.rem(-8)};
    `;return(0,e.jsx)("div",{className:"screen-group-setting mb-4",css:this.getStyle()},(0,e.jsx)("div",{className:"h-100 screen-list",ref:this.sidePopperTrigger},(0,e.jsx)("div",{className:"d-flex align-items-center setting-header"},(0,e.jsx)("div",{className:"screen-group-title"},this.formatMessage("screen"))),this.showEditButtons()&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)("div",{className:"mt-3"},(0,e.jsx)(i.Button,{ref:this.popperRef,"aria-label":this.formatMessage("newScreen"),css:h,type:"primary",onClick:this.toggleScreenPopper,className:"w-100"},(0,e.jsx)(ye,{className:"mr-0"}),(0,e.jsx)("span",{className:"ml-2"},this.formatMessage("newScreen")))),this.state.showPopper&&(0,e.jsx)(n.TemplateSelector,{templates:(0,Ae.getScreenTemplates)(),referenceElement:this.popperRef.current,onItemSelect:this._addScreen,onClose:this.closeScreenPopper})),(0,e.jsx)(te.List,{size:"sm",className:"selected-fields-list mt-3",itemsJson:Array.from(a).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`}))),dndEnabled:!0,onUpdateItem:(e,i)=>{const{itemJsons:s}=i.props,[,n]=s,l=n.map((e=>e.itemStateDetailContent)),r=a[c],p=l.indexOf(r);(0,t.getAppConfigAction)().editScreenGroupProperty(o,"screens",l).exec(),this._selectScreen(p)},onClickItemBody:(e,t)=>{const{itemJsons:i}=t.props,s=+i[0].itemKey;this._selectScreen(s)},isItemFocused:(e,t)=>{const{itemJsons:[i]}=t.props;return a[c]===i.itemStateDetailContent},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:te.TreeItemActionType.RenderOverrideItem,children:[{name:te.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemBody,children:[{name:te.TreeItemActionType.RenderOverrideItemDragHandle},{name:te.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(t,i)=>{const{itemJsons:s}=i.props,n=s[0],g=n.itemStateDetailContent,h=+n.itemKey;return(0,e.jsx)(Te,{key:g,index:h,screenGroupId:o,screenId:g,canRemove:a.length>1,formatMessage:this.formatMessage,dispatch:r,theme:l,editable:d,onRemove:this._removeScreen,onDuplicate:this._duplicateScreen,selected:a[c]===g,browserSizeMode:p})}})),(0,e.jsx)(n.SidePopper,{isOpen:g,position:"right",toggle:this.hideScreenSetting,trigger:null===(s=this.sidePopperTrigger)||void 0===s?void 0:s.current,title:this.props.activeScreenLabel},(0,e.jsx)(Re,{formatMessage:this.formatMessage,theme:this.props.theme,screenId:a[c],hideBackgroundWidget:this.hideScreenSetting})))}}const Oe=e.ReactRedux.connect(((t,i)=>{var s,o,n,a,l,r,c,p,d,g,h,m;const{screenGroupId:u}=i,{appConfig:f}=t.appStateInBuilder,v=f.screenGroups[u];if(!v)return null;const x=f.screens[v.screens[0]],w=null!==(a=null===(n=null===(o=null===(s=t.appStateInBuilder)||void 0===s?void 0:s.appConfig)||void 0===o?void 0:o.forBuilderAttributes)||void 0===n?void 0:n.lockLayout)&&void 0!==a&&a,I=null===(r=null===(l=t.appStateInBuilder)||void 0===l?void 0:l.appRuntimeInfo)||void 0===r?void 0:r.appMode,b=v.screens,y=null!==(h=null===(g=null===(d=null===(p=null===(c=t.appStateInBuilder)||void 0===c?void 0:c.appRuntimeInfo)||void 0===p?void 0:p.screenGroupNavInfos)||void 0===d?void 0:d[u])||void 0===g?void 0:g.activeIndex)&&void 0!==h?h:0,S=b[y];return{screens:b,activeScreen:y,activeScreenLabel:null===(m=f.screens[S])||void 0===m?void 0:m.label,browserSizeMode:t.appStateInBuilder.browserSizeMode,hasPanel:null!=x.panel,editable:I===e.AppMode.Design&&!w}}))(Be);class ze extends e.React.PureComponent{constructor(){super(...arguments),this.renderItemSetting=()=>{let i=null;if(this.props.layoutType===e.LayoutType.FixedLayout)i=p.FixedLayoutItemSetting;else if(this.props.layoutType===e.LayoutType.FlowLayout)i=p.FlowLayoutItemSetting;else if(this.props.layoutType===e.LayoutType.ColumnLayout)i=p.ColumnLayoutItemSetting;else if(this.props.layoutType===e.LayoutType.RowLayout)i=p.RowLayoutItemSetting;else if(this.props.layoutType===e.LayoutType.GridLayout)i=p.GridLayoutItemSetting;else{const{containerWidgetId:e,hasLayoutSetting:s}=this.props;s&&(i=t.WidgetSettingManager.getInstance().getItemSettingClass(e))}return i?(0,e.jsx)(e.ErrorBoundary,null,(0,e.jsx)(i,{layoutId:this.props.layoutId,layoutItem:this.props.layoutItem,isLockLayout:this.props.isLockLayout,supportAutoSize:this.props.supportAutoSize,style:this.props.style,onSettingChange:this.props.onSettingChanged,onStyleChange:this.props.onStyleChange,onPosChange:this.props.onPosChanged,formatMessage:this.props.formatMessage})):(0,e.jsx)(n.SettingSection,null,(0,e.jsx)("div",{className:"w-100 justify-content-center d-flex"},this.props.formatMessage("noStyle")))}}componentDidUpdate(){this.loadItemSettingClass()}componentDidMount(){this.loadItemSettingClass()}loadItemSettingClass(){const{containerWidgetId:e,hasLayoutSetting:i}=this.props;e&&i&&!t.WidgetSettingManager.getInstance().getItemSettingClass(e)&&t.WidgetSettingManager.getInstance().loadItemSettingClass(e)}getStyle(){return e.css`
      &.single-setting {
        border-top: 1px solid var(--light-800);
      }
    `}render(){const{isSingle:t=!1}=this.props;return(0,e.jsx)("div",{className:(0,e.classNames)("setting-container",{"single-setting":t}),css:this.getStyle()},this.renderItemSetting())}}const Ee=e.ReactRedux.connect(((t,i)=>{var s,o,n,a,l,r,c,p,g,h,m;const{layoutId:u,layoutItemId:f}=i,v=null===(s=t.appStateInBuilder)||void 0===s?void 0:s.appConfig.layouts,x=null==v?void 0:v[u];let w=null,I=!0;if(!x)return null;const b=d.searchUtils.findLayoutItem(t.appStateInBuilder.appConfig,{layoutId:u,layoutItemId:f}),y=d.searchUtils.getWidgetIdThatUseTheLayoutId(t.appStateInBuilder.appConfig,u);let S=!1;y&&(S=null!==(a=null===(n=null===(o=t.appStateInBuilder.appConfig.widgets[y].manifest)||void 0===o?void 0:o.properties)||void 0===n?void 0:n.hasLayoutItemSettingPage)&&void 0!==a&&a);const C=null==b?void 0:b.type;if(C===e.LayoutItemType.Widget&&b.widgetId){const e=t.appStateInBuilder.appConfig.widgets[b.widgetId];w=e.style,I=null===(c=null===(r=null===(l=e.manifest)||void 0===l?void 0:l.properties)||void 0===r?void 0:r.supportAutoSize)||void 0===c||c}else C===e.LayoutItemType.Section&&(w=t.appStateInBuilder.appConfig.sections[b.sectionId].style,I=!1);return{containerWidgetId:y,hasLayoutSetting:S,style:w,supportAutoSize:I,layoutType:x.type,layoutItem:b,runtimeInfo:t.builder.widgetsSettingRuntimeInfo[y],isLockLayout:null!==(m=null===(h=null===(g=null===(p=t.appStateInBuilder)||void 0===p?void 0:p.appConfig)||void 0===g?void 0:g.forBuilderAttributes)||void 0===h?void 0:h.lockLayout)&&void 0!==m&&m}}))(ze);var Ue=u(1407),We=u.n(Ue);const Ze=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:We()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var Ve;!function(e){e.MessageChoose="MESSAGECHOOSE",e.TargetChoose="TARGETCHOOSE",e.ActionChoose="ACTIONCHOOSE",e.ActionSetting="ACTIONSETTING"}(Ve||(Ve={}));class He extends e.React.PureComponent{getStyle(t){var i,s,o;return e.css`
      .setting-header {
        padding: ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(0)} ${e.polished.rem(16)}
      }
      .setting-title {
        font-size: ${e.polished.rem(16)};
        color: ${null===(o=null===(s=null===(i=null==t?void 0:t.colors)||void 0===i?void 0:i.palette)||void 0===s?void 0:s.dark)||void 0===o?void 0:o[600]}
      }
      .back-setting {
        padding: 0;
      }
    `}render(){return(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"w-100 d-flex align-items-center justify-content-between setting-header border-0"},this.props.Routes.length>1&&!this.props.hideBackArrow&&(0,e.jsx)(i.Button,{type:"tertiary",size:"sm",className:"d-flex align-items-center h-100 back-setting",style:{cursor:"pointer"},title:this.props.title,onClick:this.props.onBack},(0,e.jsx)(Ze,{autoFlip:!0,className:"text-dark"})),(0,e.jsx)(i.PanelHeader,{level:1,className:"flex-grow-1",showClose:!0,onClose:this.props.onClose,title:this.props.title})),this.props.children)}}const Fe=(0,Z.withTheme)(He);var Ge=u(224),$e=u.n(Ge);const Je=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:$e()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class _e extends e.React.PureComponent{constructor(){super(...arguments),this.searchItems=e=>{},this.onSelectMessageType=i=>{const s=(0,t.getAppConfigAction)().appConfig,o={id:e.appConfigUtils.getUniqueId(s,"messageConfig"),widgetId:this.props.widgetId,messageType:i,actions:[]};this.props.onSelected((0,e.Immutable)(o))},this.getPublishMessages=()=>{var i,s;const o=(0,t.getAppConfigAction)().appConfig.widgets[this.props.widgetId].manifest.publishMessages,n=[];if(o)for(let t=0;t<o.length;t++){let a=!1;if(this.props.messages)for(let e=0;e<this.props.messages.length;e++){const n=(null===(i=o[t])||void 0===i?void 0:i.messageType)?null===(s=o[t])||void 0===s?void 0:s.messageType:o[t];if(this.props.messages[e].messageType===n){a=!0;break}}if(!a){const i=o[t],s=(null==i?void 0:i.messageType)||i;n.push({messageType:s,messageLabel:(0,e.getMessageTypeLabel)(s,this.props.intl)})}}return n}}getStyle(t){return e.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .choose-message-list {
        .list-item {
          color: ${t.colors.black};
        }
        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${e.polished.rgba(t.colors.white,1)};
          color: ${t.colors.palette.dark[200]} !important;
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${t.colors.palette.light[500]};
            user-select: none;
            font-size: ${e.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${t.colors.palette.light[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${t.colors.white};
          }
        }
      }
    `}render(){const t=this.getPublishMessages();return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"w-100 choose-message-list"},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"w-100",style:{display:"none"}},(0,e.jsx)(i.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchTrigger"),onChange:this.searchItems,value:""}),(0,e.jsx)(Je,{className:"p-0 searchIcon"})),(0,e.jsx)("div",{className:"w-100 list"},0===t.length&&(0,e.jsx)("div",{className:"d-flex mb-2 p-1 text-break"},this.props.formatMessage("noMessage")),t.length>0&&t.map(((t,s)=>(0,e.jsx)(i.Button,{type:"tertiary",className:"text-left list-item mb-2 pt-1 pb-1 pl-2 pr-2 w-100 align-items-center",key:s,onClick:()=>this.onSelectMessageType(t.messageType),title:t.messageLabel},t.messageLabel))))))))}}const Qe=(0,Z.withTheme)((0,e.injectIntl)(_e));class Ke extends e.React.PureComponent{constructor(){super(...arguments),this.searchItems=e=>{},this.getActions=()=>{const e=[],i=[];let s=null;this.props.target.id,s=this.props.target;const o=t.AppMessageManager.getInstance().getFilteredActions(this.props.message.messageType,this.props.widgetId);for(let t=0;t<o.length;t++)i.includes(o[t].name)||o[t].widgetId!==s.id||(i.push(o[t].name),e.push(o[t]));return e},this.onSelectAction=t=>{let i,s=this.props.message,o=null;this.props.target.id,o=this.props.target,i=o.id?(0,e.getAppStore)().getState().appStateInBuilder?(0,e.getAppStore)().getState().appStateInBuilder.appConfig.widgets[o.id].manifest.version:null:e.version;const n={actionId:t.id+"-"+(new Date).getTime().toString(),widgetId:o.id,messageWidgetId:this.props.widgetId,actionName:t.name,description:null,config:this.checkIsSupportActionSetting(t)?null:void 0,version:i};s=s.set("actions",s.actions.concat(n)),this.props.onSelected(s,n)},this.checkIsSupportActionSetting=e=>!!t.AppMessageManager.getInstance().getActionSettingComponentUri(e,this.props.message.messageType,this.props.message.widgetId)}getStyle(t){return e.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .action-choose-list {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${e.polished.rgba(t.colors.white,1)};
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${t.colors.palette.light[500]};
            user-select: none;
            font-size: ${e.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${t.colors.palette.light[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${t.colors.white};
          }
        }
      }
    `}render(){const t=this.getActions();return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"w-100 action-choose-list"},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"w-100",style:{display:"none"}},(0,e.jsx)(i.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchAction"),onChange:this.searchItems,value:""}),(0,e.jsx)(Je,{className:"p-0 searchIcon"})),(0,e.jsx)("div",{className:"w-100 list"},0===t.length&&(0,e.jsx)("div",{className:"d-flex mb-2 p-1 text-break"},this.props.formatMessage("noAction")),t.length>0&&t.map(((t,s)=>(0,e.jsx)(i.Button,{className:"d-flex list-item mb-2 pt-1 pb-1 pl-2 pr-2 w-100 align-items-center",key:s,title:t.label,onClick:()=>this.onSelectAction(t)},t.label))))))))}}const Xe=(0,Z.withTheme)(Ke);var Ye=u(3401),qe=u.n(Ye),et=u(3211),tt=u.n(et);const it=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component has-rtl-svg",s);return i?e.React.createElement(i,Object.assign({className:n,src:qe(),srcRTL:tt()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class st extends e.React.PureComponent{constructor(){super(...arguments),this.searchItems=e=>{},this.getTargets=()=>{const e=[],i=[],s=[],o=(0,t.getAppConfigAction)().appConfig,n=t.AppMessageManager.getInstance().getFilteredActions(this.props.message.messageType,this.props.message.widgetId);for(let t=0;t<n.length;t++)if(!s.includes(n[t].widgetId))if(s.push(n[t].widgetId),n[t].widgetId){const i=o.widgets[n[t].widgetId];if(i){if(i.id===this.props.message.widgetId)continue;e.push(i)}}else i.push({uri:n[t].id,label:"Framework"});return{widgetTargets:e,frameWorkTargets:i}},this.onSelectTarget=e=>{this.props.onSelected(e)}}getStyle(t){return e.css`
      height: calc(100% - 3.125rem);
      overflow-y: auto;

      .target-choose-list {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
          background-color: ${e.polished.rgba(t.colors.white,1)};
        }

        .seperateline-mt {
          margin-top: ${e.polished.rem(5)};
        }

        .seperateline-mb {
          margin-bottom: ${e.polished.rem(1)};
        }

        .seperateline {
          border-top: 1px solid ${t.colors.palette.light[500]};
        }

        .widgets-title {
          font-weight: 600;
          font-size: ${e.polished.rem(14)};
          color: ${t.colors.palette.dark[300]};
        }

        .nodata {
          font-size: ${e.polished.rem(13)};
        }

        button {
          color: ${t.colors.black};
        }

        .list{
          .list-item{
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid transparent;
            cursor: pointer;
            background-color: ${t.colors.palette.light[500]};
            user-select: none;
            font-size: ${e.polished.rem(13)};
          }
          .list-item:hover{
            background-color: ${t.colors.palette.light[600]};
          }
          .list-item:active.list-item:hover{
            background-color: ${t.colors.white};
          }
        }
      }
    `}render(){const t=this.getTargets(),s=t.frameWorkTargets,o=t.widgetTargets;return(0,e.jsx)("div",{className:"w-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"w-100 target-choose-list"},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,null,(0,e.jsx)("div",{className:"w-100",style:{display:"none"}},(0,e.jsx)(i.TextInput,{className:"w-100",placeholder:this.props.formatMessage("chooseSearchTarget"),onChange:this.searchItems,value:""}),(0,e.jsx)(Je,{autoFlip:!0,className:"p-0 searchIcon",size:"m"})),(0,e.jsx)("div",{className:"w-100 list"},0===s.length&&0===o.length&&(0,e.jsx)("div",{className:"d-flex justify-content-center nodata text-break"},this.props.formatMessage("noTargetWidgets")),s.map(((t,s)=>(0,e.jsx)(i.Button,{type:"tertiary",className:"d-flex list-item pt-1 pb-1 pl-2 pr-2 w-100 align-items-center",title:this.props.formatMessage(`action${t.label}`),key:s,onClick:()=>this.onSelectTarget(t)},(0,e.jsx)(it,{className:"mr-0",size:"m",autoFlip:!0}),(0,e.jsx)("div",{className:"ml-2"},this.props.formatMessage(`action${t.label}`))))),s.length>0&&0===o.length&&(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)("div",{className:"w-100 seperateline-mt seperateline-mb",style:{position:"relative",height:"20px"}},(0,e.jsx)("div",{className:"seperateline w-100",style:{top:"10px",position:"absolute"}})),(0,e.jsx)("div",{className:"w-100 widgets-title"},this.props.formatMessage("targetWidgets")),(0,e.jsx)("div",{className:"d-flex mt-2 nodata text-break"},this.props.formatMessage("noTargetWidgets"))),o.length>0&&(0,e.jsx)("div",{className:"w-100"},s.length>0&&(0,e.jsx)("div",{className:"w-100 seperateline-mb",style:{position:"relative",height:"20px"}},(0,e.jsx)("div",{className:"seperateline w-100",style:{top:"10px",position:"absolute"}})),(0,e.jsx)("div",{className:"w-100 widgets-title"},this.props.formatMessage("targetWidgets")),o.map(((t,s)=>{let o;const n=t.icon;return o=n&&n.svg?n:{svg:n},(0,e.jsx)(i.Button,{type:"tertiary",className:"d-flex list-item mt-2 p-1 w-100 align-items-center",title:t.label,key:s,onClick:()=>this.onSelectTarget(t)},(0,e.jsx)(i.Icon,{className:"mr-0",autoFlip:!0,width:16,height:16,icon:o.svg,color:o.properties&&o.properties.color}),(0,e.jsx)("div",{className:"ml-2"},t.label))}))))))))}}const ot=(0,Z.withTheme)(st);function nt(e){let i=null;i=e.widgetId?(0,t.getAppConfigAction)().appConfig.widgets[e.widgetId]:{label:"Framework"};let s=e.actionName;if(i.manifest)if(i.manifest.i18nMessages[`_action_${e.actionName}_label`])s=i.manifest.i18nMessages[`_action_${e.actionName}_label`];else{const t=i.manifest.messageActions;if(t)for(let i=0;i<t.length;i++)if(t[i].name===e.actionName){s=t[i].label;break}}else if("Framework"===i.label){const i=t.AppMessageManager.getInstance().getAllActions();for(let t=0;t<i.length;t++)if(e.actionId.includes(i[t].id)){s=i[t].label;break}}return s}class at extends e.React.PureComponent{constructor(){super(...arguments),this.searchItems=e=>{},this.onEditAction=e=>{e.config&&this.props.onClickEditAction(this.props.message,e)},this.onRemoveAction=(e,i)=>{e.stopPropagation();let s=this.props.message;const o=Object.assign([],s.actions),n=[];for(let e=0;e<o.length;e++)o[e].actionName===i.actionName&&n.push(o[e]);for(let e=0;e<o.length;e++)if(o[e].actionName===i.actionName&&o[e].widgetId===i.widgetId){const n=Object.assign([],o);n.splice(e,1),s=s.set("actions",n);const a=t.AppMessageManager.getInstance().getAction(i.widgetId,i.actionName);a&&a.onRemoveListen(s.messageType,s.widgetId);break}this.props.onMessageChanged(s)},this.onActionOrderChanged=e=>{let t=this.props.message;t=t.set("actions",e),this.props.onMessageChanged(t)},this.createActionItem=(s,o)=>{let n=null;return n=s.widgetId?(0,t.getAppConfigAction)().appConfig.widgets[s.widgetId]:{label:"Framework"},(0,e.jsx)("div",{className:"action-item flex-grow-1",css:this.getStyle(),onClick:()=>this.onEditAction(s)},(0,e.jsx)("div",{className:"d-flex w-100 justify-content-between align-items-center"},"Framework"===n.label&&(0,e.jsx)("div",{className:"widget-name text-truncate",title:this.props.formatMessage(`action${n.label}`)},this.props.formatMessage(`action${n.label}`)),"Framework"!==n.label&&(0,e.jsx)("div",{className:"widget-name text-truncate",title:n.label},n.label),(0,e.jsx)(i.Button,{className:"delete-item-button",type:"tertiary",size:"sm",icon:!0,onClick:e=>this.onRemoveAction(e,s),title:this.props.formatMessage("actionDelete")},(0,e.jsx)(F,{size:"s",className:"p-0 deleteIcon"}))),(0,e.jsx)("div",{className:"text-dark-600 d-flex align-items-center action-name"},(0,e.jsx)("div",{className:"w-100 text-truncate",title:nt(s)},nt(s))))},this.getActionList=()=>(0,e.jsx)("div",{style:{position:"relative"}},(0,e.jsx)(te.List,{size:"sm",className:"setting-ui-unit-list",itemsJson:this.props.message.actions.asMutable().map(((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`}))),dndEnabled:!0,onUpdateItem:(e,t)=>{if(e.updateType===te.TreeItemActionType.HandleDidDrop){const{itemJsons:[,e]}=t.props;this.onActionOrderChanged(e.map((e=>e.itemStateDetailContent)))}},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:te.TreeItemActionType.RenderOverrideItem,children:[{name:te.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:te.TreeItemActionType.RenderOverrideItemBody,children:[{name:te.TreeItemActionType.RenderOverrideItemDragHandle},{name:te.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(e,t)=>{const{itemJsons:i}=t.props,s=i[0],o=null==s?void 0:s.itemKey;return this.createActionItem(s.itemStateDetailContent,o)},isItemFocused:(e,t)=>{var i,s,o;const{itemJsons:[n]}=t.props;return(null===(s=null===(i=null==this?void 0:this.props)||void 0===i?void 0:i.action)||void 0===s?void 0:s.actionId)===(null===(o=null==n?void 0:n.itemStateDetailContent)||void 0===o?void 0:o.actionId)}}))}getStyle(){return e.css`
      & {
        position: relative
      }
      .drag-icon-con {
        position: absolute;
        top: ${e.polished.rem(23)};
        left: 0
      }
    `}render(){const t=(0,e.getMessageTypeLabel)(this.props.message.messageType,this.props.intl);return(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 message-item message-item-container mb-3",this.props.isActive?"active-border":"")},(0,e.jsx)("div",{className:"w-100 d-flex justify-content-between align-items-center"},(0,e.jsx)("h2",{className:"message-item-title",title:t},t),(0,e.jsx)(i.Button,{className:"close-message-button",type:"tertiary",size:"sm",onClick:()=>this.props.onMessageRemoved(this.props.message),title:this.props.formatMessage("sectionDelete")},(0,e.jsx)(F,{size:14,className:"p-0 deleteIcon"}))),this.props.message.actions&&this.props.message.actions.length>0&&this.getActionList(),(0,e.jsx)(i.Button,{className:"mt-2 item-add-action text-truncate w-100",onClick:()=>this.props.onClickAddAction(this.props.message),type:"tertiary",title:this.props.formatMessage("addAction")},`+ ${this.props.formatMessage("addAction")}`)))}}const lt=(0,e.injectIntl)(at);var rt=u(5506);class ct extends e.React.PureComponent{constructor(i){super(i),this.getActionSettingClass=()=>{const e=this.getActionSettingClassUri();t.AppMessageManager.getInstance().loadActionSettingClass(this.props.action,e).then((e=>{this.setState({settingClass:e})}))},this.onSettingChange=e=>{const t=e.actionId,i=e.config;this.state.cacheActionJson.config!==i&&t===this.state.cacheActionJson.actionId&&this.setState({cacheActionJson:this.state.cacheActionJson.set("config",i)},(()=>{this.updateAction(!1)}))},this.updateAction=e=>{let t=this.props.message;const i=Object.assign([],t.actions);let s=null;for(let e=0;e<i.length;e++)if(i[e].actionId===this.state.cacheActionJson.actionId&&i[e].widgetId===this.state.cacheActionJson.widgetId){const t=this.getAllUseDatasourceFormConfig();i[e]=i[e].set("config",this.state.cacheActionJson.config).set("useDataSources",t),s=i[e];break}t=t.set("actions",i),this.props.onUpdateAction(t,s,e)},this.getAllUseDatasourceFormConfig=()=>{const t=this.state.cacheActionJson.config,i=[],s=null==t?void 0:t.actionUseDataSource,o=null==t?void 0:t.messageUseDataSource;if(o&&i.push(o),s){const o=(null==t?void 0:t.sqlExprObj)||null,n=(0,rt.getJimuFieldNamesBySqlExpression)((0,e.Immutable)(o))||[],a=(null==s?void 0:s.fields)||[],l=(0,e.Immutable)(s).set("fields",Array.from(new Set(a.concat(n))));i.push(l)}return i},this.onDisableDoneBtn=e=>{this.setState({isDisableDoneBtn:e})},this.renderActionSetting=()=>{const t=this.state.settingClass;return t?e.React.createElement(e.ErrorBoundary,null,e.React.createElement(t,{actionId:this.state.cacheActionJson.actionId,widgetId:this.props.action.widgetId,messageWidgetId:this.props.widgetId,config:this.state.cacheActionJson.config?this.state.cacheActionJson.config:void 0,messageType:this.props.message.messageType,onSettingChange:this.onSettingChange,onDisableDoneBtn:this.onDisableDoneBtn})):e.React.createElement("div",null,this.props.formatMessage("actionSettingLoading"))},this.getActionSettingClassUri=()=>{const e=t.AppMessageManager.getInstance().getAllActions();let i=null,s=null;for(let t=0;t<e.length;t++)if(this.props.action.actionId.includes(e[t].id)){i=e[t];break}return i&&(s=t.AppMessageManager.getInstance().getActionSettingComponentUri(i,this.props.message.messageType,this.props.action.messageWidgetId)),s},this.state={settingClass:null,cacheActionJson:this.props.action,isDisableDoneBtn:!1}}componentDidMount(){this.getActionSettingClass()}componentDidUpdate(e){this.getActionSettingClass(),this.props.action!==e.action&&this.setState({cacheActionJson:this.props.action})}render(){const t=this.getActionSettingClassUri();return e.React.createElement("div",{className:"setting-container h-100",style:{overflowY:"auto"}},t?this.renderActionSetting():e.React.createElement("div",null,"  No widget"),e.React.createElement("div",{className:"w-100",style:{height:"50px"}}))}}var pt=u(748),dt=u.n(pt);const gt=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:dt()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class ht extends e.React.PureComponent{constructor(i){super(i),this.sidePopperTrigger=e.React.createRef(),this.popperFocusNode=e.React.createRef(),this.resetState=()=>{this.setState({currentTriggeredMessage:null,currentTriggeredTarget:null,currentTriggeredAction:null,panelRoutes:[]})},this.updateLocalState=(e,i)=>{const s=(0,t.getAppConfigAction)().appConfig;if(e.messageConfigs&&e.messageConfigs!==i.messageConfigs){let t=null,i=null,o=null;if(this.state.currentTriggeredMessage&&this.state.currentTriggeredMessage.messageType){const n=Object.keys(e.messageConfigs);for(let i=0;i<n.length;i++)if(e.messageConfigs[n[i]].messageType===this.state.currentTriggeredMessage.messageType&&e.messageConfigs[n[i]].widgetId===this.state.currentTriggeredMessage.widgetId){t=e.messageConfigs[n[i]];break}if(t&&this.state.currentTriggeredTarget)if(this.state.currentTriggeredTarget.id){const e=this.state.currentTriggeredTarget;if(this.state.panelRoutes&&this.state.panelRoutes.length>0&&this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.ActionChoose)i=s.widgets[e.id];else for(let o=0;o<t.actions.length;o++)if(t.actions[o].widgetId===e.id){i=s.widgets[e.id];break}}else{const e=this.state.currentTriggeredTarget;if(this.state.panelRoutes&&this.state.panelRoutes.length>0&&this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.ActionChoose)i=e;else for(let s=0;s<t.actions.length;s++)if(!t.actions[s].widgetId){i=e;break}}if(t&&this.state.currentTriggeredAction&&this.state.currentTriggeredAction.actionName)for(let e=0;e<t.actions.length;e++)if(t.actions[e].actionId===this.state.currentTriggeredAction.actionId&&t.actions[e].widgetId===this.state.currentTriggeredAction.widgetId&&t.actions[e].actionName===this.state.currentTriggeredAction.actionName){o=t.actions[e];break}}this.setState({currentTriggeredMessage:t,currentTriggeredTarget:i,currentTriggeredAction:o})}},this.getMessages=()=>{const e=this.props.messageConfigs,t=[],i=Object.keys(e);if(i.length>0)for(let s=0;s<i.length;s++)e[i[s]]&&e[i[s]].widgetId===this.props.widgetId&&t.push(e[i[s]]);return t},this.onShowMessageChooseList=()=>{const e=[{pathType:Ve.MessageChoose,message:null}];this.setState({panelRoutes:e})},this.onMessageRemoved=e=>{e.actions.forEach((i=>{const s=t.AppMessageManager.getInstance().getAction(i.widgetId,i.actionName);s&&s.onRemoveListen(e.messageType,e.widgetId)})),(0,t.getAppConfigAction)().removeMessage(e).exec()},this.onMessageChanged=e=>{this.setState({currentTriggeredMessage:e},(()=>{(0,t.getAppConfigAction)().editMessage(e).exec()}))},this.onShowTargetChooseList=e=>{const t=[{pathType:Ve.TargetChoose,message:e}];this.setState({currentTriggeredMessage:e,currentTriggeredAction:null,panelRoutes:t})},this.onShowActionSettingPage=(e,t)=>{const i=[{pathType:Ve.ActionSetting,message:e}];this.setState({currentTriggeredMessage:e,currentTriggeredAction:t,panelRoutes:i})},this.backForwardPanel=()=>{const e=Object.assign([],this.state.panelRoutes);if(e.splice(e.length-1,1),e[e.length-1].message){const i=e[e.length-1].message;this.setState({panelRoutes:e,currentTriggeredMessage:e[e.length-1].message},(()=>{(0,t.getAppConfigAction)().editMessage(i).exec()}))}else{const i=this.state.panelRoutes[this.state.panelRoutes.length-1].message;this.setState({panelRoutes:e,currentTriggeredMessage:null},(()=>{(0,t.getAppConfigAction)().removeMessage(i).exec()}))}},this.closePanel=()=>{var e,t;(null==this?void 0:this.popperFocusNode)&&(null===(t=null===(e=this.popperFocusNode)||void 0===e?void 0:e.current)||void 0===t||t.focus()),this.setState({panelRoutes:[]})},this.onMessageChooseListSelected=e=>{const i=Object.assign([],this.state.panelRoutes);i.push({pathType:Ve.TargetChoose,message:e}),this.setState({currentTriggeredMessage:e,panelRoutes:i},(()=>{(0,t.getAppConfigAction)().addMessage(e).exec()}))},this.onTargetChooseListSelected=e=>{const t=Object.assign([],this.state.panelRoutes);t.push({pathType:Ve.ActionChoose,message:this.state.currentTriggeredMessage}),this.setState({currentTriggeredTarget:e,panelRoutes:t})},this.onActionChooseListSelected=(i,s)=>{if(null===s.config){const o=Object.assign([],this.state.panelRoutes);o.push({pathType:Ve.ActionSetting,message:i}),this.setState({currentTriggeredMessage:i,currentTriggeredAction:(0,e.Immutable)(s),panelRoutes:o},(()=>{(0,t.getAppConfigAction)().editMessage(i).exec()}))}else this.setState({currentTriggeredMessage:i,currentTriggeredAction:null,panelRoutes:[]},(()=>{(0,t.getAppConfigAction)().editMessage(i).exec()}))},this.onUpdateAction=(e,i,s)=>{s?this.setState({currentTriggeredMessage:e,currentTriggeredAction:i,panelRoutes:[]},(()=>{(0,t.getAppConfigAction)().editMessage(e).exec()})):this.setState({currentTriggeredMessage:e,currentTriggeredAction:i},(()=>{(0,t.getAppConfigAction)().editMessage(e).exec()}))},this.modalStyle=e.css`
      position: absolute;
      top: 0;
      bottom: 0;
      width: 259px;
      height: 100%;
      padding-bottom: 1px;
      border-right: 1px solid ${this.props.theme.colors.white};
      border-bottom: 1px solid ${this.props.theme.colors.white};
    `,this.state={currentTriggeredMessage:null,currentTriggeredTarget:null,currentTriggeredAction:null,panelRoutes:[]}}componentDidUpdate(e){this.props.widgetId!==e.widgetId?this.resetState():this.updateLocalState(this.props,e)}render(){var t,s,o,a;const{formatMessage:l}=this.props,r=this.getMessages();return(0,e.jsx)("div",{className:"d-flex h-100 flex-column"},(0,e.jsx)("div",{ref:this.sidePopperTrigger},(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,{flow:"wrap"},(0,e.jsx)("div",{className:"w-100 justify-content-center d-flex"},(0,e.jsx)(i.Button,{className:"w-100",type:"primary",onClick:this.onShowMessageChooseList,"aria-describedby":"trigger-empty-tip",ref:this.popperFocusNode},(0,e.jsx)("div",{className:"w-100 text-truncate"},l("addTrigger"))))),(0,e.jsx)(n.SettingRow,{flow:"wrap"},r.map(((t,i)=>(0,e.jsx)(lt,{key:i,message:t,onMessageRemoved:this.onMessageRemoved,isActive:t===this.state.currentTriggeredMessage&&this.state.panelRoutes.length>0,onMessageChanged:this.onMessageChanged,onClickAddAction:this.onShowTargetChooseList,onClickEditAction:this.onShowActionSettingPage,formatMessage:l,action:this.state.panelRoutes.length>0&&this.state.currentTriggeredAction})))),this.state.panelRoutes.length>0&&!this.props.pageId&&(0,e.jsx)("div",null,this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.MessageChoose&&(0,e.jsx)(n.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(t=this.sidePopperTrigger)||void 0===t?void 0:t.current},(0,e.jsx)("div",{className:"bg-light-300 border-color-gray-400",css:this.modalStyle},(0,e.jsx)(Fe,{formatMessage:l,Routes:this.state.panelRoutes,title:l("selectTrigger"),onBack:this.backForwardPanel,onClose:this.closePanel},(0,e.jsx)(Qe,{widgetId:this.props.widgetId,onSelected:this.onMessageChooseListSelected,messages:r,formatMessage:l})))),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.TargetChoose&&this.state.currentTriggeredMessage&&(0,e.jsx)(n.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(s=this.sidePopperTrigger)||void 0===s?void 0:s.current},(0,e.jsx)("div",{className:"bg-light-300 border-color-gray-400",css:this.modalStyle},(0,e.jsx)(Fe,{formatMessage:l,Routes:this.state.panelRoutes,title:l("selectTarget"),onBack:this.backForwardPanel,onClose:this.closePanel},(0,e.jsx)(ot,{onSelected:this.onTargetChooseListSelected,message:this.state.currentTriggeredMessage,formatMessage:l})))),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.ActionChoose&&this.state.currentTriggeredMessage&&this.state.currentTriggeredTarget&&(0,e.jsx)(n.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(o=this.sidePopperTrigger)||void 0===o?void 0:o.current},(0,e.jsx)("div",{className:"bg-light-300 border-color-gray-400",css:this.modalStyle},(0,e.jsx)(Fe,{formatMessage:l,Routes:this.state.panelRoutes,title:l("selectAction"),onBack:this.backForwardPanel,onClose:this.closePanel},(0,e.jsx)(Xe,{widgetId:this.props.widgetId,onSelected:this.onActionChooseListSelected,message:this.state.currentTriggeredMessage,target:this.state.currentTriggeredTarget,formatMessage:l})))),this.state.panelRoutes[this.state.panelRoutes.length-1].pathType===Ve.ActionSetting&&this.state.currentTriggeredMessage&&this.state.currentTriggeredAction&&(0,e.jsx)(n.SidePopper,{isOpen:!0,position:"right",toggle:this.closePanel,trigger:null===(a=this.sidePopperTrigger)||void 0===a?void 0:a.current},(0,e.jsx)("div",{className:"bg-light-300 border-color-gray-400",css:this.modalStyle},(0,e.jsx)(Fe,{hideBackArrow:!0,formatMessage:l,Routes:this.state.panelRoutes,title:`${l("actionSet")}`,onBack:this.backForwardPanel,onClose:this.closePanel},(0,e.jsx)(ct,{widgetId:this.props.widgetId,message:this.state.currentTriggeredMessage,action:this.state.currentTriggeredAction,onUpdateAction:this.onUpdateAction,formatMessage:l}))))))),0===r.length&&(0,e.jsx)("div",{className:"flex-grow-1 text-center no-trigger-tip position-relative"},(0,e.jsx)("div",{className:"position-absolute"},(0,e.jsx)(gt,{size:48}),(0,e.jsx)("p",{className:"trigger-tip",id:"trigger-empty-tip"},l("noTriggerTip",{ButtonString:l("addTrigger")})))))}}var mt=u(9788),ut=u.n(mt);const ft=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:ut()},o)):e.React.createElement("svg",Object.assign({className:n},o))};function vt(t){const{enabled:s,isOpen:o,icon:n,label:a,onEnableToggled:l,onOpenToggled:r,formatMessage:c}=t;return(0,e.jsx)("div",{className:"d-flex align-items-center px-1"},(0,e.jsx)(i.Label,{className:"d-flex align-items-center",css:e.css`max-width: 85%;`},(0,e.jsx)(i.Checkbox,{checked:s,onChange:l}),(0,e.jsx)(i.Icon,{className:"ml-2",icon:n}),(0,e.jsx)("span",{className:"ml-2 text-truncate",title:a},a)),(0,e.jsx)(i.Button,{className:"ml-auto p-0",size:"sm",type:"tertiary",icon:!0,onClick:r,disabled:!s,"aria-label":c(o?"hide":"show")},(0,e.jsx)(ft,{size:"s",css:e.css`transform: rotateZ(${o&&s?180:0}deg);`})))}function xt(s){const{widgetId:o,enabled:a,items:l,dataActions:r=(0,e.Immutable)({}),isBatch:c,formatMessage:p,onEnableToggled:d}=s,[g,h]=e.React.useState(!0),m=l[0],u=e.React.useCallback((()=>{h(!g)}),[g,h]),f=[];l.forEach((e=>{var t,i,s,o;(null===(o=null===(s=(null!==(i=null===(t=null==r?void 0:r[e.name])||void 0===t?void 0:t.actions)&&void 0!==i?i:{})[e.widgetId])||void 0===s?void 0:s.enabled)||void 0===o||o)&&f.push(e.widgetId)}));const v=e.React.useCallback((t=>e.i18n.getIntl().formatMessage({id:"numSelected"},{number:t.length})),[]),x=e.React.useCallback((()=>l.map((s=>{var o,n,a;const l=null!==(a=(null!==(n=null===(o=null==r?void 0:r[s.name])||void 0===o?void 0:o.actions)&&void 0!==n?n:{})[s.widgetId])&&void 0!==a?a:(0,e.Immutable)({}),c=(0,t.getAppConfigAction)().appConfig.widgets[s.widgetId];return{value:s.widgetId,label:c.label,render:(t,s)=>{var o;return(0,e.jsx)(i.Label,{className:"d-flex w-100 align-items-center mb-0"},(0,e.jsx)(i.Checkbox,{checked:null===(o=l.enabled)||void 0===o||o}),(0,e.jsx)("span",{className:"ml-2"},c.label))}}}))),[l,r]),w=e.React.useCallback(((i,s)=>{var n,a,l,p;const d=null===(p=null===(l=(null!==(a=null===(n=null==r?void 0:r[m.name])||void 0===n?void 0:n.actions)&&void 0!==a?a:(0,e.Immutable)({}))[s])||void 0===l?void 0:l.enabled)||void 0===p||p;(0,t.getAppConfigAction)().editWidgetProperty(o,c?"batchDataActions":"dataActions",r.setIn([m.name,"actions",s,"enabled"],!d)).exec()}),[r,c,o,m.name]);return(0,e.jsx)(n.SettingSection,{title:(0,e.jsx)(vt,{enabled:a,icon:m.icon,label:m.label,isOpen:g,onEnableToggled:d,onOpenToggled:u,formatMessage:p}),className:(0,e.classNames)({"pb-0":!g||!a,"data-action-item":!0,[`data-action-${m.name}`]:!0}),css:e.css`
        border-bottom: ${g&&a?"1px solid var(--light-800)":"none !important"};
      `},(0,e.jsx)(i.Collapse,{isOpen:g&&a,className:"mt-0"},(0,e.jsx)(n.SettingRow,{flow:"wrap",label:p("selectWidgets"),className:"mt-2",css:e.css`
            .jimu-widget-setting--row-label {
              padding-left: 0.25rem;
              padding-right: 0.25rem;
            }
          `},(0,e.jsx)(i.MultiSelect,{fluid:!0,"aria-label":p("selectWidgets"),items:(0,e.Immutable)(x()),onClickItem:w,values:(0,e.Immutable)(f),displayByValues:v,className:"px-1"})),s.children))}var wt=u(9395),It=u.n(wt);const bt=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:It()},o)):e.React.createElement("svg",Object.assign({className:n},o))};var yt=u(5234),St=u.n(yt);const Ct=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:St()},o)):e.React.createElement("svg",Object.assign({className:n},o))};class jt extends e.React.PureComponent{constructor(e){super(e),this.handleEnableDataActionChanged=e=>{const i=(0,t.getAppConfigAction)().appConfig.widgets[this.props.widgetId];(0,t.getAppConfigAction)().editWidget(i.set(this.props.isBatch?"enableBatchDataAction":"enableDataAction",e.target.checked)).exec()},this.state={settingClasses:{}}}componentDidMount(){const e=t.AppDataActionManager.getInstance().loadAllActionSettingClasses(),i=Object.keys(null!=e?e:{});if(i.length>0){const t=i.map((t=>{return i=this,s=void 0,n=function*(){return yield e[t]},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{r(n.next(e))}catch(e){t(e)}}function l(e){try{r(n.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(a,l)}r((n=n.apply(i,s||[])).next())}));var i,s,o,n}));Promise.allSettled(t).then((e=>{const t={};e.forEach(((e,s)=>{"fulfilled"===e.status?t[i[s]]=e.value:console.error(e.reason)})),this.setState({settingClasses:t})})).catch((e=>console.error(e)))}}getAvailableActions(){var i,s;const o={},n=(0,t.getAppConfigAction)(),a=n.appConfig.widgets[this.props.widgetId],l=this.props.isBatch?null===(i=a.manifest)||void 0===i?void 0:i.excludeBatchDataActions:null===(s=a.manifest)||void 0===s?void 0:s.excludeDataActions,r=e.DataActionManager.getInstance(),c=this.props.appMode===e.AppMode.Design,p=this.props.appMode===e.AppMode.Design;return this.getAllWidgetsInSameRootContainer(n.appConfig,this.props.widgetId,this.props.sizeMode,c,p).forEach((t=>{var i,s;if(t===this.props.widgetId)return;const a=n.appConfig.widgets[t],c=this.props.isBatch?null===(i=a.manifest)||void 0===i?void 0:i.batchDataActions:null===(s=a.manifest)||void 0===s?void 0:s.dataActions;(null==c?void 0:c.length)>0&&c.forEach((i=>{var s,n;const c=`${null===(s=a.manifest)||void 0===s?void 0:s.name}.${i.name}`;if(r.isActionExcluded(c,l))return;o[i.name]||(o[i.name]=[]);const p=e.urlUtils.isAbsoluteUrl(a.uri)?`${a.uri}dist/${i.icon}`:`${e.moduleLoader.resolveModuleFullPath("widgets/")}../${a.uri}dist/${i.icon}`;o[i.name].push({name:i.name,icon:p,label:null!==(n=a.manifest.i18nMessages[`_action_${i.name}_label`])&&void 0!==n?n:i.label,widgetId:t,settingUri:`${a.uri}dist/${i.settingUri}`})}))})),o}getAllWidgetsInSameRootContainer(t,i,s,o,n){const a=d.searchUtils.getContentRootContainerInfo(t,i,e.LayoutItemType.Widget,s,o),l=this.props.currentPageId;return d.searchUtils.getContentsInContainerRecursiveAdv(t,a,e.LayoutItemType.Widget,s,{includePending:o,includeOtherSizeMode:n,currentPageId:l})}updateActionStatus(i,s){var o,n;const{widgetId:a,isBatch:l}=this.props,r=(0,t.getAppConfigAction)(),c=r.appConfig.widgets[a],p=l?null!==(o=c.batchDataActions)&&void 0!==o?o:(0,e.Immutable)({}):null!==(n=c.dataActions)&&void 0!==n?n:(0,e.Immutable)({});r.editWidgetProperty(a,l?"batchDataActions":"dataActions",p.setIn([i,"enabled"],s)).exec()}createActionItemSetting(t,i){const s=this.state.settingClasses[t.settingUri];return s?(0,e.jsx)(n.SettingRow,null,(0,e.jsx)(s,{widgetId:this.props.widgetId,actionName:t.name,config:i,onSettingChange:e=>{this.updateActionItemSetting(t.name,e)}})):null}updateActionItemSetting(i,s){var o,n;const{widgetId:a,isBatch:l}=this.props,r=(0,t.getAppConfigAction)(),c=r.appConfig.widgets[a],p=l?null!==(o=c.batchDataActions)&&void 0!==o?o:(0,e.Immutable)({}):null!==(n=c.dataActions)&&void 0!==n?n:(0,e.Immutable)({});r.editWidgetProperty(a,l?"batchDataActions":"dataActions",p.setIn([i,"config"],s)).exec()}createActionItem(t,i,s){var o,n,a;const{dataActions:l,isBatch:r}=this.props,c=null===(n=null===(o=null==l?void 0:l[t])||void 0===o?void 0:o.enabled)||void 0===n||n,p=i[0];return(0,e.jsx)(xt,{key:s,widgetId:this.props.widgetId,enabled:c,items:i,dataActions:l,isBatch:r,formatMessage:this.props.formatMessage,onEnableToggled:()=>this.updateActionStatus(t,!c)},c&&p.settingUri&&this.createActionItemSetting(p,null===(a=null==l?void 0:l[t])||void 0===a?void 0:a.config))}createExportNotes(t=!1){return(0,e.jsx)("div",{className:(0,e.classNames)("d-flex w-100 pr-1 align-items-center",{"mt-3":t,"pl-5":t,"pl-2":!t}),css:e.css`color: var(--dark-500); font-size: 13px;`},(0,e.jsx)(bt,{color:"var(--dark-50)"}),(0,e.jsx)("span",{className:"ml-2"},this.props.formatMessage("export")),(0,e.jsx)(i.Tooltip,{placement:"bottom",css:e.css`max-width: 300px; margin-left: auto;`,showArrow:!0,title:this.props.formatMessage("exportNotes")},(0,e.jsx)(i.Button,{className:"ml-auto",type:"tertiary",icon:!0},(0,e.jsx)(m,{className:"mr-1",size:"s",color:"var(--dark-50)"}))))}createEnableBtn(t){const{formatMessage:s,enableDataAction:o,isBatch:n}=this.props,a=n?"enableBatchDataAction":"enableDataAction",l=n?"batchDataActionTooltip":"dataActionTooltip";return(0,e.jsx)("div",{className:"w-100 d-flex justify-content-between align-items-center px-1"},(0,e.jsx)("div",{className:"title d-flex",css:e.css`max-width: 80%; color: var(--dark-800)`},(0,e.jsx)("div",{className:"text-truncate setting-text-level-1",title:s(a)},s(a)),(0,e.jsx)(i.Tooltip,{placement:"left",css:e.css`max-width: 300px;`,showArrow:!0,title:s(l)},(0,e.jsx)(i.Button,{className:"ml-2",icon:!0,size:"sm",type:"tertiary"},(0,e.jsx)(m,{size:"s"})))),(0,e.jsx)(i.Switch,{"aria-label":s(a),"aria-describedby":t?"noDataActionDesc":void 0,checked:o,onChange:this.handleEnableDataActionChanged}))}render(){const{enableDataAction:t,isBatch:i}=this.props,s=this.getAvailableActions(),o=Object.keys(s).sort();return 0===o.length?(0,e.jsx)(n.SettingSection,{className:(0,e.classNames)({"h-100":t,"d-flex":!0,"flex-column":!0,"data-action-list":!0})},this.createEnableBtn(!0),t&&(0,e.jsx)("div",{className:"d-flex flex-column align-items-center flex-grow-1 mt-3"},this.createExportNotes(),(0,e.jsx)("div",{className:"d-flex flex-column justify-content-center align-items-center flex-grow-1"},(0,e.jsx)(Ct,{size:42,color:"var(--dark-200)"}),(0,e.jsx)("p",{id:"noDataActionDesc",className:"p-2",css:e.css`color: var(--dark-500); text-align: center;`},this.props.formatMessage(i?"noBatchDataAction":"noDataAction"))))):(0,e.jsx)(n.SettingSection,{className:(0,e.classNames)({"h-100":t,"data-action-list":!0})},this.createEnableBtn(!1),t&&(0,e.jsx)(e.React.Fragment,null,o.map(((e,t)=>this.createActionItem(e,s[e],t))),this.createExportNotes(!0)))}}const At=e.ReactRedux.connect(((e,t)=>{var i,s,o,n,a,l,r;const c=null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.widgets[t.widgetId];return{dataActions:t.isBatch?null==c?void 0:c.batchDataActions:null==c?void 0:c.dataActions,sizeMode:null===(o=e.appStateInBuilder)||void 0===o?void 0:o.browserSizeMode,appMode:null===(n=e.appStateInBuilder)||void 0===n?void 0:n.appRuntimeInfo.appMode,enableDataAction:t.isBatch?null===(a=null==c?void 0:c.enableBatchDataAction)||void 0===a||a:null===(l=null==c?void 0:c.enableDataAction)||void 0===l||l,currentPageId:null===(r=e.appStateInBuilder)||void 0===r?void 0:r.appRuntimeInfo.currentPageId}}))(jt);class Mt extends e.React.PureComponent{getStyle(t){return e.css`
      .jimu-widget-setting--row {
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      .message-setting {

        .searchIcon {
          cursor: pointer;
          position: absolute;
          right: 1.2rem;
          margin-top: 0.3rem;
        }

        .listItem {
          cursor: pointer;
          padding: 5px 0px;
        }

        .listItem.active {
          background-color: ${t.colors.palette.primary[100]};
          border: 0;
        }

        .listItem:hover {
          background-color: ${e.polished.rgba(t.colors.palette.primary[100],.4)};
        }

        .active-border {
          border-left: 2px solid var(--primary-700) !important;
        }

        .message-item-container {
          background-color: var(--light-400);
          border: 1px solid ${t.colors.palette.light[500]};
        }

        .message-item {

          .widget-name {
            font-size: ${e.polished.rem(14)};
            font-weight: 400;
          }

          .action-name {
            font-size: ${e.polished.rem(13)};
            margin-top: ${e.polished.rem(13)};
          }

          padding: 0 ${e.polished.rem(12)} ${e.polished.rem(6)} ${e.polished.rem(12)};

          .action-item {
            padding: ${e.polished.rem(8)} ${e.polished.rem(10)} ${e.polished.rem(10)} ${e.polished.rem(5)};
            .delete-item-button {
              display: none;
              padding: 0;
              color: var(--dark-600);
            }
          }

          .action-item:hover {
            .delete-item-button {
              display: block;
            }
          }

          .drag-item {
            &:hover {
              .action-item {
                border: 1px solid ${t.colors.palette.primary[700]};
              }
              .action-name {
                background-color: ${t.colors.palette.secondary[200]};
              }
            }
          }

          .message-item-title {
            font-size: ${e.polished.rem(14)};
            line-height: 1.3;
            margin: 0;
            padding: ${e.polished.rem(8)} 0;
            width: 190px;
            overflow: hidden;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            display: -webkit-box;
          }

          .close-message-button {
            padding: 0;
            svg {
              margin: 0;
            }
          }

          .deleteIcon-disable {
            opacity: .3;
          }

          .deleteIcon {
            cursor: pointer;
            opacity: .8;
          }

          .deleteIcon:hover {
            opacity: 1;
          }

          .item-add-action {
            cursor: pointer;
            color: ${t.colors.palette.primary[700]};
            padding: 0;
            border: 1px dashed var(--light-800);
            height: ${e.polished.rem(26)};
            &:hover {
              color: ${t.colors.palette.primary[800]};
            }
          }
        }

        .jimu-widget-setting--section {
          padding-left: 0;
          padding-right: 0;
        }
        .jimu-widget-setting--row {
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .no-trigger-tip {
          &>div {
            top: 50%;
            transform: translateY(-50%);
            color: ${t.colors.palette.dark[200]};
          }
          p {
            color: ${t.colors.palette.dark[500]};
            font-size: ${e.polished.rem(14)};
            margin: ${e.polished.rem(16)} auto 0;
            line-height: ${e.polished.rem(19)};
            width: ${e.polished.rem(228)};
          }
        }
      }
    `}createMessageActionSetting(){const{pageId:t,widgetId:i,theme:s,messageConfigs:o}=this.props;return(0,e.jsx)(ht,{pageId:t,widgetId:i,theme:s,messageConfigs:o,formatMessage:this.props.formatMessage})}createDataActionSetting(){const{canConsumeDataAction:t,canConsumeBatchDataAction:i}=this.props;return t&&!i?(0,e.jsx)(At,{widgetId:this.props.widgetId,isBatch:!1,formatMessage:this.props.formatMessage}):!t&&i?(0,e.jsx)(At,{widgetId:this.props.widgetId,isBatch:!0,formatMessage:this.props.formatMessage}):(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(At,{widgetId:this.props.widgetId,isBatch:!1,formatMessage:this.props.formatMessage}),(0,e.jsx)(At,{widgetId:this.props.widgetId,isBatch:!0,formatMessage:this.props.formatMessage}))}render(){const{supportMessageAction:t,canConsumeDataAction:s,canConsumeBatchDataAction:o,formatMessage:n}=this.props;return t&&!s?(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"jimu-widget message-setting px-3"},this.createMessageActionSetting())):t||!s&&!o?(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme)},(0,e.jsx)("div",{className:"jimu-widget message-setting"},(0,e.jsx)(i.Tabs,{type:"pills",fill:!0,className:"p-3 h-100",defaultValue:"message"},(0,e.jsx)(i.Tab,{id:"message",title:n("messageAction")},this.createMessageActionSetting()),(0,e.jsx)(i.Tab,{id:"data",title:n("dataAction")},this.createDataActionSetting())))):(0,e.jsx)("div",{className:"w-100 h-100",css:this.getStyle(this.props.theme)},this.createDataActionSetting())}}const Tt=e.ReactRedux.connect(((e,t)=>{var i,s;return{messageConfigs:null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.messageConfigs}}))((0,Z.withTheme)(Mt));var Nt=u(663),Dt=u(8683),kt=u.n(Dt),Pt=u(760),Lt=u.n(Pt),Rt=u(1397),Bt=u.n(Rt);const Ot=t=>{const i=window.SVG,{className:s}=t,o=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",s);return i?e.React.createElement(i,Object.assign({className:n,src:Bt()},o)):e.React.createElement("svg",Object.assign({className:n},o))};const{useState:zt,useEffect:Et}=e.React,Ut={svg:kt()},Wt={svg:Lt()},Zt=Object.assign({},{pageSetting:"Page settings",dialogSetting:"Dialog settings",openWithWindow:"Open with Window",openWithWindowTip:"Only fixed windows are supported (except splash).",folderSetting:"Folder settings",linkSetting:"Link settings",noSelection:"No selection",customWidth:"Fixed width",fitToWindow:"Fit to window",fitToWidthOnly:"Full width",fitToContainer:"Fit to container",keepAspectRatio:"Keep aspect ratio",aspectRatio:"Aspect ratio",fixedHeight:"Fixed height",content:"Content",dynamicSettingStyle:"Style",action:"Action",donotSupportDataAction:"The widget does not support any data actions.",daynamicLayout:"Layout",displayMode:"Display mode",dynamicWidth:"Width",dynamicHeight:"Height",dynamicLoading:"Loading",heightMode:"Height mode",body:"Body",header:"Header",footer:"Footer",urlIsHere:"Type URL here.",sectionDelete:"Delete",noWidget:"No widget",maxWidth:"Max width",docked:"Docked",floatingScreen:"Floating",verticalSpacing:"Vertical spacing",triggerPosition:"Trigger position",upper:"Upper",lower:"Lower",dsDuplicateView:"Duplicate view",dsDuplicateScreen:"Duplicate screen",newView:"New view",noSettingOptions:"No setting options",contentWidth:"Content width",dsCustom:"Custom",dsAuto:"Auto",size:"Size",lockParent:"Kept within the parent container",margin:"Margin",noStyle:"This widget does not support style settings.",addTrigger:"Add a trigger",noTrigger:"The widget does not generate any triggers.",selectTrigger:"Select a trigger",selectTarget:"Select a target",selectAction:"Select an action",actionBack:"Back",actionSet:"Action settings",actionSettings:"Settings",actionDelete:"Delete",addAction:"Add action",targetWidgets:"Widgets",noMessage:"No message",noTargetWidgets:"No widget",messageAction:"Message action",dataAction:"Data action",noAction:"No action",chooseSearchTrigger:"Select or search a trigger",chooseSearchTarget:"Select or search a target",chooseSearchAction:"Select or search an action",actionDone:"Done",actionFramework:"Framework",actionSettingLoading:"Loading...",turnTo:"Switch to:",dsFill:"Fill",keepFixedOnScroll:"Stays at the top of the page when scrolling",titleBackground:"Background",titleOption:"Options",copyPage:"Copy",mode:"Mode",fixedMode:"Fixed",anchoredMode:"Anchored",fixedModeTip:"Display in a fixed position.",anchoredModeTip:"Appears next to the linked widget.",splashDlgWarning:"Splash cannot be set to Anchored.",pageDlgWarning:"Window opened with pages cannot be set to Anchored.",keepLeft:"Keep left",keepRight:"Keep right",keepCenter:"Keep center",keepTop:"Keep top",keepBottom:"Keep bottom",closeOptions:"Close options",clickOutside:"Click outside to close Window",interaction:"Interaction",interactionStyle1:"Checkbox only",interactionStyle2:"Button in the same line",interactionStyle3:"Button in a different line",confirmation:"Confirmation",confirmationRequiredText:"Check to proceed",confirmationButtonTextHolder:"Required",closeIcon:"Close icon",closeIconPosition:"Position",closeIconPositionTL:"Top left",closeIconPositionTR:"Top right",preventDisplayAgain:'"Don\'t show this again" option',checkboxText:"Checkbox text",checkboxButtonText:"Button text",alwaysShow:"Always show this window",arrows:"Arrows",dots:"Dots",interval:"Interval (Second)",loop:"Loop",toggleViewList:"Toggle view list",spacing:"Spacing",scrollToSwitch:"Scroll to switch",dataActions:"Data actions",enableDataAction:"Enable data action",enableBatchDataAction:"Enable batch data action",selectWidgets:"Select widgets",dataActionTooltip:"Show data action button on the widget. The widget will not have any data actions, if no action is configured, or the data type does not support data action.",batchDataActionTooltip:"Show batch data action button on the widget. The widget will not have any batch data actions, if no action is configured, or the data type does not support data action.",noDataAction:"To see data action options, please add a widget that provides data action onto the same page.",noBatchDataAction:"To see batch data action options, please add a widget that provides batch data action onto the same page.",noTriggerTip:'Click the "{ButtonString}" button to add and configure actions.',exportNotes:"Note: Export is configured in the Data panel.",lazyLoading:"Lazy loading",lazyLoadingTip:"Load content when switched for the first time."},i.defaultMessages,{previousView:"Previous view",nextView:"Next view",originTL:"Top left as origin",originTR:"Top right as origin",originBL:"Bottom left as origin",originBR:"Bottom right as origin",alignLeft:"Align left",alignRight:"Align right",alignTop:"Align top",alignCenter:"Align center",alignHCenter:"Horizontal center",alignVCenter:"Vertical center",alignBottom:"Align bottom",alignStretch:"Align stretch",sendBackward:"Send backward",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",zoomoutFixed:"Zoom out fixed",order:"Order",moveToLeft:"Move to left",moveToRight:"Move to right",moveToTop:"Move to top",moveToBottom:"Move to bottom",addView:"New view",duplicateScreen:"Duplicate screen",deleteScreen:"Delete screen",applyToFirstPanel:"Apply to the first panel",deleteView:"Delete view",duplicateView:"Duplicate view",insertABlock:"Insert block",insertAScreenGroup:"Insert screen group",moveup:"Move up",movedown:"Move down",chooseTemplate:"Choose a {type} template",chooseHeaderTemplate:"Choose a header template",chooseFooterTemplate:"Choose a footer template",dropWidgetToAdd:"Or drag a widget here",snapToLeft:"Snap to left",snapToTop:"Snap to top",snapToBottom:"Snap to bottom",snapToRight:"Snap to right",fullWidth:"Full width",fullHeight:"Full height",fullSize:"Full size",restoreSize:"Restore size",pendingTip:"Move to the pending list",setting:"Settings",dragToMove:"Drag to move {label}",lockLayout:"Lock position and size",unlockLayout:"Unlock position and size",editHeader:"Edit header",editFooter:"Edit footer",transform:"Transform",rotation:"Rotation",angle:"Angle",floating:"Pin",sinking:"Unpin",floatingArea:"Floating area",changeToAuto:"Change to auto",changeToCustom:"Change to custom",positionType:"Position type",sticky:"Sticky",fixed:"Fixed",flow:"Flow",stack:"Stack",fixedAtTop:"Floating at the top when scrolling",actNormal:"Act as normal widget",hideInDesignView:"Hide in design view",showInDesignView:"Show in design view",unlockGridItem:"Unlock this widget to reorganize its internal widgets.",lockGridItem:"Lock this widget."},e.defaultMessages),Vt=s=>{const[o,n]=zt("#"),{id:a,type:l,theme:r,intl:c,linkTitle:p,ariaLabel:d}=s;return Et((()=>{((i,s)=>{return o=void 0,n=void 0,l=function*(){var o,n,a,l,r;const c=null===(n=null===(o=(0,e.getAppStore)().getState())||void 0===o?void 0:o.appStateInBuilder)||void 0===n?void 0:n.appConfig;let p;if("page"===s||"dialog"===s)return yield t.helpUtils.getBuildAppsHelpLink(`add-a-${s}`);if("screen"===s)return yield t.helpUtils.getBuildAppsHelpLink("add-screen-groups");if("section"===s)p="section";else if("placeholder"===s)p="placeholder";else if(p=null===(r=null===(l=null===(a=null==c?void 0:c.widgets)||void 0===a?void 0:a[i])||void 0===l?void 0:l.manifest)||void 0===r?void 0:r.name,!p)return yield Promise.resolve(null);return yield t.helpUtils.getWidgetHelpLink(p)},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function s(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(i,s)}r((l=l.apply(o,n||[])).next())}));var o,n,a,l})(a,l).then((e=>{n(e)}))}),[a,l]),(0,e.jsx)(i.Link,{icon:!0,to:o,target:"_blank",title:p,css:e.css`
        padding: 0 !important;
        .svg-component{
          margin-right: 0;
          color: ${r.colors.palette.dark[400]};
        }
        :hover {
          .svg-component{
            color: ${r.colors.black};
          }
        }
      `,"aria-label":d},(0,e.jsx)(Ot,{autoFlip:!e.i18n.isSameLanguage(null==c?void 0:c.locale,"he")}))},Ht=s=>{var o;const{hideColorSelector:n,headTitle:a,icon:l,customIcon:r,id:c,type:p,needIconFlip:d,theme:g,intl:h,handleIconChange:m,handleTitleChange:u,handleKeydown:f,headTitleInput:v,defaultLabel:x}=s,[w,I]=zt("");let b,y="";const S="string"==typeof r?[{svg:r}]:[r],C=JSON.parse(JSON.stringify(l));if(null==C?void 0:C.svg){const e=null===(o=null==C?void 0:C.properties)||void 0===o?void 0:o.filename;e?(null==e?void 0:e.indexOf(".svg"))>0&&(y=x):C.properties={filename:x},b=C}else b={svg:l,properties:{filename:x}};Et((()=>{I(a)}),[a]);const j=e=>h.formatMessage({id:e,defaultMessage:Zt[e]}),A=e=>{if("page"===p||"dialog"===p){const i=(0,t.getAppConfigAction)();if(t.appConfigUtils.isLabelDuplicated(i.appConfig,p,c,e))return{valid:!1,msg:j("duplicatedLabel")}}return{valid:!0}};return(0,e.jsx)("div",{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between"},(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)(Nt.IconPicker,{previewOptions:{autoFlip:d,color:!0},configurableOption:n?"none":"color",className:"flex-none",icon:b,customLabel:y,customIcons:S,onChange:m,hideRemove:!0,onKeyDown:t=>{if("Tab"===t.key&&t.shiftKey&&(0,e.getAppStore)().getState().appStateInBuilder.appRuntimeInfo.appMode===e.AppMode.Design){t.preventDefault();const i=document.querySelector(`iframe[name="${e.APP_FRAME_NAME_IN_BUILDER}"]`);((null==i?void 0:i.contentDocument)||(null==i?void 0:i.contentWindow.document)).body.focus()}},setButtonUseColor:!1}),(0,e.jsx)("div",{className:"d-flex mx-1",css:e.css`max-width: 170px;`},(0,e.jsx)(i.TextInput,{className:"header-title-input w-100 h5",ref:v,size:"sm",title:w,value:w||"",onChange:e=>I(e.target.value),onAcceptValue:e=>u(c,e,p),checkValidityOnChange:A,checkValidityOnAccept:A,onBlur:e=>(e=>{if(""===e.trim()){const i=(0,t.getAppConfigAction)();"widget"===p?e=i.appConfig.widgets[c].label:"section"===p?e=i.appConfig.sections[c].label:"screen"===p?e=i.appConfig.screenGroups[c].label:"page"===p&&(e=i.appConfig.pages[c].label),I(e)}})(e.target.value),onKeyDown:f,borderless:!0}))),(0,e.jsx)(Vt,{id:c,type:p,theme:g,intl:h,linkTitle:j("help")}))};class Ft extends e.React.PureComponent{constructor(i){super(i),this.spanText=e.React.createRef(),this.headTitleInput=e.React.createRef(),this.getCss=()=>{const{theme:t}=this.props;return e.css`
      height: 100%;
      overflow: hidden;
      overflow-x: hidden;

      .jimu-widget-setting {
        overflow-x: hidden;
      }
      .widget-setting-tab{
        position: absolute;
        background-color: ${t.body.bg};
      }

      .widget-setting, .section-setting {
        height: calc(100% - ${e.polished.rem(2)});
      }

      .jimu-widget-setting--row {
        label {
          user-select: none;
        }
      }
      .jimu-widget-setting--section-header {
        user-select: none;
      }
      .tab-content {
        height: calc(100% - ${e.polished.rem(40)});
      }
      .tab-pane{
        width: 100%;
      }

      .tab-title-item{
        width: 30%;
      }

      .edit-label-input {
        width: 50%;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }

      .title-span-hide {
        &.h5 {
          font-weight: ${t.typography.weights.extraBold};
          font-size: 1rem;
        }
      }

      .header-title-input {
        .input-wrapper {
          height: 100%;
          background-color: transparent;
        }
        &.h5 {
          input {
            font-weight: ${t.typography.weights.bold};
            font-size: ${e.polished.rem(16)};
            color: var(--dark-600);
          }
        }
      }

      .setting-container {
        overflow-y: auto;
        overflow-x: hidden;
        height: 100%;
      }

      .single-setting {
        border-top: 1px solid ${t.colors.palette.light[800]};
      }

      .help-btn {
        color: ${t.colors.palette.light[800]};
      }
      .help-btn:hover {
        color: ${t.colors.black};
      }
    `},this.onLayoutItemSettingChanged=(e,i)=>{(0,t.getAppConfigAction)().editLayoutItemSetting(e,i).exec()},this.onLayoutItemStyleChanged=(i,s)=>{const o=(0,t.getAppConfigAction)(),{layoutId:n,layoutItemId:a}=i,l=o.appConfig.layouts[n].content[a];l.type===e.LayoutItemType.Widget?o.editWidgetProperty(l.widgetId,"style",s).exec():l.type===e.LayoutItemType.Section&&o.editSectionProperty(l.sectionId,"style",s).exec()},this.onLayoutPosChanged=(e,i)=>{(0,t.getAppConfigAction)().editLayoutItemBBox(e,i).exec()},this.getPageType=(e,t)=>{for(const i in t){const s=t[i];if(s.id===e)return s}return{}},this.formatMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:Zt[e]},t),this.editTitle=(e,i,s)=>{const o=(0,t.getAppConfigAction)();i?"widget"===s||"block"===s?o.editWidgetProperty(e,"label",i).exec():"section"===s?o.editSectionProperty(e,"label",i).exec():"screen"===s?o.editScreenGroupProperty(e,"label",i).exec():"page"===s?o.editPageProperty(e,"label",i).exec():"dialog"===s&&o.editDialogProperty(e,"label",i).exec():"widget"===s?i=o.appConfig.widgets[e].label:"section"===s?i=o.appConfig.sections[e].label:"screen"===s?i=o.appConfig.screenGroups[e].label:"page"===s&&(i=o.appConfig.pages[e].label)},this.handleKeydown=e=>{"Enter"===e.key&&this.headTitleInput.current&&this.headTitleInput.current.blur()},this.handleIconChange=e=>{const i=this.getDisplay(),{selection:s,currentPageId:o,currentDialogId:n}=this.props,a=(0,t.getAppConfigAction)(),l=a.appConfig;if(i.page)a.editPageProperty(o,"icon",e).exec();else if(i.dialog)a.editDialogProperty(n,"icon",e).exec();else if(i.widget){const t=d.searchUtils.findLayoutItem(l,s);t&&a.editWidgetProperty(t.widgetId,"icon",e).exec()}else if(i.section){const t=d.searchUtils.findLayoutItem(l,s);t&&a.editSectionProperty(t.sectionId,"icon",e).exec()}else if(i.screen){const t=d.searchUtils.findLayoutItem(l,s);t&&a.editScreenGroupProperty(t.screenGroupId,"icon",e).exec()}},this.focusEditTitle=e=>{this.headTitleInput.current&&(this.headTitleInput.current.select(),this.headTitleInput.current.focus())},this.getDisplay=()=>{var t;const{selection:i}=this.props,s=this.getAppConfig(),o={widget:!1,section:!1,screen:!1,layoutItem:!1,placeholder:!1,page:!1,link:!1,folder:!1,dialog:!1,noSelection:!1};if(i){const n=d.searchUtils.findLayoutItem(s,i);n?n.type===e.LayoutItemType.Widget?n.widgetId?o.widget=!0:(o.layoutItem=!0,o.placeholder=!0):n.type===e.LayoutItemType.Section&&!1!==(null===(t=i.additionalInfo)||void 0===t?void 0:t.commonSection)?o.section=!0:n.type===e.LayoutItemType.ScreenGroup?o.screen=!0:o.layoutItem=!0:o.noSelection=!0}else this.props.currentDialogId?o.dialog=!0:this.props.currentPageId?(o.page=!0,o.link=this.getPageType(this.props.currentPageId,s.pages).type===e.PageType.Link,o.folder=this.getPageType(this.props.currentPageId,s.pages).type===e.PageType.Folder):o.noSelection=!0;return o};const s={titleText:"",headTitleText:"",helpLink:"",commonWidgetList:[]},{selection:o,appConfig:n,currentPageId:a}=i;if(o){const t=d.searchUtils.findLayoutItem(n,o);t&&(t.type===e.LayoutItemType.Widget?t.widgetId&&(s.headTitleText=n.widgets[t.widgetId].label):t.type===e.LayoutItemType.Section&&(s.headTitleText=n.sections[t.sectionId].label))}else a&&(s.headTitleText=n.pages[a].label);this.state=s}componentDidMount(){this.getCommonWidgetListInfo()}getCommonWidgetListInfo(){e.WidgetManager.getInstance().getWidgetListInfo().then((e=>{this.setState({commonWidgetList:e})}))}getAppConfig(){return(0,e.getAppStore)().getState().appStateInBuilder&&(0,e.getAppStore)().getState().appStateInBuilder.appConfig}getDefaultPageIcon(e){return t.utils.getDefaultTocPageIcon(e).toString()}getDefaultDialogIcon(){return t.utils.getDefaultTocDialogIcon().toString()}getDefaultWidgetIcon(t){var i;const s=`${null===(i=null==t?void 0:t.manifest)||void 0===i?void 0:i.name}.svg`;return{svg:e.urlUtils.getAbsoluteRootUrl()+t.uri+"icon.svg",properties:{filename:s,inlineSvg:!0,originalName:`default/${s}`,path:`default/${s}`}}}onTabChange(t,i,s){i(e.appActions.widgetStatePropChange(s,"settingPanelChange",t))}renderWidgetSettings(t,s,n,a,l){var r,c,p,g,h,m,u,f;let v;const{currentSelectionIcon:x,currentSelectionTitle:w,dispatch:I,selection:b}=this.props,{commonWidgetList:y}=this.state,S=null==n?void 0:n.layouts[null==a?void 0:a.layoutId],C=d.searchUtils.findLayoutItem(n,a),j=n.widgets[C.widgetId],A=j.manifest,M=(null===(r=null==A?void 0:A.publishMessages)||void 0===r?void 0:r.length)>0,T=null!==(p=null===(c=null==A?void 0:A.properties)||void 0===c?void 0:c.canConsumeDataAction)&&void 0!==p&&p,N=null!==(h=null===(g=null==A?void 0:A.properties)||void 0===g?void 0:g.canConsumeBatchDataAction)&&void 0!==h&&h,D=null===(m=y.find((e=>e.name===j.manifest.name)))||void 0===m?void 0:m.label;return v=(null==A?void 0:A.properties.hasConfig)&&(null==A?void 0:A.properties.hasConfigInSettingPage)?(0,e.jsx)(i.Tabs,{type:"underline",key:"widget-setting",className:"widget-setting flex-grow-1 w-100",fill:!0,defaultValue:"content",onChange:e=>this.onTabChange(e,I,j.id)},(0,e.jsx)(i.Tab,{id:"content",title:this.formatMessage("content"),className:"tab-title-item"},(0,e.jsx)(o,{formatMessage:this.formatMessage,dispatch:this.props.dispatch,widgetId:C.widgetId,widgetsSettingRuntimeInfo:this.props.widgetsSettingRuntimeInfo})),(0,e.jsx)(i.Tab,{id:"dynamicSettingStyle",title:this.formatMessage("dynamicSettingStyle"),className:"tab-title-item"},(0,e.jsx)("div",{className:"setting-container"},(0,e.jsx)(Ee,{layoutId:a.layoutId,layoutItemId:a.layoutItemId,formatMessage:this.formatMessage,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged}))),(M||T||N)&&(0,e.jsx)(i.Tab,{id:"action",title:this.formatMessage("action"),className:"tab-title-item"},(0,e.jsx)("div",{className:"setting-container"},(0,e.jsx)(Tt,{widgetId:C.widgetId,supportMessageAction:M,canConsumeDataAction:T,canConsumeBatchDataAction:N,formatMessage:this.formatMessage,pageId:e.urlUtils.getAppIdPageIdFromUrl().pageId})))):(0,e.jsx)("div",{className:"h-100"},(0,e.jsx)(Ee,{layoutId:a.layoutId,layoutItemId:a.layoutItemId,formatMessage:this.formatMessage,isSingle:!0,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})),v=(0,e.jsx)("div",{css:l&&e.css`z-index: -1`,className:"w-100 h-100 d-flex flex-column widget-setting-tab","data-is-parent":!!l||void 0},b.layoutId===a.layoutId&&(0,e.jsx)(Ht,{headTitle:w,icon:x,customIcon:this.getDefaultWidgetIcon(j),id:j.id,type:S.type===e.LayoutType.FlowLayout?"block":"widget",needIconFlip:null===(f=null===(u=null==j?void 0:j.manifest)||void 0===u?void 0:u.properties)||void 0===f?void 0:f.flipIcon,theme:t,intl:s,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:D}),(0,e.jsx)("div",{style:{flex:1,overflow:"auto"}},v)),v}render(){var s;const o=this.getAppConfig(),{selection:n,browserSizeMode:a,theme:l,intl:r,currentSelectionIcon:c,currentSelectionTitle:p}=this.props;if(!o)return(0,e.jsx)("div",{css:this.getCss(),className:"builder-dynamic-setting bg-light-300"},(0,e.jsx)(w,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,theme:this.props.theme,pageId:"empty",browserSizeMode:this.props.browserSizeMode,appTheme:this.props.theme2}));const g=this.getDisplay();let h;if(g.widget){const t=d.searchUtils.findLayoutItem(o,n);if(o.widgets[null==t?void 0:t.widgetId]){const i=t.widgetId,c=d.searchUtils.getParentWidgetIdOfContent(o,i,e.LayoutItemType.Widget,a),p=o.widgets[c];if(c&&(null===(s=null==p?void 0:p.manifest)||void 0===s?void 0:s.widgetType)!==e.WidgetType.Layout){const t=d.searchUtils.getLayoutInfosHoldcontent(o,e.LayoutItemType.Widget,c,a)[0];h=(0,e.jsx)(e.React.Fragment,null,t&&this.renderWidgetSettings(l,r,o,t,!0),this.renderWidgetSettings(l,r,o,n))}else h=(0,e.jsx)(e.React.Fragment,null,this.renderWidgetSettings(l,r,o,n))}else h=(0,e.jsx)("div",null,this.formatMessage("noSelection"))}if(g.layoutItem){const t=g.placeholder?this.formatMessage("placeholder"):this.formatMessage("daynamicLayout");h=(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)("h4",{className:"jimu-widget-setting--header d-flex align-items-center justify-content-between"},(0,e.jsx)("div",null,t),g.placeholder&&(0,e.jsx)(Vt,{type:"placeholder",theme:l,intl:r,linkTitle:this.formatMessage("help"),ariaLabel:t})),(0,e.jsx)("div",{className:"flex-grow-1 setting-container"},(0,e.jsx)(Ee,{layoutId:n.layoutId,layoutItemId:n.layoutItemId,formatMessage:this.formatMessage,isSingle:!0,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})))}if(g.section){const s=d.searchUtils.findLayoutItem(o,n),a=o.sections[s.sectionId];h=(0,e.jsx)(i.Tabs,{type:"underline",className:"flex-grow-1 section-setting",fill:!0,defaultValue:"content"},(0,e.jsx)(i.Tab,{id:"content",key:"section-setting",title:this.formatMessage("content")},(0,e.jsx)(je,{intl:this.props.intl,formatMessage:this.formatMessage,theme:this.props.theme,appTheme:this.props.theme2,dispatch:this.props.dispatch,sectionId:a.id})),(0,e.jsx)(i.Tab,{id:"dynamicSettingStyle",title:this.formatMessage("dynamicSettingStyle")},(0,e.jsx)("div",{className:"h-100 setting-container"},(0,e.jsx)(Ee,{layoutId:n.layoutId,layoutItemId:n.layoutItemId,formatMessage:this.formatMessage,onSettingChanged:this.onLayoutItemSettingChanged,onStyleChange:this.onLayoutItemStyleChanged,onPosChanged:this.onLayoutPosChanged})))),h=(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)(Ht,{headTitle:p,icon:c,customIcon:t.utils.getDefaultSectionIcon().toString(),id:a.id,type:"section",theme:l,intl:r,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:p}),(0,e.jsx)("div",{className:"h-100 setting-container"},h))}if(g.screen){const i=d.searchUtils.findLayoutItem(o,n);h=(0,e.jsx)(Oe,{intl:this.props.intl,formatMessage:this.formatMessage,theme:this.props.theme,dispatch:this.props.dispatch,screenGroupId:i.screenGroupId}),h=(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)(Ht,{headTitle:p,icon:c,customIcon:t.utils.getDefaultSectionIcon().toString(),id:i.screenGroupId,type:"screen",theme:l,intl:r,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:p}),(0,e.jsx)("div",{className:"h-100 setting-container"},h))}if(g.page){h=(0,e.jsx)(w,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,pageId:this.props.currentPageId,pageMode:this.props.pageMode,maxWidth:this.props.maxPageWidth,browserSizeMode:this.props.browserSizeMode,theme:this.props.theme,appTheme:this.props.theme2}),g.link?h=(0,e.jsx)(q,{dispatch:this.props.dispatch,appConfig:o,formatMessage:this.formatMessage,pageId:this.props.currentPageId}):g.folder&&(h=(0,e.jsx)(ee,{dispatch:this.props.dispatch,appConfig:o,formatMessage:this.formatMessage,pageId:this.props.currentPageId}));const{currentPageId:t}=this.props,i=o.pages[t];h=i?(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)(Ht,{hideColorSelector:!0,headTitle:p,icon:c,customIcon:this.getDefaultPageIcon(i),id:i.id,type:"page",theme:l,intl:r,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:p}),(0,e.jsx)("div",{className:"h-100 setting-container single-setting"},h)):null}if(g.dialog){const{currentDialogId:t}=this.props;h=(0,e.jsx)(W,{dispatch:this.props.dispatch,formatMessage:this.formatMessage,dialogId:t,browserSizeMode:this.props.browserSizeMode,theme:this.props.theme,appTheme:this.props.theme2});const i=o.dialogs[t];h=(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column"},(0,e.jsx)(Ht,{hideColorSelector:!0,headTitle:p,icon:c,customIcon:this.getDefaultDialogIcon(),id:i.id,type:"dialog",theme:l,intl:r,handleIconChange:this.handleIconChange,handleTitleChange:this.editTitle,handleKeydown:this.handleKeydown,headTitleInput:this.headTitleInput,defaultLabel:p}),(0,e.jsx)("div",{className:"h-100 setting-container single-setting"},h))}return g.noSelection&&(h=(0,e.jsx)("div",{className:"h-100"},this.formatMessage("noSelection"))),(0,e.jsx)("div",{css:this.getCss(),className:"builder-dynamic-setting bg-light-300"},(0,e.jsx)("span",{ref:this.spanText,className:"title-span-hide px-1 border h5",style:{width:"auto",position:"absolute",opacity:0,whiteSpace:"nowrap",zIndex:-1}},this.state.headTitleText||""),h)}}Ft.mapExtraStateProps=(i,s)=>{var o,n,a,l,r,c,p,g;const h=null===(o=i.appStateInBuilder)||void 0===o?void 0:o.appRuntimeInfo.currentPageId,m=null===(n=i.appStateInBuilder)||void 0===n?void 0:n.appRuntimeInfo.currentDialogId,u=null===(a=i.appStateInBuilder)||void 0===a?void 0:a.appConfig;let f,v;h&&(f=null===(r=null===(l=null==u?void 0:u.pages)||void 0===l?void 0:l[h])||void 0===r?void 0:r.mode,v=null===(p=null===(c=null==u?void 0:u.pages)||void 0===c?void 0:c[h])||void 0===p?void 0:p.maxWidth);const x=null===(g=i.appStateInBuilder)||void 0===g?void 0:g.appRuntimeInfo.selection,{icon:w,title:I}=function(i,s,o,n){var a,l;let r,c;if(i){const s=d.searchUtils.findLayoutItem(n,i);if(s)if(s.type===e.LayoutItemType.Widget){if(s.widgetId){const t=n.widgets[s.widgetId],o=n.layouts[i.layoutId];c=t&&t.label,r=o.type!==e.LayoutType.FlowLayout||(null===(a=s.setting)||void 0===a?void 0:a.isFloating)?t&&t.icon:"string"!=typeof(null==t?void 0:t.icon)&&(null==t?void 0:t.icon)||Ut}}else if(s.type===e.LayoutItemType.Section){if(s.sectionId){const e=n.sections[s.sectionId];c=null==e?void 0:e.label,r=(null==e?void 0:e.icon)||t.utils.getDefaultSectionIcon().toString()}}else if(s.type===e.LayoutItemType.ScreenGroup&&s.screenGroupId){const e=n.screenGroups[s.screenGroupId];c=null==e?void 0:e.label,r=null!==(l=null==e?void 0:e.icon)&&void 0!==l?l:Wt}}else if(n)if(s){const e=n.dialogs[s];e&&(c=e.label,r=e.icon||t.utils.getDefaultTocDialogIcon())}else if(o){const e=n.pages[o];e&&(c=e.label,r=e.icon||t.utils.getDefaultTocPageIcon(e))}return{icon:r,title:c}}(x,m,h,u);return{currentPageId:h,pageMode:f,maxPageWidth:v,widgetsSettingRuntimeInfo:i.builder.widgetsSettingRuntimeInfo,currentDialogId:m,selection:x,browserSizeMode:i.appStateInBuilder&&i.appStateInBuilder.browserSizeMode,currentSelectionIcon:w,currentSelectionTitle:I}}})(),f})())}}}));