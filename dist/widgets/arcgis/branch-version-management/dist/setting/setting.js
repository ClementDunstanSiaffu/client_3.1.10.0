System.register(["jimu-core","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector"],(function(e,t){var s={},i={},a={},r={},n={};return{setters:[function(e){s.AllDataSourceTypes=e.AllDataSourceTypes,s.DataSourceManager=e.DataSourceManager,s.DataSourceTypes=e.DataSourceTypes,s.Immutable=e.Immutable,s.React=e.React,s.SessionManager=e.SessionManager,s.css=e.css,s.defaultMessages=e.defaultMessages,s.esri=e.esri,s.urlUtils=e.urlUtils},function(e){i.BaseWidgetSetting=e.BaseWidgetSetting},function(e){a.Alert=e.Alert,a.Button=e.Button,a.Checkbox=e.Checkbox,a.Icon=e.Icon,a.NumericInput=e.NumericInput,a.Popper=e.Popper,a.Select=e.Select,a.Switch=e.Switch,a.Table=e.Table,a.TextInput=e.TextInput,a.Tooltip=e.Tooltip,a.defaultMessages=e.defaultMessages},function(e){r.SettingRow=e.SettingRow,r.SettingSection=e.SettingSection,r.SidePopper=e.SidePopper},function(e){n.DataSourceSelector=e.DataSourceSelector}],execute:function(){e((()=>{var e={5262:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(8081),a=s.n(i),r=s(23645),n=s.n(r)()(a());n.push([e.id,".css-rygcro th,.css-rygcro td{padding:0.5rem 0.5rem !important}\n",""]);const o=n},23645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",i=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),i&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),i&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,i,a,r){"string"==typeof e&&(e=[[null,e,void 0]]);var n={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(n[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&n[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),s&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=s):d[2]=s),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},93379:e=>{"use strict";var t=[];function s(e){for(var s=-1,i=0;i<t.length;i++)if(t[i].identifier===e){s=i;break}return s}function i(e,i){for(var r={},n=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],d=r[c]||0,g="".concat(c," ").concat(d);r[c]=d+1;var u=s(g),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var h=a(m,i);i.byIndex=o,t.splice(o,0,{identifier:g,updater:h,references:1})}n.push(g)}return n}function a(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,a){var r=i(e=e||[],a=a||{});return function(e){e=e||[];for(var n=0;n<r.length;n++){var o=s(r[n]);t[o].references--}for(var l=i(e,a),c=0;c<r.length;c++){var d=s(r[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=l}}},90569:e=>{"use strict";var t={};e.exports=function(e,s){var i=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},19216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,s)=>{"use strict";e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var a=void 0!==s.layer;a&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,a&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},44589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},5013:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.173 0a.5.5 0 0 1 .5.5v14.7a.8.8 0 0 1-1.407.52L.12 10.712a.5.5 0 0 1 .76-.652l3.793 4.598V.5a.5.5 0 0 1 .5-.5Zm5.654 16a.5.5 0 0 1-.5-.5V.8a.8.8 0 0 1 1.407-.52l4.146 5.008a.5.5 0 0 1-.76.652l-3.793-4.598V15.5a.5.5 0 0 1-.5.5Z" fill="#000" fill-rule="nonzero"></path></svg>'},40325:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866 30.951 27.18a2.667 2.667 0 0 1-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 0 1 .781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 0 1 4.552.781l11.314 11.314L27.18.781a2.667 2.667 0 0 1 3.771 3.771L19.637 15.866z"></path></svg>'},51697:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 2c.291 0 .527.231.527.516v9.508L12.1 8.527a.535.535 0 0 1 .746 0 .508.508 0 0 1 0 .73L8 14 3.154 9.257a.508.508 0 0 1 0-.73.535.535 0 0 1 .746 0l3.573 3.497V2.516C7.473 2.231 7.709 2 8 2Z" fill="#000" fill-rule="nonzero"></path></svg>'},58794:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 14a.522.522 0 0 1-.527-.516V3.976L3.9 7.473a.535.535 0 0 1-.746 0 .508.508 0 0 1 0-.73L8 2l4.846 4.743a.508.508 0 0 1 0 .73.535.535 0 0 1-.746 0L8.527 3.976v9.508A.522.522 0 0 1 8 14Z" fill="#000" fill-rule="nonzero"></path></svg>'},93724:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0c4.4 0 8 3.6 8 8s-3.6 8-8 8-8-3.6-8-8 3.6-8 8-8Zm0 12a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM7.938 2C6.387 2 5.058 3.06 4.57 4.465c-.07.174-.07.342-.07.342a.74.74 0 0 0 .765.793l.114-.007c.458-.053.775-.314.947-.742.09-.189.123-.238.14-.262a1.778 1.778 0 0 1 1.47-.789c.98 0 1.782.81 1.782 1.8 0 .54-.178.99-.535 1.26L8.116 8.03c-.578.51-.921 1.198-1.03 1.968a.701.701 0 0 0-.006.073v.133a.855.855 0 0 0 .858.796l.104-.006c.45-.049.817-.409.849-.845l.037-.185c.151-.652.474-1.046.969-1.484.495-.438.801-.81.801-.81.446-.54.802-1.26.802-2.07C11.5 3.62 9.897 2 7.938 2Z" fill="#000" fill-rule="evenodd"></path></svg>'},39986:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16 32C7.163 32 0 24.837 0 16S7.163 0 16 0s16 7.163 16 16-7.163 16-16 16zm0-4c6.627 0 12-5.373 12-12S22.627 4 16 4 4 9.373 4 16s5.373 12 12 12zm0-17.333a2 2 0 1 1-.001-3.999A2 2 0 0 1 16 10.667zm0 2.666a2 2 0 0 1 2 2v8a2 2 0 1 1-4 0v-8a2 2 0 0 1 2-2z"></path></svg>'},89435:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSI4IiB5PSI4IiB3aWR0aD0iOTIiIGhlaWdodD0iMTYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjEzIiB5PSIxMyIgd2lkdGg9IjczIiBoZWlnaHQ9IjYiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik04IDg2SDEwMFY4N0g4Vjg2WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZD0iTTE2LjkxNDcgOTVMMTcuNTkwNSA5NS43MzcyTDIwLjcxOTggOTIuODY4NkwxNy41OTA1IDkwTDE2LjkxNDcgOTAuNzM3MkwxOS4yMzk5IDkyLjg2ODZMMTYuOTE0NyA5NVoiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik0xMS44MDUxIDkwLjczNzJMMTEuMTI5NCA5MC4wMDAxTDggOTIuODY4N0wxMS4xMjk0IDk1LjczNzJMMTEuODA1MSA5NS4wMDAxTDkuNDc5ODkgOTIuODY4N0wxMS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBkPSJNOTYgMThMOTAgMThMOTMgMTVMOTYgMThaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI4IiB5PSIyNyIgd2lkdGg9IjUwIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjgwIiB5PSI5MiIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTkgMzVIMjBWNDJIOTlWMzVaTTE5IDM0VjQzSDEwMFYzNEgxOVoiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjgiIHk9IjM0IiB3aWR0aD0iOSIgaGVpZ2h0PSI5IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNTgiIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI0NSIgeT0iNTgiIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI3MyIgeT0iNTgiIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8Y2lyY2xlIGN4PSIxMiIgY3k9IjYwIiByPSIzIiBmaWxsPSIjOTk5OTk5Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNjciIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI0NSIgeT0iNjciIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI3MyIgeT0iNjciIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyIDcxQzEzLjEwNDYgNzEgMTQgNzAuMTA0NiAxNCA2OUMxNCA2Ny44OTU0IDEzLjEwNDYgNjcgMTIgNjdDMTAuODk1NCA2NyAxMCA2Ny44OTU0IDEwIDY5QzEwIDcwLjEwNDYgMTAuODk1NCA3MSAxMiA3MVpNMTIgNzJDMTMuNjU2OSA3MiAxNSA3MC42NTY5IDE1IDY5QzE1IDY3LjM0MzEgMTMuNjU2OSA2NiAxMiA2NkMxMC4zNDMxIDY2IDkgNjcuMzQzMSA5IDY5QzkgNzAuNjU2OSAxMC4zNDMxIDcyIDEyIDcyWiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iOCIgeT0iNDYiIHdpZHRoPSI5MiIgaGVpZ2h0PSI4IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxMCIgeT0iNDgiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI0OCIgd2lkdGg9IjE2IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjQ1IiB5PSI0OCIgd2lkdGg9IjE3IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjczIiB5PSI0OCIgd2lkdGg9IjIzIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI3OCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjQ1IiB5PSI3OCIgd2lkdGg9IjIyIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjczIiB5PSI3OCIgd2lkdGg9IjI3IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIgODJDMTMuMTA0NiA4MiAxNCA4MS4xMDQ2IDE0IDgwQzE0IDc4Ljg5NTQgMTMuMTA0NiA3OCAxMiA3OEMxMC44OTU0IDc4IDEwIDc4Ljg5NTQgMTAgODBDMTAgODEuMTA0NiAxMC44OTU0IDgyIDEyIDgyWk0xMiA4M0MxMy42NTY5IDgzIDE1IDgxLjY1NjkgMTUgODBDMTUgNzguMzQzMSAxMy42NTY5IDc3IDEyIDc3QzEwLjM0MzEgNzcgOSA3OC4zNDMxIDkgODBDOSA4MS42NTY5IDEwLjM0MzEgODMgMTIgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8L3N2Zz4NCg=="},82881:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSIxNiIgeT0iMzYiIHdpZHRoPSI3NiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNiIgeT0iNDQiIHdpZHRoPSI5IiBoZWlnaHQ9IjkiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTEgNDVIMjhWNTJIOTFWNDVaTTI3IDQ0VjUzSDkyVjQ0SDI3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01MCAzMEg4VjEwMEgxMDBWMzBINThMNTQgMjZMNTAgMzBaTTU0IDI3LjQxNDJMNTAuNDE0MiAzMUg5Vjk5SDk5VjMxSDU3LjU4NThMNTQgMjcuNDE0MloiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGQ9Ik04IDhMMTAwIDhWMjRIOFY4WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iNzQiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTk2IDE4TDkwIDE4TDkzIDE1TDk2IDE4WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjciIHk9IjU4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMjAiIGN5PSI2MCIgcj0iMyIgZmlsbD0iIzk5OTk5OSIvPg0KPHJlY3QgeD0iMjciIHk9IjY4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yMCA3MkMyMS4xMDQ2IDcyIDIyIDcxLjEwNDYgMjIgNzBDMjIgNjguODk1NCAyMS4xMDQ2IDY4IDIwIDY4QzE4Ljg5NTQgNjggMTggNjguODk1NCAxOCA3MEMxOCA3MS4xMDQ2IDE4Ljg5NTQgNzIgMjAgNzJaTTIwIDczQzIxLjY1NjkgNzMgMjMgNzEuNjU2OSAyMyA3MEMyMyA2OC4zNDMxIDIxLjY1NjkgNjcgMjAgNjdDMTguMzQzMSA2NyAxNyA2OC4zNDMxIDE3IDcwQzE3IDcxLjY1NjkgMTguMzQzMSA3MyAyMCA3M1oiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjI3IiB5PSI3OCIgd2lkdGg9IjY1IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjAgODJDMjEuMTA0NiA4MiAyMiA4MS4xMDQ2IDIyIDgwQzIyIDc4Ljg5NTQgMjEuMTA0NiA3OCAyMCA3OEMxOC44OTU0IDc4IDE4IDc4Ljg5NTQgMTggODBDMTggODEuMTA0NiAxOC44OTU0IDgyIDIwIDgyWk0yMCA4M0MyMS42NTY5IDgzIDIzIDgxLjY1NjkgMjMgODBDMjMgNzguMzQzMSAyMS42NTY5IDc3IDIwIDc3QzE4LjM0MzEgNzcgMTcgNzguMzQzMSAxNyA4MEMxNyA4MS42NTY5IDE4LjM0MzEgODMgMjAgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBkPSJNMjQuOTE0NyA5NUwyNS41OTA1IDk1LjczNzJMMjguNzE5OCA5Mi44Njg2TDI1LjU5MDUgOTBMMjQuOTE0NyA5MC43MzcyTDI3LjIzOTkgOTIuODY4NkwyNC45MTQ3IDk1WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTE5LjgwNTEgOTAuNzM3MkwxOS4xMjk0IDkwLjAwMDFMMTYgOTIuODY4N0wxOS4xMjk0IDk1LjczNzJMMTkuODA1MSA5NS4wMDAxTDE3LjQ3OTkgOTIuODY4N0wxOS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTkyIDg3TDE2IDg3TDE2IDg2TDkyIDg2TDkyIDg3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},48891:e=>{"use strict";e.exports=s},23137:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=a},338:e=>{"use strict";e.exports=n},77756:e=>{"use strict";e.exports=r}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={id:s,exports:{}};return e[s](a,a.exports,o),a.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="",o.nc=void 0;var l={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(l),o.d(l,{default:()=>j});var e=o(48891),t=o(23137);const s={alertMessagesAlreadyAdded:"Service already added",alertMessagesErrorAlert:"An error has occurred",alertMessagesNotValid:"Not a valid versioned service",allowancesAutoRefreshList:"Automatically refresh version list",allowancesChangeOwner:"Change owner",allowancesChangePrivileges:"Change access privileges",allowancesCreateNew:"Create new",allowancesDeleteExisting:"Delete existing",allowancesPosting:"Post changes",allowancesSwitch:"Switch versions",allowancesUpdateName:"Update name",allowancesUpdateDescription:"Update description",fieldColumnsAccess:"Access",fieldColumnsColumnAvailable:"Available",fieldColumnsColumnShow:"Show",fieldColumnsCommonAncestorDate:"Common Ancestor Date",fieldColumnsCreationDate:"Creation Date",fieldColumnsDescription:"Description",fieldColumnsEvaluationDate:"Evaluation Date",fieldColumnsModifiedDate:"Modified Date",fieldColumnsPreviousAncestorDate:"Previous Ancestor Date",fieldColumnsReconcileDate:"Reconcile Date",fieldColumnsVersionGuid:"Version GUID",fieldColumnsVersionId:"Version ID",fieldColumnsVersionName:"Name",fieldColumnsVersionOwner:"Owner",layoutStyleTitle:"Arrangement style",layoutStyleBasic:"Basic",layoutStyleAdvanced:"Advanced",settingsSectionsAllowAll:"All",settingsSectionsAllowCapability:"Allow",settingsSectionsExpandBasic:"Expand versions list",settingsSectionsGeneralSettings:"General settings",settingsSectionsMinutes:"Minute(s)",settingsSectionsRecordsPage:"Number of records per page",settingsSectionsSearchName:"Search version name",settingsSectionsSelectVersion:"Select version to load on start",settingsSectionsTooltipNumber:"Enter a number from 1 to 999",settingsSectionsVersionCapability:"Management capability",settingsSectionsVersionCapabilityTooltip:"Version Management capability is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not have access to version management operations.",settingsSectionsVersionInfo:"Version information",settingsSectionsVersionInfoTooltip:"Version information is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not see all version information.",settingsSectionsVersionService:"Version management services",settingsSectionsVersionServiceHelp:"Help"};var i=o(30726),a=o(77756),r=o(338),n=function(e,t,s,i){return new(s||(s=Promise))((function(a,r){function n(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((i=i.apply(e,t||[])).next())}))};class c{constructor(){this.defaultVersion="sde.DEFAULT",this.isOrgUser=!1,this.uniqueURLs=[]}static getInstance(){return c.instance||(c.instance=new c),c.instance}getUniqueVMSURL(t){return new Promise(((s,i)=>{const a=e.DataSourceManager.getInstance().getDataSources(),r=[],o=[];for(const s in a)if(t){if(s.includes(t)&&a[s].type===e.DataSourceTypes.FeatureLayer){const e=a[s].getDataSourceJson();if(e.url.includes("FeatureServer")){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));r.includes(t)||r.push(t)}}}else if(a[s].type===e.DataSourceTypes.FeatureLayer){const e=a[s].getDataSourceJson();if(e.url.includes("FeatureServer")){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));r.includes(t)||r.push(t)}}if(r.length>0){const e=r.map(((e,t)=>n(this,void 0,void 0,(function*(){let t=!1;if(t=yield this.checkValidVMS(e),t){const t=yield this.serviceNameLookup(e);o.push({url:e,name:t})}}))));Promise.all(e).then((e=>n(this,void 0,void 0,(function*(){this.uniqueURLs=o,s(o)}))))}else this.uniqueURLs=o,s(o)}))}checkValidVMS(e,t){return n(this,void 0,void 0,(function*(){let s=!1,i=e;i.includes("FeatureServer")&&(i=i.substring(0,i.indexOf("FeatureServer"))),i.includes("MapServer")&&(i=i.substring(0,i.indexOf("MapServer")));const a=i+"VersionManagementServer";let r=null;return r=t?{f:"json",token:t}:{f:"json"},s=yield this.requestService({method:"POST",url:a,params:r}).then((e=>!!e.hasOwnProperty("name")&&"Version Management Server"===e.name)).catch((e=>!1)),s}))}getVersions(e,t,s){return new Promise(((i,a)=>{if(t){let e=t;e.includes("FeatureServer")&&(e=e.substring(0,e.indexOf("FeatureServer"))),e.includes("MapServer")&&(e=e.substring(0,e.indexOf("MapServer"))),i(s?this.requestVersions(e,s):this.requestVersions(e))}else if(0===this.uniqueURLs.length)this.getUniqueVMSURL().then((t=>{let a=t[0];e&&(a=t.filter((t=>t.name===e)));const r=a[0].url;i(s?this.requestVersions(r,s):this.requestVersions(r))}));else{let t=this.uniqueURLs[0];e&&(t=this.uniqueURLs.filter((t=>t.name===e)));const a=t[0].url;i(s?this.requestVersions(a,s):this.requestVersions(a))}}))}changeGDBVersion(t,s){let i=!1;for(const a in s)s[a].type===e.DataSourceTypes.FeatureLayer&&(this.getLayerObject(s[a]).changeGDBVersion(t),i=!0),(s[a].type===e.DataSourceTypes.FeatureService||s[a].type===e.DataSourceTypes.MapService)&&(s[a].changeGDBVersion(t),i=!0);return i}createGDBVersion(e,t,s,i,a,r){return new Promise(((n,o)=>{let l=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){if(a)l=a,l.indexOf("FeatureServer")>=0?(l=l.substring(0,l.indexOf("FeatureServer")),l+="VersionManagementServer/create"):l.indexOf("MapServer")>=0?(l=l.substring(0,l.indexOf("MapServer")),l+="VersionManagementServer/create"):l+="VersionManagementServer/create";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter((e=>e.name===i))),l=e[0].url+"VersionManagementServer/create"}this.requestService({method:"POST",url:l,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,token:t}}).then((e=>{r&&e.hasOwnProperty("versionInfo")&&this.changeGDBVersion(e.versionInfo.versionName,s),n(e)})).catch((e=>{n(e)}))}else n(o)}else n({})}))}deleteGDBVersion(t,s,i,a,r){return new Promise(((n,o)=>{if("sde.default"!==t.toLowerCase()){const o={};let l=null;if(this.isOrgUser){if(r)l=r,l.indexOf("FeatureServer")>=0?(l=l.substring(0,l.indexOf("FeatureServer")),l+="VersionManagementServer/delete"):l.indexOf("MapServer")>=0?(l=l.substring(0,l.indexOf("MapServer")),l+="VersionManagementServer/delete"):l+="VersionManagementServer/delete";else{let e=this.uniqueURLs[0];a&&(e=this.uniqueURLs.filter((e=>e.name===a))),l=e[0].url+"VersionManagementServer/delete"}this.requestService({method:"POST",url:l,params:{f:"json",versionName:t,sessionId:s,token:s}}).then((s=>{const a=[];for(const s in i)i[s].type===e.DataSourceTypes.FeatureLayer&&this.getLayerObject(i[s]).getGDBVersion()===t&&(a[s]=i[s]);this.changeGDBVersion(this.defaultVersion,a),s.version=this.defaultVersion,n(s)})).catch((e=>{n(e)}))}else n(o)}else n({error:{message:"Cannot delete Default version"}})}))}alterGDBVersion(e,t,s,i,a,r){return new Promise(((n,o)=>{let l=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){let o=e.versionGuid.replace("{","");if(o=o.replace("}",""),a)l=a,l.indexOf("FeatureServer")>=0?(l=l.substring(0,l.indexOf("FeatureServer")),l=l+"VersionManagementServer/versions/"+o+"/alter"):l.indexOf("MapServer")>=0?(l=l.substring(0,l.indexOf("MapServer")),l=l+"VersionManagementServer/versions/"+o+"/alter"):l=l+"VersionManagementServer/versions/"+o+"/alter";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter((e=>e.name===i))),l=e[0].url+"VersionManagementServer/versions/"+o+"/alter"}this.requestService({method:"POST",url:l,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,ownerName:e.versionOwner,token:t}}).then((t=>{r&&this.changeGDBVersion(e.versionOwner+"."+e.versionName,s),n(t)})).catch((e=>{n(e)}))}else n(o)}else n({})}))}getVersionState(e,t,s,i){return new Promise(((a,r)=>{let n=null,o=e.versionGuid.replace("{","");if(o=o.replace("}",""),i)n=i,n.indexOf("FeatureServer")>=0?(n=n.substring(0,n.indexOf("FeatureServer")),n=n+"VersionManagementServer/versions/"+o):n.indexOf("MapServer")>=0?(n=n.substring(0,n.indexOf("MapServer")),n=n+"VersionManagementServer/versions/"+o):n=n+"VersionManagementServer/versions/"+o;else{let e=this.uniqueURLs[0];s&&(e=this.uniqueURLs.filter((e=>e.name===s))),n=e[0].url+"VersionManagementServer/versions/"+o}this.requestService({method:"POST",url:n,params:{f:"json",token:t}}).then((e=>{a(e)})).catch((e=>{a(e)}))}))}checkValidVersionName(e){const t={success:!0,error:{message:"Version is valid"}};return e.length<=62?" "===e.substring(0,1)?(t.success=!1,t.error.message="Version name can not start with a space"):e.match(/(?=.*[.;'"])/)&&(t.success=!1,t.error.message="Version name can not have a period, semicolon, and single or double quotes"):(t.success=!1,t.error.message="Exceeded 62 characters for version name"),t}requestVersions(e,t){return new Promise(((s,i)=>{let a=e,r={};t?(a+="VersionManagementServer/versionInfos",r={f:"json",includeHidden:!0,token:t},this.isOrgUser=!0):(a+="VersionManagementServer/versions",r={f:"json",includeHidden:!0},this.isOrgUser=!1),this.requestService({method:"POST",url:a,params:r}).then((i=>n(this,void 0,void 0,(function*(){i.hasOwnProperty("error")?t?e?(console.log("second pass, service url"),this.getVersions(e).then((e=>{e.canManage=!1,s(e)}))):(console.log("second pass, no service url"),this.getVersions().then((e=>{e.canManage=!1,s(e)}))):(i.canManage=!1,s(i)):(i.canManage=!0,s(i))})))).catch((e=>{s(e)}))}))}getLayerObject(t){return t.type,e.DataSourceTypes.FeatureLayer,t}serviceNameLookup(e){return new Promise(((t,s)=>{const i=e+"FeatureServer";this.requestService({method:"POST",url:i,params:{f:"json"}}).then((e=>{e.hasOwnProperty("documentInfo")?t(e.documentInfo.Title):t("")})).catch((e=>{t(e)}))}))}versionRead(e){return new Promise(((t,s)=>{let i=this.uniqueURLs[0],a=e.versionGuid.replace("{","");a=a.replace("}",""),i=i+"VersionManagementServer/versions/"+a+"/"+e.action+"Reading/",this.requestService({method:"POST",url:i,params:{f:"json",sessionId:e.versionGuid,token:e.token}}).then((e=>{t(e)}))}))}searchPortalUsers(e,t,s){return new Promise(((i,a)=>{let r=e+"/sharing/rest/community/users";e.includes("sharing/rest")&&(r=e+"/community/users"),this.requestService({method:"POST",url:r,params:{f:"json",q:t,token:s}}).then((e=>{i(e)})).catch((e=>{i(e)}))}))}requestService(t){return new Promise((function(s,i){const a={params:t.params,httpMethod:t.method};e.esri.restRequest.request(t.url,a).then((e=>{s(e)})).catch((e=>{s(e)}))}))}}var d=o(93379),g=o.n(d),u=o(7795),m=o.n(u),h=o(90569),p=o.n(h),S=o(3565),f=o.n(S),v=o(19216),I=o.n(v),M=o(44589),y=o.n(M),w=o(5262),D={};D.styleTagTransform=y(),D.setAttributes=f(),D.insert=p().bind(null,"head"),D.domAPI=m(),D.insertStyleElement=I(),g()(w.Z,D),w.Z&&w.Z.locals&&w.Z.locals;const x=o(40325),b=o(58794),N=o(51697),E=o(5013),T=o(39986),C=o(93724);class j extends t.BaseWidgetSetting{constructor(t){super(t),this.sidePopperTrigger=e.React.createRef(),this.defaultVersion="sde.DEFAULT",this.vms=c.getInstance(),this.formatMessage=(t,a)=>{const r=Object.assign({},s,i.defaultMessages,e.defaultMessages);return this.props.intl.formatMessage({id:t,defaultMessage:r[t]},a)},this.fieldColumns=[{field:"access",alias:this.formatMessage("fieldColumnsAccess"),show:!0,sort:"desc",order:2,available:!0},{field:"commonAncestorDate",alias:this.formatMessage("fieldColumnsCommonAncestorDate"),show:!1,sort:"desc",order:5,available:!0},{field:"creationDate",alias:this.formatMessage("fieldColumnsCreationDate"),show:!1,sort:"desc",order:3,available:!0},{field:"description",alias:this.formatMessage("fieldColumnsDescription"),show:!1,sort:"desc",order:4,available:!0},{field:"evaluationDate",alias:this.formatMessage("fieldColumnsEvaluationDate"),show:!1,sort:"desc",order:6,available:!0},{field:"modifiedDate",alias:this.formatMessage("fieldColumnsModifiedDate"),show:!0,sort:"desc",order:7,available:!0},{field:"previousAncestorDate",alias:this.formatMessage("fieldColumnsPreviousAncestorDate"),show:!1,sort:"desc",order:8,available:!0},{field:"reconcileDate",alias:this.formatMessage("fieldColumnsReconcileDate"),show:!1,sort:"desc",order:9,available:!0},{field:"versionGuid",alias:this.formatMessage("fieldColumnsVersionGuid"),show:!1,sort:"desc",order:10,available:!0},{field:"versionId",alias:this.formatMessage("fieldColumnsVersionId"),show:!1,sort:"desc",order:11,available:!0},{field:"versionName",alias:this.formatMessage("fieldColumnsVersionName"),show:!0,sort:"desc",order:0,available:!0},{field:"versionOwner",alias:this.formatMessage("fieldColumnsVersionOwner"),show:!0,sort:"desc",order:1,available:!0}],this.allowance=[{label:this.formatMessage("allowancesSwitch"),key:"Switch",enabled:!0},{label:this.formatMessage("allowancesCreateNew"),key:"CreateNew",enabled:!0},{label:this.formatMessage("allowancesDeleteExisting"),key:"DeleteExisting",enabled:!1},{label:this.formatMessage("allowancesUpdateName"),key:"UpdateName",enabled:!0},{label:this.formatMessage("allowancesUpdateDescription"),key:"UpdateDescription",enabled:!0},{label:this.formatMessage("allowancesChangeOwner"),key:"ChangeOwner",enabled:!1},{label:this.formatMessage("allowancesChangePrivileges"),key:"ChangePrivileges",enabled:!1},{label:this.formatMessage("allowancesAutoRefreshList"),key:"AutoRefreshList",enabled:!0,refreshInterval:1}],this._updateServicesToConfig=t=>{const s=(0,e.Immutable)(this.state.configObject),i=e.Immutable.asMutable(s,{deep:!0});i.services=e.Immutable.asMutable((0,e.Immutable)(this.state.vmsServices),{deep:!0}),this.setState({configObject:i},(()=>{t?this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",i),useDataSources:t}):this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",i)})}))},this.updateConfigItem=(t,s)=>{const i=(0,e.Immutable)(this.state.vmsServices),a=e.Immutable.asMutable(i,{deep:!0});a.forEach((e=>{e.name===this.state.selectedService.name&&(e.configuredSettings[s]=t.hasOwnProperty("currentTarget")?t.currentTarget.value:t)})),this.setState({vmsServices:a},(()=>{this._updateServicesToConfig()}))},this.updateGeneralItem=(e,t)=>{const s=Object.assign({},this.state.configObject);s[t]=e,"expandMode"===t?this.setState({configObject:s,expandMode:e},(()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})})):this.setState({configObject:s},(()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})}))},this.updateArrangementItem=e=>{const t=Object.assign({},this.state.configObject);t.arrangement=e,this.setState({configObject:t,arrangementStyle:e},(()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",t)})}))},this.onToggleUseDataEnabled=e=>{this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e})},this._checkDSInfo=t=>{const s=e.DataSourceManager.getInstance().getDataSources();for(const e in s)s[e].type},this.arrangementHandler=e=>{this.updateArrangementItem(e)},this.renderFieldOrderList=()=>{const t=[];let a=[];if(Object.keys(this.state.selectedService).length>0){const r=(0,e.Immutable)(this.state.vmsServices),n=e.Immutable.asMutable(r,{deep:!0});if(""!==this.state.selectedService){const e=n.filter((e=>e.name===this.state.selectedService.name));e.length>0&&(a=e[0].configuredSettings.displayInfo)}a.sort(this._compare("order","desc")),a.forEach((e=>{for(const t in s)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))})),a.forEach(((s,r)=>{s.available&&t.push(e.React.createElement("tr",{key:s.field},e.React.createElement("td",{style:{fontSize:"smaller"}},s.alias),e.React.createElement("td",null,e.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},r>0?e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("up",r)}},e.React.createElement(i.Icon,{icon:b,size:"12",color:"#fff"})):e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm"}),r<a.length-1?e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("down",r)}},e.React.createElement(i.Icon,{icon:N,size:"12",color:"#fff"})):e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm"})))))}))}return e.React.createElement(i.Table,{style:{height:"100%"}},e.React.createElement("thead",null,e.React.createElement("tr",null,e.React.createElement("th",{style:{fontSize:"smaller"}},this.formatMessage("field")),e.React.createElement("th",{style:{fontSize:"smaller"}}))),e.React.createElement("tbody",null,t))},this.renderConfigSlideout=()=>{var t;const{theme:s}=this.props;let r=!0;return r=this._checkAllowAllState(),e.React.createElement(a.SidePopper,{isOpen:this.state.showSidePanel,position:"right",toggle:()=>{this.setState({showSidePanel:!this.state.showSidePanel})},trigger:null===(t=this.sidePopperTrigger)||void 0===t?void 0:t.current},e.React.createElement("div",{style:{height:"100%",overflow:"auto"}},e.React.createElement("div",{style:{textAlign:"right",width:"100%"}},e.React.createElement(i.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-2",onClick:()=>{this.setState({showSidePanel:!1})}},e.React.createElement(i.Icon,{icon:x,size:"16"}))),this.state.selectedService.hasOwnProperty("name")&&this.renderVersionSelector(),"simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&this.renderVersionInformation():"","simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&e.React.createElement(a.SettingSection,{className:"map-selector-section",title:e.React.createElement(e.React.Fragment,null,e.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.React.createElement("div",{style:{display:"flex",flex:1}},this.formatMessage("settingsSectionsVersionCapability")),e.React.createElement(i.Tooltip,{title:this.formatMessage("settingsSectionsVersionCapabilityTooltip"),placement:"bottom"},e.React.createElement("div",null,e.React.createElement(i.Icon,{icon:T,size:"16",color:s.colors.palette.dark[100]})))))},e.React.createElement(a.SettingRow,null,e.React.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},e.React.createElement("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end"}}),e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},this.formatMessage("settingsSectionsAllowCapability"))),e.React.createElement("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end",paddingLeft:5,paddingRight:5,paddingBottom:5}},this.formatMessage("settingsSectionsAllowAll")),e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end",borderBottom:"1px solid #ccc",paddingBottom:5}},e.React.createElement(i.Switch,{checked:r,onChange:e=>{this.updateAllowanceAction(null,e.currentTarget.checked,!0)}}))),this.renderAllowances("advance")))):e.React.createElement(a.SettingSection,null,this.renderAllowances("simple"))))},this._checkAllowAllState=()=>{let t=!0;const s=(0,e.Immutable)(this.state.vmsServices);if(""!==this.state.selectedService){const e=s.filter((e=>e.name===this.state.selectedService.name));e.length>0&&(t=!e[0].configuredSettings.allowance.some((e=>!1===e.enabled)))}return t},this.renderAllowances=t=>{const a=[];let r=[];const n=(0,e.Immutable)(this.state.vmsServices),o=e.Immutable.asMutable(n,{deep:!0});if(""!==this.state.selectedService){const e=o.filter((e=>e.name===this.state.selectedService.name));e.length>0&&(r=e[0].configuredSettings.allowance)}return r.forEach((e=>{for(const t in s)t.toLowerCase()===("allowances"+e.key).toLowerCase()&&(e.label=this.formatMessage(t))})),r.forEach((s=>{("advance"===t||"AutoRefreshList"===s.key)&&a.push(e.React.createElement("div",{key:s.label,style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4}},s.label),e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},e.React.createElement(i.Switch,{checked:s.enabled,onChange:e=>{this.updateAllowanceAction(s.key,e.currentTarget.checked,!1)}})))),"AutoRefreshList"===s.key&&s.enabled&&(a.push(e.React.createElement("div",{key:"refreshInterval",style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},e.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:6}},this.formatMessage("settingsSectionsMinutes")),e.React.createElement("div",{style:{textAlign:"right",display:"flex",flexDirection:"row",flex:1}},e.React.createElement(i.NumericInput,{style:{width:75},value:this.state.intervalNumber,size:"sm",min:1,max:999,type:"number",onChange:e=>{this.setState({invalidInterval:!0,intervalNumber:e},(()=>{this.updateAllowanceInterval(s.key,e)}))}})))),a.push(e.React.createElement("div",{key:"toolTipHolder",style:{textAlign:"right",fontSize:"12px",fontStyle:"italic"}},this.formatMessage("settingsSectionsTooltipNumber"))))})),a},this.updateAllowanceInterval=(t,s)=>{if(""!==this.state.selectedService){let i=[];const a=(0,e.Immutable)(this.state.vmsServices),r=e.Immutable.asMutable(a,{deep:!0});r.forEach((e=>{e.name===this.state.selectedService.name&&(i=e.configuredSettings.allowance,i.forEach((e=>{e.key===t&&(e.refreshInterval=s)})))})),this.setState({vmsServices:r},(()=>{this._updateServicesToConfig()}))}},this.updateAllowanceAction=(t,s,i)=>{if(""!==this.state.selectedService){let a=[];const r=(0,e.Immutable)(this.state.vmsServices),n=e.Immutable.asMutable(r,{deep:!0});n.forEach((e=>{e.name===this.state.selectedService.name&&(a=e.configuredSettings.allowance,a.forEach((e=>{(i||e.key===t)&&(e.enabled=s)})))})),this.setState({vmsServices:n},(()=>{this._updateServicesToConfig()}))}},this.updateActiveService=()=>{if(""!==this.state.selectedService){const t=(0,e.Immutable)(this.state.vmsServices),s=e.Immutable.asMutable(t,{deep:!0});s.forEach((e=>{e.name===this.state.selectedService.name?e.activeInBuilder=!0:e.activeInBuilder=!1})),this.setState({vmsServices:s},(()=>{this._updateServicesToConfig()}))}},this.renderServiceSelector=()=>{const{theme:t}=this.props,s=[];return this.state.vmsServices.length>0&&this.state.vmsServices.forEach(((t,a)=>{const r=e.React.createElement("tr",{key:t.name,style:{borderLeft:t.name===this.state.selectedService.name?"solid #00aabb":""}},this.state.vmsServices.length>1&&e.React.createElement("td",null,a>0?e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("up",a)}},e.React.createElement(i.Icon,{icon:b,size:"12",color:"#fff"})):"",a<this.state.vmsServices.length-1?e.React.createElement(i.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("down",a)}},e.React.createElement(i.Icon,{icon:N,size:"12",color:"#fff"})):""),e.React.createElement("td",{role:"button",style:{fontSize:"smaller",width:"100%"},onClick:()=>{this.serviceSelectorAction(t)}},t.name),e.React.createElement("td",{role:"button",style:{fontSize:"smaller"},onClick:()=>{this.serviceRemoveAction(t)}},e.React.createElement(i.Icon,{icon:x,size:"12"})));s.push(r)})),e.React.createElement(a.SettingSection,{className:"map-selector-section",title:e.React.createElement(e.React.Fragment,null,e.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.React.createElement(i.Tooltip,{title:this.formatMessage("settingsSectionsVersionService"),placement:"bottom"},e.React.createElement("div",{style:{width:"100%",paddingRight:20,overflow:"hidden",textOverflow:"ellipsis"}},this.formatMessage("settingsSectionsVersionService"))),e.React.createElement(i.Tooltip,{title:this.formatMessage("settingsSectionsVersionServiceHelp"),placement:"bottom"},e.React.createElement("div",{onClick:()=>{window.open("https://pro.arcgis.com/en/pro-app/latest/help/data/geodatabases/overview/register-a-dataset-as-branch-versioned.htm","_blank")},style:{cursor:"pointer"}},e.React.createElement(i.Icon,{icon:C,size:"16",color:t.colors.palette.dark[100]})))))},e.React.createElement(a.SettingRow,null,e.React.createElement(r.DataSourceSelector,{types:(0,e.Immutable)([e.AllDataSourceTypes.FeatureService,e.AllDataSourceTypes.MapService]),mustUseDataSource:!0,isMultiple:!0,useDataSourcesEnabled:this.props.useDataSourcesEnabled,onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.validateVMSExist,widgetId:this.props.id,closeDataSourceListOnChange:!0})),e.React.createElement(a.SettingRow,null,e.React.createElement(i.Alert,{form:"basic",type:"warning",open:this.state.showAlert,closable:!0,text:this.state.alertMessage,onClose:()=>{this.setState({showAlert:!this.state.showAlert})}})),e.React.createElement(a.SettingRow,null,e.React.createElement("div",{className:"w-100"},e.React.createElement("div",{className:"component-map-selector",style:{maxHeight:300,overflow:"auto"},ref:this.sidePopperTrigger},e.React.createElement(i.Table,{size:"sm",hover:!0,style:{fontSize:"medium"}},e.React.createElement("tbody",null,s))))))},this.validateVMSExist=t=>{return s=this,i=void 0,r=function*(){const s=e.DataSourceManager.getInstance().getDataSources();let i=!1,a=!1;for(const r in s)if(r===t[0].dataSourceId){const n=s[r].getDataSourceJson();let o=n.url;if(n.url.includes("FeatureServer")&&(o=n.url.substring(0,n.url.indexOf("FeatureServer"))),n.url.includes("MapServer")&&(o=n.url.substring(0,n.url.indexOf("MapServer"))),this.state.vmsServices.length>0&&this.state.vmsServices.filter((e=>e.name===s[r].getLabel()||e.url===o)).length>0&&(a=!0),!a){const a=this.getServiceToken(o);let n=!1;if(n=null!==a?yield this.vms.checkValidVMS(o,a):yield this.vms.checkValidVMS(o),n){i=!0;const a={},n=(0,e.Immutable)(this.state.vmsServices),l=e.Immutable.asMutable(n,{deep:!0});a.name=s[r].getLabel(),a.url=o,a.datasource=r,a.activeInBuilder=!0,a.configuredSettings={startupVersion:this.defaultVersion,startOnLoad:!1,allowance:e.Immutable.asMutable((0,e.Immutable)(this.allowance),{deep:!0}),displayInfo:e.Immutable.asMutable((0,e.Immutable)(this.fieldColumns),{deep:!0})},l.forEach((e=>{e.activeInBuilder=!1})),l.push(a),this.setState({vmsServices:l,showAlert:!1,alertMessage:"",selectedService:a,showSidePanel:!0},(()=>{this._updateServicesToConfig(t),this.pullVersions(this.state.selectedService)}))}}}a?this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesAlreadyAdded")}):i||this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesNotValid")})},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(r.next(e))}catch(e){t(e)}}function o(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(n,o)}l((r=r.apply(s,i||[])).next())}));var s,i,a,r},this.serviceSelectorAction=e=>{if(""!==e){const t=this.state.vmsServices.filter((t=>t.name===e.name));t.length>0&&this.setState({selectedService:t[0],showSidePanel:!0,intervalNumber:t[0].configuredSettings.allowance[7].refreshInterval,searchVersionText:"",showAlert:!1},(()=>{this.pullVersions(this.state.selectedService),this.updateActiveService()}))}else this.setState({selectedService:"",showSidePanel:!1,intervalNumber:1,invalidInterval:!1,searchVersionText:""})},this.serviceRemoveAction=t=>{if(t){let s=-1,i=!1;const a=(0,e.Immutable)(this.state.vmsServices),r=e.Immutable.asMutable(a,{deep:!0});r.forEach(((e,a)=>{e.name===t.name&&(s=a,""!==this.state.selectedService&&e.name===this.state.selectedService.name&&(i=!0))})),-1!==s&&(r.splice(s,1),i?this.setState({vmsServices:r,selectedService:"",showSidePanel:!1,searchVersionText:""},(()=>{this._updateServicesToConfig()})):this.setState({vmsServices:r},(()=>{this._updateServicesToConfig()})))}},this.renderVersionSelector=()=>{let t=this.defaultVersion,s=null;const r=[];let n=!1;const o=this.state.vmsServices.filter((e=>{if(""!==this.state.selectedService&&e.name===this.state.selectedService.name)return e}));return o.length>0&&(t=o[0].configuredSettings.startupVersion),""!==this.state.searchVersionText&&this.state.filteredVersionList.length>0&&(t=this.state.filteredVersionList[0].versionGuid),this.state.filteredVersionList.forEach((i=>{i.versionName===this.defaultVersion&&(s=i.versionGuid),t===i.versionGuid&&(n=!0),this.state.searchVersionText===i.versionName&&(n=!0,t=i.versionGuid),r.push(e.React.createElement("option",{key:i.versionGuid,value:i.versionGuid},i.versionName))})),n||(t=null!==s?s:this.defaultVersion),e.React.createElement(a.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsSelectVersion")},e.React.createElement(a.SettingRow,null,e.React.createElement(i.TextInput,{type:"text",onChange:this.searchVersions,value:this.state.searchVersionText,placeholder:this.formatMessage("settingsSectionsSearchName"),style:{width:"100%"}})),e.React.createElement(a.SettingRow,null,e.React.createElement(i.Select,{onChange:e=>{this.updateVersionSelected(e.currentTarget)},defaultValue:t,value:t},r)))},this.updateVersionSelected=t=>{const s=(0,e.Immutable)(this.state.vmsServices),i=e.Immutable.asMutable(s,{deep:!0});i.forEach(((e,s)=>{""!==this.state.selectedService&&e.name===this.state.selectedService.name&&(e.configuredSettings.startupVersion=t.value)})),""!==this.state.searchVersionText?this.setState({vmsServices:i,searchVersionText:t.textContent},(()=>{this._updateServicesToConfig()})):this.setState({vmsServices:i},(()=>{this._updateServicesToConfig()}))},this.renderGeneralSection=()=>{let t=10;const s=Object.assign({},this.state.configObject);s.hasOwnProperty("pageCounter")&&(t=s.pageCounter);const r=[e.React.createElement("option",{key:"5",value:5},"5"),e.React.createElement("option",{key:"10",value:10},"10"),e.React.createElement("option",{key:"25",value:25},"25"),e.React.createElement("option",{key:"50",value:50},"50")];return e.React.createElement(e.React.Fragment,null,e.React.createElement(a.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsGeneralSettings")},e.React.createElement(a.SettingRow,null,this.formatMessage("settingsSectionsRecordsPage")),e.React.createElement(a.SettingRow,null,e.React.createElement(i.Select,{size:"sm",onChange:e=>{this.updateGeneralItem(e.currentTarget.value,"pageCounter")},defaultValue:t},r))),e.React.createElement(a.SettingSection,{className:"map-selector-section",title:""},e.React.createElement(a.SettingRow,null,this.formatMessage("settingsSectionsExpandBasic")),e.React.createElement(a.SettingRow,null,e.React.createElement(i.Switch,{checked:this.state.expandMode,onChange:e=>{this.updateGeneralItem(e.currentTarget.checked,"expandMode")}}))))},this.pullVersions=e=>{let t=e.url;e.url.indexOf("FeatureServer")>=0&&(t=e.url.substring(0,e.url.indexOf("FeatureServer"))),e.url.indexOf("MapServer")>=0&&(t=e.url.substring(0,e.url.indexOf("MapServer")));let s=this.getServiceToken(t);null===s&&(s=void 0),this.vms.getVersions(e.name,t,s).then((e=>{e.hasOwnProperty("success")?e.success&&e.hasOwnProperty("versions")&&this.setState({filteredVersionList:e.versions,allVersionList:e.versions}):e.hasOwnProperty("error")&&this.setState({filteredVersionList:[],allVersionList:[]})}))},this.searchVersions=e=>{const t=[...this.state.allVersionList].filter((t=>t.versionName.toLowerCase().indexOf(e.currentTarget.value.toLowerCase())>=0));this.setState({filteredVersionList:t,searchVersionText:e.currentTarget.value},(()=>{this.state.filteredVersionList.length>0&&this.updateConfigItem(this.state.filteredVersionList[0].versionGuid,"startupVersion")}))},this.renderVersionInformation=()=>{const{theme:t}=this.props,r=[];let n=[];const o=(0,e.Immutable)(this.state.vmsServices),l=e.Immutable.asMutable(o,{deep:!0});if(""!==this.state.selectedService){const t=l.filter((e=>e.name===this.state.selectedService.name));if(t.length>0&&(n=t[0].configuredSettings.displayInfo),n.length>0){const t=(()=>{let e=!1;return n.filter((e=>!0===e.show)).length<=1&&(e=!0),e})();n.sort(this._compare("order","desc")),n.forEach((e=>{for(const t in s)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))})),n.forEach((s=>{r.push(e.React.createElement("tr",{key:s.field},e.React.createElement("td",{style:{fontSize:12,textAlign:"left"}},s.alias),e.React.createElement("td",null,e.React.createElement(i.Checkbox,{className:"mr-2 font-13",checked:s.available,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"available",e.currentTarget.checked)},value:s.field})),e.React.createElement("td",null,e.React.createElement(i.Checkbox,{className:"mr-2 font-13",checked:s.show,disabled:!!s.show&&t,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"show",e.currentTarget.checked)},value:s.field}))))}))}}return e.React.createElement(a.SettingSection,{className:"map-selector-section",title:e.React.createElement(e.React.Fragment,null,e.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.React.createElement("div",{style:{display:"flex",flex:1}},this.formatMessage("settingsSectionsVersionInfo")),e.React.createElement(i.Tooltip,{title:this.formatMessage("settingsSectionsVersionInfoTooltip"),placement:"bottom"},e.React.createElement("div",null,e.React.createElement(i.Icon,{icon:T,size:"16",color:t.colors.palette.dark[100]})))))},e.React.createElement(a.SettingRow,null,e.React.createElement("div",{className:"w-100"},e.React.createElement("div",{className:"component-map-selector",style:{maxHeight:250,overflow:"auto"}},e.React.createElement(i.Table,{size:"sm",hover:!0,width:"90%",style:{textAlign:"center"}},e.React.createElement("thead",null,e.React.createElement("tr",null,e.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:"smaller",whiteSpace:"nowrap",alignItems:"top",zIndex:9999}},e.React.createElement(i.Button,{type:"tertiary",onClick:e=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},id:"btnFieldMgmt"},e.React.createElement(i.Icon,{icon:E,size:"14",color:"#fff"}))),e.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999}},this.formatMessage("fieldColumnsColumnAvailable")),e.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999}},this.formatMessage("fieldColumnsColumnShow")))),e.React.createElement("tbody",null,r))))),e.React.createElement(i.Popper,{open:this.state.showFieldMgmt,floating:!0,reference:"btnFieldMgmt",placement:"left",showArrow:!1,onHeaderClose:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},toggle:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},defaultSize:{width:250,height:600}},e.React.createElement("div",{style:{width:250,height:"100%",overflow:"auto"}},this.renderFieldOrderList())))},this.changeFieldOrder=(t,s)=>{if(""!==this.state.selectedService){let i=[];const a=(0,e.Immutable)(this.state.vmsServices),r=e.Immutable.asMutable(a,{deep:!0});r.forEach((e=>{if(e.name===this.state.selectedService.name){i=e.configuredSettings.displayInfo,i.sort(this._compare("order","desc"));let a=s;"up"===t?(a-=1,i[s].order=a,i[s-1].order=s):(a+=1,i[s].order=a,i[s+1].order=s)}})),this.setState({vmsServices:r},(()=>{this._updateServicesToConfig()}))}},this.changeServiceOrder=(t,s)=>{const i=(0,e.Immutable)(this.state.vmsServices),a=e.Immutable.asMutable(i,{deep:!0}),r=a.splice(s,1)[0];"up"===t?a.splice(s-1,0,r):a.splice(s+1,0,r),this.setState({vmsServices:a},(()=>{this._updateServicesToConfig()}))},this.changeFieldVisiblity=(t,s,i)=>{if(""!==this.state.selectedService){let a=[];const r=(0,e.Immutable)(this.state.vmsServices),n=e.Immutable.asMutable(r,{deep:!0});n.forEach((e=>{e.name===this.state.selectedService.name&&(a=e.configuredSettings.displayInfo,a.forEach((e=>{e.field===t&&(e[s]=i)})))})),this.setState({vmsServices:n},(()=>{this._updateServicesToConfig()}))}},this._compare=(e,t)=>function(s,i){let a=0;return"desc"===t?s[e]>i[e]?a=1:s[e]<i[e]&&(a=-1):s[e]<i[e]?a=1:s[e]>i[e]&&(a=-1),a},this.updateVMSInfo=(e,t)=>new Promise(((s,i)=>{const a=Object.assign({},this.state.selectedService);"configured"===e?a[e]=t:a.configuredSettings[e]=t,this.setState({selectedService:a},(()=>{const e=[...this.state.vmsServices];e.forEach((e=>{e.name===this.state.selectedService.name&&(e=this.state.selectedService)})),this.setState({vmsServices:e},(()=>{s(!0)}))}))})),this.getServiceToken=t=>{const s=e.urlUtils.getUrlHost(t.toLowerCase()),i=e.SessionManager.getInstance().getSessions(),a=i.filter((e=>e.portal.toLowerCase().indexOf(s)>-1));let r=null;return this.props.portalUrl.toLowerCase().includes(s)&&(r=this.props.token),a.length>0?r=a[0].token:null===r&&i.map((e=>{if(e.hasOwnProperty("federatedServers")){for(const t in e.federatedServers)t.toLowerCase().includes(s)&&(r=e.federatedServers[t].token);return!0}if(e.hasOwnProperty("trustedServers")){for(const t in e.trustedServers)t.toLowerCase().includes(s)&&(r=e.trustedServers[t].token);return!0}return!0})),r},this.toggleDialogAction=(e,t)=>{this.setState({showFieldMgmt:!this.state.showFieldMgmt})},this.getStyle=t=>e.css`
      .simple-view-header{
        background: ${t.colors.secondary};
      }

    `,this.state={allVersionList:[],filteredVersionList:[],selectedVersion:{},selectedService:{},selectedWebMap:"",vmsServices:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("services")?this.props.config.versionConfig.services:[],showServiceSelector:!1,showSidePanel:!1,showWebMapSelector:!1,showFieldMgmt:!1,showAlert:!1,alertMessage:this.formatMessage("alertMessagesErrorAlert"),searchVersionText:"",intervalNumber:1,invalidInterval:!1,expandMode:!this.props.config.versionConfig||!this.props.config.versionConfig.hasOwnProperty("expandMode")||this.props.config.versionConfig.expandMode,arrangementStyle:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("arrangement")?this.props.config.versionConfig.arrangement:"simple",configObject:e.Immutable.asMutable((0,e.Immutable)(this.props.config.versionConfig),{deep:!0})}}componentDidMount(){}render(){const{theme:t}=this.props;return e.React.createElement("div",{className:"widget-setting-demo"},e.React.createElement(a.SettingSection,{className:"map-selector-section",title:this.formatMessage("layoutStyleTitle")},e.React.createElement(a.SettingRow,null,e.React.createElement(i.Tooltip,{title:this.formatMessage("layoutStyleBasic"),placement:"bottom"},e.React.createElement("div",{key:"simpleMode"},e.React.createElement(i.Button,{onClick:()=>{this.arrangementHandler("simple")},icon:!0,size:"sm",type:"tertiary",active:"simple"===this.state.arrangementStyle,style:{backgroundColor:t.colors.palette.light[200],border:"simple"===this.state.arrangementStyle?"solid #00aabb":""}},e.React.createElement(i.Icon,{width:95,height:95,icon:o(82881)})),e.React.createElement("div",{style:{display:"flex",justifyContent:"center"}},this.formatMessage("layoutStyleBasic")))),e.React.createElement("div",{style:{padding:"0 10px"}}),e.React.createElement(i.Tooltip,{title:this.formatMessage("layoutStyleAdvanced"),placement:"bottom"},e.React.createElement("div",{key:"advanceMode"},e.React.createElement(i.Button,{onClick:()=>{this.arrangementHandler("management")},icon:!0,size:"sm",type:"tertiary",active:"management"===this.state.arrangementStyle,style:{backgroundColor:t.colors.palette.light[200],border:"management"===this.state.arrangementStyle?"solid #00aabb":""}},e.React.createElement(i.Icon,{width:95,height:95,icon:o(89435)})),e.React.createElement("div",{style:{display:"flex",justifyContent:"center"}},this.formatMessage("layoutStyleAdvanced")))))),this.renderServiceSelector(),this.renderGeneralSection(),this.state.showSidePanel&&this.renderConfigSlideout())}}})(),l})())}}}));