System.register(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,t){var l={},n={},i={};return{setters:[function(e){l.BaseVersionManager=e.BaseVersionManager,l.Immutable=e.Immutable,l.React=e.React,l.ReactRedux=e.ReactRedux,l.UtilityManager=e.UtilityManager,l.appActions=e.appActions,l.classNames=e.classNames,l.css=e.css,l.defaultMessages=e.defaultMessages,l.esri=e.esri,l.jsx=e.jsx,l.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,l.lodash=e.lodash,l.moduleLoader=e.moduleLoader,l.polished=e.polished},function(e){n.Badge=e.Badge,n.Button=e.Button,n.Checkbox=e.Checkbox,n.Icon=e.Icon,n.Nav=e.Nav,n.NavItem=e.NavItem,n.NavLink=e.NavLink,n.Navbar=e.Navbar,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Popper=e.Popper,n.Radio=e.Radio,n.SVG=e.SVG,n.Select=e.Select,n.TextInput=e.TextInput,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages,n.getFallbackPlacementsModifier=e.getFallbackPlacementsModifier,n.hooks=e.hooks},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules}],execute:function(){e((()=>{var e={60171:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.4.8V4h-.8A1.6 1.6 0 0 0 0 5.6v3.2a1.6 1.6 0 0 0 1.136 1.532c.249.075.464-.143.464-.403 0-.182-.154-.323-.32-.396A.8.8 0 0 1 .8 8.8V5.6a.8.8 0 0 1 .8-.8h12.8a.8.8 0 0 1 .8.8v3.2a.8.8 0 0 1-.48.733c-.166.073-.32.214-.32.396 0 .26.215.478.464.403A1.6 1.6 0 0 0 16 8.8V5.6A1.6 1.6 0 0 0 14.4 4h-.8V.8a.8.8 0 0 0-.8-.8H3.2a.8.8 0 0 0-.8.8Zm10.4 0H3.2V4h9.6V.8Z" fill="#C5C5C5"></path><path d="M5.2 10.4a.4.4 0 0 0 0 .8h5.6a.4.4 0 0 0 0-.8H5.2ZM5.2 12.8a.4.4 0 0 0 0 .8h3.2a.4.4 0 0 0 0-.8H5.2Z" fill="#C5C5C5"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.4 15.2V8.8H2A.4.4 0 0 1 2 8h12a.4.4 0 0 1 0 .8h-.4v6.4a.8.8 0 0 1-.8.8H3.2a.8.8 0 0 1-.8-.8Zm10.4-6.4v6.4H3.2V8.8h9.6Z" fill="#C5C5C5"></path><path d="M12 6c0-.22.18-.4.4-.4h.8a.4.4 0 0 1 0 .8h-.8A.4.4 0 0 1 12 6Z" fill="#C5C5C5"></path></svg>'},51513:e=>{e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.167 0H1.833A.845.845 0 0 0 1 .857v10.286c0 .473.373.857.833.857h8.334c.46 0 .833-.384.833-.857V.857A.845.845 0 0 0 10.167 0ZM2 11V1h8v10H2Zm1.6-8h4.8c.331 0 .6.224.6.5s-.269.5-.6.5H3.6c-.331 0-.6-.224-.6-.5s.269-.5.6-.5Zm4.8 3H3.6c-.331 0-.6.224-.6.5s.269.5.6.5h4.8c.331 0 .6-.224.6-.5S8.731 6 8.4 6Z" fill="#000"></path></svg>'},59788:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z" fill="#000"></path></svg>'},96009:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .538.538 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.538.538 0 0 1 0 .738Z" fill="#000"></path></svg>'},55339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z" fill="#000"></path></svg>'},27218:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8Z" fill="#000"></path></svg>'},94539:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.796 4.796 4 8.02 7.224l3.184-3.184.796.796L8.816 8.02l3.144 3.144-.796.796L8.02 8.816 4.836 12l-.796-.796L7.224 8.02 4 4.796Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="m0 4 4-4h8l4 4v8l-4 4H4l-4-4V4Zm1 .414L4.414 1h7.172L15 4.414v7.172L11.586 15H4.414L1 11.586V4.414Z" fill="#000"></path></svg>'},26826:e=>{"use strict";e.exports=i},48891:e=>{"use strict";e.exports=l},30726:e=>{"use strict";e.exports=n}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var i=t[l]={exports:{}};return e[l](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var a={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(a),o.d(a,{default:()=>Ee});var e=o(48891),t=o(30726),l=o(26826);var n,i;!function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(n||(n={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(i||(i={}));const r={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:n.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:102100,wkidLabel:"WGS_1984_Web_Mercator_Auxiliary_Sphere",enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var s,u,d,c;!function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(s||(s={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(u||(u={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(d||(d={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(c||(c={}));var v=o(60171),p=o.n(v);const m={_widgetLabel:"Print",printPleaceholder:"Select or switch to a webmap to enable print.",chooseMapTip:"Please select a map with 2D data.",chooseUseUtility:"Please select utility.",printTemplate:"Print template",printResult:"Print result",previewPrint:"Preview print extents",fileFormat:"File format",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",wellKnownId:"Enter a well-known ID ({wkid})",allowEditing:"Select settings that allow editing at runtime",includeAttribution:"Include attribution",includeAttributes:"Include attributes",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",spatialReference:"Output spatial reference {WKID}",printAuyhor:"Author",printCopyright:"Copyright",scaleBarUnit:"Scalebar unit",mapAttribution:"Map attribution",resultEmptyMessage:"Your printed files will appear here.",northArrow:"North arrow",includeNorthArrow:"Include north arrow"};var h=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};const x=(t,l)=>{let n=l;return(null==t?void 0:t.exportOptions)&&(n=n.set("exportOptions",Object.assign(Object.assign({},t.exportOptions||{}),(null==l?void 0:l.exportOptions)||{}))),(null==t?void 0:t.layoutOptions)&&(null==l?void 0:l.layoutOptions)&&(n=n.set("layoutOptions",Object.assign(Object.assign({},(null==t?void 0:t.layoutOptions)||{}),(null==l?void 0:l.layoutOptions)||{}))),(0,e.Immutable)(Object.assign(Object.assign({},t),n))},g=(e,t)=>{let l;return null==e||e.forEach(((e,n)=>{(null==e?void 0:e.templateId)===t&&(l=n)})),l},f=e=>"map-only"===(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===l?void 0:l.toLowerCase()})(e),y=(e,t)=>{let l=!1;return null==e||e.forEach((e=>{(null==e?void 0:e.templateId)===t&&(l=!0)})),l},b=t=>h(void 0,void 0,void 0,(function*(){return e.UtilityManager.getInstance().getUrlOfUseUtility(t).then((e=>Promise.resolve(e)))}));function w(t){return h(this,void 0,void 0,(function*(){return(0,e.loadArcGISJSAPIModules)(["esri/rest/support/LegendLayer"]).then((e=>{var l,n,i,o;const[a]=e,r=null===(o=null===(i=null===(n=null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.map)||void 0===n?void 0:n.layers)||void 0===i?void 0:i.toArray())||void 0===o?void 0:o.map((e=>new a({layerId:null==e?void 0:e.id,title:null==e?void 0:e.title})));return Promise.resolve(r)}))}))}function j(e={}){var t;let l=null;for(const n in e)"CIMMarkerNorthArrow"===(null===(t=null==e?void 0:e[n])||void 0===t?void 0:t.type)&&(l=n);return l}var O=o(59788),N=o.n(O);const S=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:N()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var I=o(96009),T=o.n(I);const M=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:T()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var C=o(27218),P=o.n(C);const L=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:P()},i)):e.React.createElement("svg",Object.assign({className:o},i))},E=t=>{const{label:l,className:n,children:i,flowWrap:o}=t,a=e.css`
    .title {
      font-size: 14px;
    }
  `;return(0,e.jsx)("div",{className:(0,e.classNames)("mb-2 align-items-center",{className:n,"d-flex":!o}),css:a},(0,e.jsx)("div",{className:(0,e.classNames)("title flex-grow-1",{"mb-2":o})},l),i)};const k=(e,t)=>{let l=1,n=e;return t.forEach((i=>{n===(null==i?void 0:i.title)&&(n=`${e} (${l})`,l++,k(n,t))})),n},A=e=>{const t=(e=>{var t;return e?null===(t=null==e?void 0:e.asMutable())||void 0===t?void 0:t.map((e=>e.resultId)):[]})(e);return t&&0!==(null==t?void 0:t.length)?`config_${R(t)+1}`:"result_0"},R=e=>{var t;if(!e||0===(null==e?void 0:e.length))return 0;const l=null==e?void 0:e.map((e=>{var t;const l=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return l?Number(l):0}));return null===(t=null==l?void 0:l.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]};function z(e,t){return"print-extents-layer-"+e+"-"+t}function V(e,t){var l,i,o,a,r,s,u,d,c,v;return u=this,d=void 0,v=function*(){const u=!1===(null==e?void 0:e.hasTitleText),d=!1===(null==e?void 0:e.hasLegend);let c=e.without("enableTitle","enableAuthor","enableOutputSpatialReference","enableMapPrintExtents","enableQuality","enableMapSize","enableFeatureAttribution","enableCopyright","enableLegend","enableMapAttribution","enableCustomTextElements","hasAuthorText","hasCopyrightText","hasLegend","hasTitleText","selectedFormatList","mapFrameSize","mapFrameUnit","legendEnabled","templateId","printExtentType","customTextElementEnableList");switch(null==e?void 0:e.printExtentType){case n.CurrentMapExtent:c=c.set("scalePreserved",!1);break;case n.CurrentMapScale:c=c.set("outScale",null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.scale).set("scalePreserved",!0);break;case n.SetMapScale:c=c.set("scalePreserved",!0)}const v=null==c?void 0:c.asMutable({deep:!0});return u&&(null===(i=null==v?void 0:v.layoutOptions)||void 0===i||delete i.titleText),d&&(null===(o=null==v?void 0:v.layoutOptions)||void 0===o||delete o.legendLayers),(null===(a=null==e?void 0:e.layoutOptions)||void 0===a?void 0:a.legendLayers)&&(null===(s=null===(r=null==e?void 0:e.layoutOptions)||void 0===r?void 0:r.legendLayers)||void 0===s?void 0:s.length)>0&&(v.layoutOptions.legendLayers=yield w(t)),Promise.resolve(v)},new((c=void 0)||(c=Promise))((function(e,t){function l(e){try{i(v.next(e))}catch(e){t(e)}}function n(e){try{i(v.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(l,n)}i((v=v.apply(u,d||[])).next())}))}function U(e,t,l){const n=(i=l)?{XDPI:i,YDPI:i}:function(){const e={XDPI:null,YDPI:null},t=window.screen;if(null==t?void 0:t.XDPI)e.XDPI=null==t?void 0:t.deviceXDPI,e.YDPI=null==t?void 0:t.deviceYDPI;else{const t=document.createElement("div");t.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e.XDPI=t.offsetWidth,e.YDPI=t.offsetHeight,t.parentNode.removeChild(t)}return e}();var i;return e/(t?n.XDPI:n.YDPI)*2.54/100}const{useState:F,useEffect:B,useRef:$}=e.React,G=l=>{var o,a,r,s;const{jimuMapView:u,id:d,selectedTemplate:c,className:v}=l,p=t.hooks.useTranslate(m,t.defaultMessages),h=$(null),x=$(null),g=$(null),y=$(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.extent),b=$(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.scale),w=e.css`

  `,[j,O]=F(!1),[N,S]=F(null===(r=null==u?void 0:u.view)||void 0===r?void 0:r.extent),[I,T]=F(null===(s=null==u?void 0:u.view)||void 0===s?void 0:s.scale);B((()=>(g.current=e.lodash.debounce(P,400),(0,e.loadArcGISJSAPIModules)(["esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/Polygon","esri/geometry/Extent","esri/geometry/Point","esri/geometry/support/WKIDUnitConversion"]).then((e=>{h.current=e})),W)),[]),B((()=>{var e,t,l,n,i,o;const a=(null==c?void 0:c.templateId)!==(null===(e=x.current)||void 0===e?void 0:e.templateId),r=(null==c?void 0:c.printExtentType)!==(null===(t=x.current)||void 0===t?void 0:t.printExtentType),s=(null==c?void 0:c.outScale)!==(null===(l=x.current)||void 0===l?void 0:l.outScale),u=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.dpi)!==(null===(o=null===(i=x.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.dpi),d=M();x.current=c,j&&(a||r||s||d||u)&&g.current()}),[c]),B((()=>{j&&N&&g.current()}),[N,I]),B((()=>{var t,l;u?(C(),S((0,e.Immutable)(JSON.parse(JSON.stringify(null===(l=null===(t=null==u?void 0:u.view)||void 0===t?void 0:t.extent)||void 0===l?void 0:l.toJSON()))))):S(null)}),[u]);const M=()=>{var e,t,l,n,i,o;if(!f(null==c?void 0:c.layout))return!1;const a=(null===(e=null==c?void 0:c.exportOptions)||void 0===e?void 0:e.width)!==(null===(l=null===(t=x.current)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.width),r=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.height)!==(null===(o=null===(i=x.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.height);return a||r},C=()=>{var t,l;null===(t=null==u?void 0:u.view)||void 0===t||t.watch("extent",(t=>{const l=JSON.parse(JSON.stringify(t.toJSON()));S((0,e.Immutable)(l)),y.current=t})),null===(l=null==u?void 0:u.view)||void 0===l||l.watch("scale",(e=>{T(e),b.current=e}))},P=()=>{var e;const t=G(),l=new(0,h.current[1])((null===(e=x.current)||void 0===e?void 0:e.printExtentType)===n.CurrentMapExtent?E():L(),{type:"simple-fill",color:[0,216,237,.3],outline:{color:[0,0,0],width:"4px"}});t.graphics.removeAll(),t.graphics.add(l)},L=()=>{var e,t,l,i,o;const{mapFrameSize:a,mapFrameUnit:r,layout:s}=null===(e=x.current)||void 0===e?void 0:e.asMutable({deep:!0}),u=V(),d=R(r),c=h.current[2],v=f(s),p=null===(t=null==y?void 0:y.current)||void 0===t?void 0:t.center,m=(null===(l=x.current)||void 0===l?void 0:l.printExtentType)===n.SetMapScale?null===(i=x.current)||void 0===i?void 0:i.outScale:b.current,g=v?A():{width:a[0],height:a[1]},w={x:v?1:d.x/(null==u?void 0:u.x),y:v?1:d.y/(null==u?void 0:u.y)},j={x:g.width,y:g.height},O=(null==p?void 0:p.x)-(null==j?void 0:j.x)/2*m*(null==w?void 0:w.x),N=(null==p?void 0:p.y)-(null==j?void 0:j.y)/2*m*(null==w?void 0:w.y),S=(null==p?void 0:p.x)+(null==j?void 0:j.x)/2*m*(null==w?void 0:w.x),I=(null==p?void 0:p.y)+(null==j?void 0:j.y)/2*m*(null==w?void 0:w.y),T=[[O,N],[O,I],[S,I],[S,N],[O,N]],M=new c({spatialReference:null===(o=null==y?void 0:y.current)||void 0===o?void 0:o.spatialReference});return M.addRing(T),M},E=()=>{var t,l,n,i,o,a;const r=h.current[3],{mapFrameSize:s,layout:d,exportOptions:c}=null===(t=x.current)||void 0===t?void 0:t.asMutable({deep:!0}),v=f(d),p=h.current[2];let m=(0,e.Immutable)(null===(l=y.current)||void 0===l?void 0:l.toJSON());const g=(null===(n=null==u?void 0:u.view)||void 0===n?void 0:n.width)/(null===(i=null==u?void 0:u.view)||void 0===i?void 0:i.height),b=v?(null==c?void 0:c.width)/(null==c?void 0:c.height):s[0]/s[1],w=(null==m?void 0:m.height)||(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.height),j=(null==m?void 0:m.width)||(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.width);if(g>b){const e=j/b,t=k(!1,e/w);m=m.set("height",e).set("ymin",null==t?void 0:t.mim).set("ymax",null==t?void 0:t.max)}else if(g<b){const e=w*b,t=k(!0,e/j);m=m.set("width",e).set("xmin",null==t?void 0:t.mim).set("xmax",null==t?void 0:t.max)}const O=new r({xmax:null==m?void 0:m.xmax,xmin:null==m?void 0:m.xmin,ymax:null==m?void 0:m.ymax,ymin:null==m?void 0:m.ymin,zmax:null==m?void 0:m.zmax,zmin:null==m?void 0:m.zmin,spatialReference:null==m?void 0:m.spatialReference});return p.fromExtent(O)},k=(e,t)=>{var l,n;const i=null===(l=y.current)||void 0===l?void 0:l.toJSON(),o=null===(n=null==y?void 0:y.current)||void 0===n?void 0:n.center,a=(e?(null==i?void 0:i.xmax)-(null==i?void 0:i.xmin):(null==i?void 0:i.ymax)-(null==i?void 0:i.ymin))*t;return{max:e?(null==o?void 0:o.x)+a/2:(null==o?void 0:o.y)+a/2,mim:e?(null==o?void 0:o.x)-a/2:(null==o?void 0:o.y)-a/2}},A=()=>{var e;const{exportOptions:t}=null===(e=x.current)||void 0===e?void 0:e.asMutable({deep:!0}),l=V();return{width:U(null==t?void 0:t.width,!0,null==t?void 0:t.dpi)*(null==l?void 0:l.x),height:U(null==t?void 0:t.height,!1,null==t?void 0:t.dpi)*(null==l?void 0:l.y)}},R=e=>{switch(null==e?void 0:e.toUpperCase()){case i.Centimeter:return{x:.01,y:.01};case i.Inch:return{x:.0254,y:.0254};case i.Millimeter:return{x:.001,y:.001};case i.Point:return{x:.0254/72,y:.0254/72};default:return{x:NaN,y:NaN}}},V=()=>{var e;const t=h.current[5];let l,n;const i=null===(e=null==y?void 0:y.current)||void 0===e?void 0:e.spatialReference;i&&(l=i.wkid,n=i.wkt);let o=null;if(l)o=t.values[t[l]];else if(n&&-1!==n.search(/^PROJCS/i)){const e=/UNIT\[([^\]]+)\]\]$/i.exec(n);e&&e[1]&&(o=parseFloat(e[1].split(",")[1]))}return{x:o,y:o}},G=()=>{var e;let t=null;const l=h.current[0],n=z(d,u.id);return(null===(e=u.view)||void 0===e?void 0:e.map)&&(t=u.view.map.findLayerById(n),t||(t=new l({id:n,title:n}),u.view.map.add(t))),t},W=()=>{const e=z(d,u.id),t=u.view.map.findLayerById(e);t&&t.graphics.removeAll()};return(0,e.jsx)("div",{className:v,css:w},(0,e.jsx)(t.Button,{title:p("previewPrint"),className:"d-flex w-100 align-items-center checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{O(!j),j?W():P()}},(0,e.jsx)(t.Checkbox,{title:p("previewPrint"),className:"lock-item-ratio","data-field":"mapSize",checked:j}),(0,e.jsx)("div",{className:"text-left ml-2 text-truncate"},p("previewPrint"))))};var W=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};const _=new(0,e.esri.Sanitizer),{useState:D,useEffect:Z,useRef:J}=e.React,H=l=>{var i,o,a,r,s,u,d,c;const v=t.hooks.useTranslate(m,t.defaultMessages,e.defaultMessages),p=J(null),h=J(null),x=J(!1),y=e.css`
    padding-bottom: ${e.polished.rem(16)};
    padding-top: ${e.polished.rem(16)};
    .setting-con {
      overflow-y: auto;
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .print-button-con {
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .no-right-padding .jimu-interactive-node{
      padding-right: 0;
    }
    .scalebar-unit {
      width: ${e.polished.rem(160)};
    }
    .collapse-button {
      padding-right: 0;
    }
    .map-size-con input {
      width: 100%;
    }
    .wkid-describtion {
      font-size: ${e.polished.rem(12)};
      color: var(--dark-400);
    }
    .wkid-describtion-invalid {
      color: var(--danger-600)
    }
    .outscale-con, .dpi-con {
      input {
        border-right: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
      button {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        height: ${e.polished.rem(26)};
        svg {
          margin-right: 0;
        }
      }
    }
  `,{templateList:b,jimuMapView:O,selectedTemplate:N,id:I,confirmPrint:T,handleSelectedTemplateChange:C,setSelectedTemplateByIndex:P}=l,[k,A]=D((null===(i=null==N?void 0:N.layoutOptions)||void 0===i?void 0:i.titleText)||""),[R,z]=D((null==N?void 0:N.wkid)||""),[V,U]=D(null==N?void 0:N.outScale),[F,B]=D((null===(o=null==N?void 0:N.layoutOptions)||void 0===o?void 0:o.authorText)||""),[$,H]=D((null===(a=null==N?void 0:N.layoutOptions)||void 0===a?void 0:a.copyrightText)||""),[Q,K]=D(null===(r=null==N?void 0:N.layoutOptions)||void 0===r?void 0:r.customTextElements),[X,q]=e.React.useState(null===(s=null==N?void 0:N.exportOptions)||void 0===s?void 0:s.dpi),[Y,ee]=e.React.useState(null===(u=null==N?void 0:N.exportOptions)||void 0===u?void 0:u.width),[te,le]=e.React.useState(null===(d=null==N?void 0:N.exportOptions)||void 0===d?void 0:d.height),[ne,ie]=D(!1),[oe,ae]=e.React.useState(null),[re,se]=D(null);Z((()=>{var e,t,l,n,i,o,a,r;A((null===(e=null==N?void 0:N.layoutOptions)||void 0===e?void 0:e.titleText)||""),B((null===(t=null==N?void 0:N.layoutOptions)||void 0===t?void 0:t.authorText)||""),H((null===(l=null==N?void 0:N.layoutOptions)||void 0===l?void 0:l.copyrightText)||""),K(null===(n=null==N?void 0:N.layoutOptions)||void 0===n?void 0:n.customTextElements),z(null==N?void 0:N.wkid),p.current=null==N?void 0:N.wkid,U(null==N?void 0:N.outScale),q(null===(i=null==N?void 0:N.exportOptions)||void 0===i?void 0:i.dpi),ee(null===(o=null==N?void 0:N.exportOptions)||void 0===o?void 0:o.width),le(null===(a=null==N?void 0:N.exportOptions)||void 0===a?void 0:a.height),se(j(null===(r=null==N?void 0:N.layoutOptions)||void 0===r?void 0:r.elementOverrides)),Ve(ne),(null==N?void 0:N.wkidLabel)?ae(null==N?void 0:N.wkidLabel):h.current&&ue(null==N?void 0:N.wkid).then((e=>{ae(e)}))}),[N]);const ue=t=>W(void 0,void 0,void 0,(function*(){if(x.current){const{getSRLabel:e}=h.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{h.current=e,x.current=!0;const{getSRLabel:l}=h.current;return Promise.resolve(l(t))}))})),de=t=>W(void 0,void 0,void 0,(function*(){if(x.current){const{isValidWkid:e}=h.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{h.current=e,x.current=!0;const{isValidWkid:l}=h.current;return Promise.resolve(l(t))}))})),ce=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=g(null==b?void 0:b.asMutable({deep:!0}),l);P(n)},ve=(e,t)=>{const l=N.setIn(e,t);C(l)},pe=()=>{ve(["forceFeatureAttributes"],!(null==N?void 0:N.forceFeatureAttributes))},me=()=>{ve(["attributionVisible"],!(null==N?void 0:N.attributionVisible))},he=e=>W(void 0,void 0,void 0,(function*(){const e=ge()?[]:yield w(O);ve(["layoutOptions","legendLayers"],e)})),xe=()=>{var e,t,l;const n=null===(l=null===(t=null===(e=null==N?void 0:N.layoutOptions)||void 0===e?void 0:e.elementOverrides)||void 0===t?void 0:t[re])||void 0===l?void 0:l.visible;ve(["layoutOptions","elementOverrides",re,"visible"],!n)},ge=()=>{var e,t,l;return(null===(e=null==N?void 0:N.layoutOptions)||void 0===e?void 0:e.legendLayers)&&(null===(l=null===(t=null==N?void 0:N.layoutOptions)||void 0===t?void 0:t.legendLayers)||void 0===l?void 0:l.length)>0},fe=e=>{ve(["layoutOptions","titleText"],e)},ye=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;A(l)},be=e=>W(void 0,void 0,void 0,(function*(){if(!(yield de(e))){z(p.current);const e=yield ue(p.current);return ae(e),!1}p.current=e;const t=yield ue(e),l=N.set("wkid",e).set("wkidLabel",t);C(l)})),we=e=>W(void 0,void 0,void 0,(function*(){if(yield de(e)){const t=yield ue(e);ae(t)}else ae(v("uploadImageError"));z(e)})),je=e=>{ve(["outScale"],e)},Oe=()=>{var e;const t=null===(e=null==O?void 0:O.view)||void 0===e?void 0:e.scale;U(t),ve(["outScale"],t)},Ne=e=>{U(e)},Se=e=>{ve(["layoutOptions","authorText"],e)},Ie=e=>{if(e<1)return!1;q(parseInt(e))},Te=e=>{if(e<1)return!1;ve(["exportOptions","dpi"],parseInt(e))},Me=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;B(l)},Ce=e=>{ve(["layoutOptions","copyrightText"],e)},Pe=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;H(l)},Le=e=>{var t;if(!e||Number(e)<1)return ee(null===(t=null==N?void 0:N.exportOptions)||void 0===t?void 0:t.width),!1;ve(["exportOptions","width"],e)},Ee=e=>{ee(e)},ke=e=>{var t;if(!e||Number(e)<1)return le(null===(t=null==N?void 0:N.exportOptions)||void 0===t?void 0:t.height),!1;ve(["exportOptions","height"],e)},Ae=e=>{le(e)},Re=e=>{const t=e.target.value;ve(["format"],t)},ze=e=>{const t=e.target.value;ve(["layoutOptions","scalebarUnit"],t)},Ve=e=>{const t=$e(),{showOutputSpatialReference:l}=t;e&&l&&!(null==N?void 0:N.wkidLabel)&&W(void 0,void 0,void 0,(function*(){const e=yield ue(null==N?void 0:N.wkid);ae(e)}))},Ue=()=>{Ve(!ne),ie(!ne)},Fe=e=>{var t;if(e===n.SetMapScale){const l=null===(t=null==O?void 0:O.view)||void 0===t?void 0:t.scale;U(l),ve(["outScale"],l);const n=N.set("outScale",l).set("printExtentType",e);C(n)}else ve(["printExtentType"],e)},Be=e=>{if(h.current){const{isValidWkid:t}=h.current;return t(e)}return!0},$e=()=>{const e=f(null==N?void 0:N.layout),t=(null==N?void 0:N.hasAuthorText)&&(null==N?void 0:N.enableAuthor)&&!e,l=(null==N?void 0:N.hasCopyrightText)&&(null==N?void 0:N.enableCopyright)&&!e,n=(null==N?void 0:N.hasLegend)&&(null==N?void 0:N.enableLegend)&&!e,i=Ge()&&!e;return{showLayoutOption:t||l||n||i||(null==N?void 0:N.enableScalebarUnit),showAuthor:t,showCopyright:l,showLegend:n,showCustomTextElements:i,showTitle:null==N?void 0:N.enableTitle,showFeatureAttribution:null==N?void 0:N.enableFeatureAttribution,showMapAttribution:(null==N?void 0:N.enableMapAttribution)&&e,showQuality:null==N?void 0:N.enableQuality,showMapSize:(null==N?void 0:N.enableMapSize)&&e,showMapPrintExtents:null==N?void 0:N.enableMapPrintExtents,showScalebarUnit:(null==N?void 0:N.enableScalebarUnit)&&!e,showOutputSpatialReference:null==N?void 0:N.enableOutputSpatialReference,showNorthArrow:null==N?void 0:N.enableNorthArrow}},Ge=()=>{var e,t;const l=[];return null===(e=null==N?void 0:N.customTextElementEnableList)||void 0===e||e.forEach((e=>{for(const t in e)l.push(e[t])})),(null===(t=null==l?void 0:l.filter((e=>e)))||void 0===t?void 0:t.length)>0},We=()=>{const l=[];return null==Q||Q.forEach(((n,i)=>{var o,a;for(const r in n){if(!(null===(a=null===(o=null==N?void 0:N.customTextElementEnableList)||void 0===o?void 0:o[i])||void 0===a?void 0:a[r]))continue;const s=(0,e.jsx)(E,{flowWrap:!0,className:"align-item-center",label:r,key:`${r}_${i}`},(0,e.jsx)(t.TextInput,{size:"sm",className:"flex-grow-1",value:n[r]||"",onAcceptValue:e=>{_e(i,r,e)},onChange:e=>{De(i,r,e)},"aria-label":r}));l.push(s)}})),l},_e=(e,t,l)=>{const n=Q[e].set(t,l),i=null==Q?void 0:Q.asMutable({deep:!0});i.splice(e,1,n),ve(["layoutOptions","customTextElements"],i)},De=(t,l,n)=>{var i;const o=null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.value,a=Q[t].set(l,o),r=null==Q?void 0:Q.asMutable({deep:!0});r.splice(t,1,a),K((0,e.Immutable)(r))};return(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:y},(0,e.jsx)("div",{className:"flex-grow-1 w-100 setting-con"},(0,e.jsx)("div",{className:"w-100 h-100"},(()=>{var l,n,i;const o=$e(),{showTitle:a}=o;return(0,e.jsx)("div",{className:"base-setting-con"},a&&(0,e.jsx)(E,{flowWrap:!0,label:v("title")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100",value:k,"aria-label":v("title"),onAcceptValue:fe,onChange:ye})),(0,e.jsx)(E,{flowWrap:!0,label:v("template")},(0,e.jsx)(t.Select,{value:null==N?void 0:N.templateId,onChange:ce,size:"sm","aria-label":v("template")},null==b?void 0:b.map(((l,n)=>(0,e.jsx)(t.Option,{key:null==l?void 0:l.templateId,value:null==l?void 0:l.templateId,title:null==l?void 0:l.label},null==l?void 0:l.label))))),(null===(l=null==N?void 0:N.selectedFormatList)||void 0===l?void 0:l.length)>1&&(0,e.jsx)(E,{flowWrap:!0,label:v("fileFormat")},(0,e.jsx)(t.Select,{value:null===(n=null==N?void 0:N.format)||void 0===n?void 0:n.toLowerCase(),onChange:Re,size:"sm","aria-label":v("fileFormat")},null===(i=null==N?void 0:N.selectedFormatList)||void 0===i?void 0:i.map(((l,n)=>(0,e.jsx)(t.Option,{key:`format${n}`,value:l,title:l},l))))))})(),(0,e.jsx)("div",null,f(null==N?void 0:N.layout)&&(()=>{const l=$e(),{showMapSize:n}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:"mb-1"},v("width")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:Y,onAcceptValue:Le,onChange:Ee,showHandlers:!1,"aria-label":v("width")})),(0,e.jsx)("div",{className:"flex-grow-1 ml-2"},(0,e.jsx)("div",{className:"mb-1"},v("height")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:te,onAcceptValue:ke,onChange:Ae,showHandlers:!1,"aria-label":v("height")}))))})(),(()=>{const l=f(null==N?void 0:N.layout),i=$e(),{showLayoutOption:o,showFeatureAttribution:a,showMapAttribution:r,showQuality:s,showMapSize:u,showMapPrintExtents:d,showScalebarUnit:c,showOutputSpatialReference:p}=i,m=o||a||r||s||u||d||c||p;return(0,e.jsx)("div",null,m&&(0,e.jsx)("div",{className:"d-flex align-items-center",role:"group","aria-label":v("advance")},(0,e.jsx)("div",{className:"flex-grow-1"},v("advance")),(0,e.jsx)(t.Button,{className:"collapse-button",size:"sm",type:"tertiary",onClick:Ue,title:v("advance")},ne?(0,e.jsx)(M,null):(0,e.jsx)(S,null))),ne&&(0,e.jsx)("div",null,d&&(0,e.jsx)(E,{flowWrap:!0,label:v("mapPrintingExtents")},(0,e.jsx)(t.Button,{title:v("currentMapExtent"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con mt-1 checkbox-con",onClick:()=>{Fe(n.CurrentMapExtent)}},(0,e.jsx)(t.Radio,{title:v("currentMapExtent"),checked:(null==N?void 0:N.printExtentType)===n.CurrentMapExtent,className:"mr-2"})," ",v("currentMapExtent")),(0,e.jsx)(t.Button,{title:v("currentMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Fe(n.CurrentMapScale)}},(0,e.jsx)(t.Radio,{title:v("currentMapScale"),checked:(null==N?void 0:N.printExtentType)===n.CurrentMapScale,className:"mr-2"})," ",v("currentMapScale")),(0,e.jsx)(t.Button,{title:v("setMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Fe(n.SetMapScale)}},(0,e.jsx)(t.Radio,{title:v("setMapScale"),checked:(null==N?void 0:N.printExtentType)===n.SetMapScale,className:"mr-2"})," ",v("setMapScale")),(null==N?void 0:N.printExtentType)===n.SetMapScale&&(0,e.jsx)("div",{className:"w-100 d-flex align-items-center outscale-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 dpi-input no-right-padding",value:V,onAcceptValue:je,onChange:Ne,showHandlers:!1,"aria-label":v("setMapScale")}),(0,e.jsx)(t.Button,{size:"sm",onClick:Oe,title:v("useCurrentScale")},(0,e.jsx)(L,null)))),p&&(0,e.jsx)(E,{flowWrap:!0,label:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:_.sanitize(v("spatialReference",{WKID:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}})},(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 dpi-input no-right-padding",value:R,onAcceptValue:be,onChange:we,showHandlers:!1,"aria-label":v("spatialReference",{WKID:""})}),(0,e.jsx)("div",{title:oe,"aria-label":oe,className:(0,e.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!Be(Number(R))})},oe)),!l&&(()=>{var l,n,i,o;const a=$e(),{showAuthor:r,showCopyright:s,showLegend:u,showLayoutOption:d,showFeatureAttribution:c,showQuality:p,showScalebarUnit:m,showNorthArrow:h}=a;return(0,e.jsx)("div",null,d&&(0,e.jsx)("div",{className:"mb-2"},v("LayoutOptions")),r&&(0,e.jsx)(E,{flowWrap:!0,label:v("printAuyhor")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:F,onAcceptValue:Se,onChange:Me,"aria-label":v("printAuyhor")})),s&&(0,e.jsx)(E,{flowWrap:!0,label:v("printCopyright")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:$,onAcceptValue:Ce,onChange:Pe,"aria-label":v("printCopyright")})),We(),u&&(0,e.jsx)(E,null,(0,e.jsx)(t.Button,{title:v("includeLegend"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:he},(0,e.jsx)(t.Checkbox,{title:v("includeLegend"),className:"lock-item-ratio",checked:ge()}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeLegend")))),h&&(0,e.jsx)(E,null,(0,e.jsx)(t.Button,{title:v("includeNorthArrow"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:xe},(0,e.jsx)(t.Checkbox,{title:v("includeNorthArrow"),className:"lock-item-ratio",checked:null===(i=null===(n=null===(l=null==N?void 0:N.layoutOptions)||void 0===l?void 0:l.elementOverrides)||void 0===n?void 0:n[re])||void 0===i?void 0:i.visible}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeNorthArrow")))),m&&(0,e.jsx)(E,{label:v("scaleBarUnit"),flowWrap:!1},(0,e.jsx)(t.Select,{value:null===(o=null==N?void 0:N.layoutOptions)||void 0===o?void 0:o.scalebarUnit,onChange:ze,size:"sm",className:"scalebar-unit","aria-label":v("scaleBarUnit")},function(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}(v).map(((l,n)=>(0,e.jsx)(t.Option,{key:`unit${n}`,value:l.value,title:l.label},l.label))))),p&&(0,e.jsx)(E,{label:v("printQuality"),flowWrap:!0},(0,e.jsx)("div",{className:"d-flex align-items-center w-100 dpi-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 no-right-padding",value:X,onAcceptValue:Te,onChange:Ie,showHandlers:!1,"aria-label":v("printQuality")}),(0,e.jsx)(t.Button,{disabled:!0,size:"sm",title:"DPI"},"DPI"))),c&&(0,e.jsx)(E,null,(0,e.jsx)(t.Button,{title:v("includeAttributes"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:pe},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==N?void 0:N.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))))})(),l&&(()=>{const l=$e(),{showFeatureAttribution:n,showMapAttribution:i,showQuality:o}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)(E,{className:"mb-1"},(0,e.jsx)(t.Button,{title:v("includeAttributes"),className:"w-100 align-items-center mt-1 d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:pe},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==N?void 0:N.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))),i&&(0,e.jsx)(E,null,(0,e.jsx)(t.Button,{title:v("includeAttribution"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:me},(0,e.jsx)(t.Checkbox,{title:v("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:null==N?void 0:N.attributionVisible}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttribution")))),o&&(0,e.jsx)(E,{flowWrap:!0,label:v("printQuality")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 no-right-padding",value:X,onAcceptValue:Te,onChange:Ie,suffix:(0,e.jsx)(t.Button,{disabled:!0,size:"sm"},"DPI")})))})()))})()))),(0,e.jsx)("div",{className:"print-button-con"},(0,e.jsx)(G,{id:I,jimuMapView:O,className:"w-100",scale:V,selectedTemplate:N,scalebarUnit:null===(c=null==N?void 0:N.layoutOptions)||void 0===c?void 0:c.scalebarUnit,printExtentType:null==N?void 0:N.printExtentType}),(0,e.jsx)(t.Button,{className:"w-100 mt-2",type:"primary",onClick:()=>{T(N)}},v("_widgetLabel"))))};var Q=o(55339),K=o.n(Q);const X=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:K()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var q=o(51513),Y=o.n(q);const ee=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:Y()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var te=o(94539),le=o.n(te);const ne=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:le()},i)):e.React.createElement("svg",Object.assign({className:o},i))},ie=l=>{const n=t.hooks.useTranslate(m,t.defaultMessages),i=e.css`
    & {
      overflow: auto;
      padding: ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)};
    }
    button {
      padding-left: 0;
      padding-right: 0;
    }
    a {
      padding: 0;
    }
    .print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `,{printResultList:o,deleteResultItem:a}=l;return(0,e.jsx)("div",{className:"w-100 h-100",css:i},0===(null==o?void 0:o.length)&&(0,e.jsx)("div",null,n("resultEmptyMessage")),o.map(((l,i)=>(0,e.jsx)("div",{className:"d-flex align-items-center mb-2 w-100",key:null==l?void 0:l.resultId},(0,e.jsx)(t.Button,{href:null==l?void 0:l.url,disabled:!(null==l?void 0:l.url),target:"_blank",size:"sm","aria-label":null==l?void 0:l.title,title:(null==l?void 0:l.state)!==c.Error?null==l?void 0:l.title:"",type:"tertiary",className:(0,e.classNames)("flex-grow-1 d-flex align-items-center",{"error-link":(null==l?void 0:l.state)===c.Error})},(t=>{switch(t.state){case c.Loading:return(0,e.jsx)("div",{className:"print-loading-con"});case c.Success:return(0,e.jsx)(ee,null);case c.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(ne,null))}})(l),(0,e.jsx)("div",{className:"ml-2",title:(null==l?void 0:l.state)===c.Error?null==l?void 0:l.title:""},null==l?void 0:l.title)),(0,e.jsx)(t.Button,{size:"sm",type:"tertiary",onClick:()=>{a(i)},title:n("remove")},(0,e.jsx)(X,null))))))};const oe=e=>{return t=void 0,n=void 0,o=function*(){const{mapView:t,printTemplateProperties:n,useUtility:i}=e;return b(i).then((e=>(0,l.loadArcGISJSAPIModules)(["esri/rest/support/PrintParameters","esri/rest/support/PrintTemplate","esri/rest/print","esri/geometry/SpatialReference"]).then((l=>{var i;const[o,a,r,s]=l,u=new a(n),d=function(e){var t,l;return e.layerViews.items=null===(l=null===(t=null==e?void 0:e.layerViews)||void 0===t?void 0:t.items)||void 0===l?void 0:l.map((e=>{var t,l,n,i,o,a,r;return(null===(l=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.id)||void 0===l?void 0:l.includes("jimu-draw-layer-"))||(null===(i=null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.id)||void 0===i?void 0:i.includes("bookmark-layer-"))?(e.graphicsView.graphics.items=null===(r=null===(a=null===(o=null==e?void 0:e.graphicsView)||void 0===o?void 0:o.graphics)||void 0===a?void 0:a.items)||void 0===r?void 0:r.map((e=>{var t;return(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.jimuDrawId)?(e.geometry.hasZ=!1,e):e})),e):e})),e}(t),c={view:d,template:u};n.wkid!==(null===(i=null==t?void 0:t.spatialReference)||void 0===i?void 0:i.wkid)&&(c.outSpatialReference=new s({wkid:n.wkid}));const v=new o(c);return r.execute(e,v).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))}))))},new((i=void 0)||(i=Promise))((function(e,l){function a(e){try{s(o.next(e))}catch(e){l(e)}}function r(e){try{s(o.throw(e))}catch(e){l(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(t,n||[])).next())}));var t,n,i,o};const{useState:ae,useRef:re,useEffect:se}=e.React;var ue;!function(e){e.PrintTemplate="PRINT TEMPLATE",e.PrintResult="PRINT RESULT"}(ue||(ue={}));const de=l=>{const n=t.hooks.useTranslate(m,t.defaultMessages),i=re([]),o=re([]),a=re(null),r=e.css`
    .classic-setting-con {
      height: 0;
    }
    .nav-bar-con {
      height: ${e.polished.rem(40)};
      border: none !important;
      border-bottom: 1px solid var(--light-200) !important;
      padding: 0;
      .navbar-nav button.nav-link, .navbar-nav button.nav-link:hover {
        color: var(--dark-800);
      }
      .jimu-nav-link-wrapper .jimu-badge-wrapper {
        & {
          display: block;
        }
        .badge-dot {
          top: ${e.polished.rem(4)};
          right: ${e.polished.rem(4)};
        }
      }
    }
  `,{config:s,jimuMapView:u,templateList:d,id:v}=l,[p,h]=ae(ue.PrintTemplate),[f,b]=ae((0,e.Immutable)([])),[w,j]=ae(null);se((()=>{I(0)}),[]),se((()=>{var e;if(w&&y(d,null==w?void 0:w.templateId)){const t=g(null==d?void 0:d.asMutable({deep:!0}),null==w?void 0:w.templateId),l=null===(e=T(null==d?void 0:d[t]))||void 0===e?void 0:e.asMutable({deep:!0});O(l)}w&&y(d,null==w?void 0:w.templateId)||I(0)}),[d,s]);const O=t=>{var l,n;const i=null===(l=a.current)||void 0===l?void 0:l.asMutable({deep:!0}),o=N(null===(n=a.current)||void 0===n?void 0:n.asMutable({deep:!0}),t);for(const e in i)e.includes("enable")&&delete i[e];null==o||o.forEach((e=>{if(e instanceof Array){const t=i[e[0]];delete t[e[1]],i[e[0]]=t}else delete i[e]})),i.layoutOptions=Object.assign(Object.assign({},null==t?void 0:t.layoutOptions),null==i?void 0:i.layoutOptions),i.exportOptions=Object.assign(Object.assign({},null==t?void 0:t.exportOptions),null==i?void 0:i.exportOptions),i.customTextElementEnableList=null==t?void 0:t.customTextElementEnableList,i.selectedFormatList=null==t?void 0:t.selectedFormatList;const r=(0,e.Immutable)(Object.assign(Object.assign({},t),i));M(r)},N=(e,t)=>{if(!e||!t)return[];const l=[];for(const n in e){const i=e[n]instanceof Object;if(i||e[n]===t[n]||l.push(n),i){const i=S(e[n],t[n]);null==i||i.forEach((e=>{l.push([n,e])}))}}return l},S=(e,t)=>{if(!e||!t)return null;const l=[];for(const n in e)(null==e?void 0:e[n])!==(null==t?void 0:t[n])&&l.push(n);return l},I=e=>{if(0===(null==d?void 0:d.length))return!1;const t=T(null==d?void 0:d[e]);a.current=t,M(t)},T=t=>t?t=(null==t?void 0:t.overrideCommonSetting)?x((0,e.Immutable)(null==s?void 0:s.commonSetting),(0,e.Immutable)(t)):x((0,e.Immutable)(t),(0,e.Immutable)(null==s?void 0:s.commonSetting)):null,M=e=>{j(e)},C=t=>{h(t),t===ue.PrintResult&&(o.current=(0,e.Immutable)(i.current).asMutable())},P=e=>{const t=z(v,u.id),l=u.view.map.findLayerById(t);l&&(l.visible=e)},L=(t,l,n)=>{let o;n&&(t.url=n),t.state=l;const a=i.current;a.forEach(((e,l)=>{e.resultId===t.resultId&&(o=l)})),(o||0===o)&&(a.splice(o,1,t),b((0,e.Immutable)(a)),i.current=a)};return(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:r},(0,e.jsx)(t.Navbar,{className:"nav-bar-con w-100",border:!1,color:"false",light:!0},(0,e.jsx)(t.Nav,{className:"w-100 h-100",underline:!0,navbar:!0,justified:!0,fill:!0},(0,e.jsx)(t.NavItem,{title:n("printTemplate"),onClick:()=>{C(ue.PrintTemplate)},className:"link-con"},(0,e.jsx)(t.NavLink,{tag:"button",active:p===ue.PrintTemplate},n("printTemplate"))),(0,e.jsx)(t.NavItem,{title:n("printResult"),onClick:()=>{C(ue.PrintResult)}},(0,e.jsx)(t.NavLink,{tag:"button",active:p===ue.PrintResult},(0,e.jsx)(t.Badge,{className:"w-100 h-100",dot:!0,color:"primary",hideBadge:(null===(E=null==i?void 0:i.current)||void 0===E?void 0:E.length)===(null===(R=null==o?void 0:o.current)||void 0===R?void 0:R.length)},n("printResult")))))),(0,e.jsx)("div",{className:"flex-grow-1 w-100 classic-setting-con overflow-hidden"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":p!==ue.PrintTemplate})},(0,e.jsx)(H,{id:v,config:s,jimuMapView:u,selectedTemplate:w,templateList:d,confirmPrint:t=>{return l=void 0,n=void 0,a=function*(){var l;const n={resultId:A((0,e.Immutable)(i.current)),url:null,title:k(null===(l=null==t?void 0:t.layoutOptions)||void 0===l?void 0:l.titleText,(0,e.Immutable)(i.current)),state:c.Loading},o=i.current;o.push(n),i.current=o,b((0,e.Immutable)(o)),P(!1),oe({useUtility:null==s?void 0:s.useUtility,mapView:null==u?void 0:u.view,printTemplateProperties:yield V(t,u)}).then((e=>{P(!0),L(n,c.Success,null==e?void 0:e.url)}),(e=>{P(!0),L(n,c.Error)}))},new((o=void 0)||(o=Promise))((function(e,t){function i(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof o?l:new o((function(e){e(l)}))).then(i,r)}s((a=a.apply(l,n||[])).next())}));var l,n,o,a},handleSelectedTemplateChange:M,setSelectedTemplateByIndex:I})),p===ue.PrintResult&&(0,e.jsx)(ie,{config:s,printResultList:f,deleteResultItem:t=>{var l,n;const a=i.current;a.splice(t,1),b((0,e.Immutable)(a)),i.current=null===(l=(0,e.Immutable)(a))||void 0===l?void 0:l.asMutable({deep:!0}),o.current=null===(n=(0,e.Immutable)(a))||void 0===n?void 0:n.asMutable({deep:!0})}})));var E,R};const ce=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:p()},i)):e.React.createElement("svg",Object.assign({className:o},i))},ve=t=>{const l=e.css`
    &.print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
  `;return(0,e.jsx)("div",{css:l,className:"print-loading-con"})},pe=l=>{const n=t.hooks.useTranslate(m,t.defaultMessages),{prinResult:i,restPrint:o}=l,a=e.css`
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `;return(0,e.jsx)("div",{className:"d-flex flex-column h-100 w-100",css:a},(0,e.jsx)(t.Button,{href:null==i?void 0:i.url,disabled:!(null==i?void 0:i.url),target:"_blank",size:"sm","aria-label":null==i?void 0:i.title,title:null==i?void 0:i.title,type:"tertiary",className:(0,e.classNames)("d-flex align-items-center",{"error-link":(null==i?void 0:i.state)===c.Error})},(()=>{switch(null==i?void 0:i.state){case c.Loading:return(0,e.jsx)(ve,null);case c.Success:return(0,e.jsx)(ee,null);case c.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(ne,null))}})(),(0,e.jsx)("div",{className:"ml-2"},null==i?void 0:i.title)),(0,e.jsx)("div",{className:"flex-grow-1 d-flex align-items-end"},(0,e.jsx)("div",{className:"flex-grow-1"}),(0,e.jsx)(t.Button,{type:"primary",onClick:o},n("reset"))))};const{useState:me,useRef:he,useEffect:xe}=e.React,{useSelector:ge}=e.ReactRedux,fe=l=>{var n,i;const{config:o,templateList:a,jimuMapView:r,errorTip:s,id:u}=l,d=t.hooks.useTranslate(m,t.defaultMessages),v=he(null),p=ge((e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.appConfig)||void 0===t?void 0:t.widgets)||void 0===l?void 0:l[u]})),h=e.css`
    .compact-con {
      padding: 0;
      svg {
        margin: 0 auto;
      }
      .compact-icon {
        color: ${null===(i=null===(n=null==p?void 0:p.icon)||void 0===n?void 0:n.properties)||void 0===i?void 0:i.color};
      }
    }
  `,f=e.css`
    & {
      padding: ${e.polished.rem(12)};
      width: ${e.polished.rem(320)};
      height: ${e.polished.rem(155)};
    }
    .close-con button{
      padding: 0;
    }
    .result-list-con button {
      padding: 0;
    }
    .compact-preview-con {
      width: 0;
    }
  `,b=[{name:"preventOverflow",options:{altAxis:!0}},(0,t.getFallbackPlacementsModifier)(["left-start","left-end"],!0)],[w,j]=me(!1),[O,N]=me(!1),[S,I]=me(null),[T,M]=me(null);xe((()=>{C(0)}),[]),xe((()=>{if(T&&y(a,null==T?void 0:T.templateId)||C(0),T&&y(a,null==T?void 0:T.templateId)){const e=g(null==a?void 0:a.asMutable({deep:!0}),null==T?void 0:T.templateId);C(e)}}),[a,o]);const C=e=>{if(0===(null==a?void 0:a.length))return!1;let t=null==a?void 0:a[e];t=(null==t?void 0:t.overrideCommonSetting)?x(null==o?void 0:o.commonSetting,t):x(t,null==o?void 0:o.commonSetting),M(t)},P=()=>{j(!w)},L=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=g(null==a?void 0:a.asMutable({deep:!0}),l);C(n)},k=e=>{const t=z(u,r.id),l=r.view.map.findLayerById(t);l&&(l.visible=e)},A=()=>{return t=void 0,l=void 0,i=function*(){var t;const l={resultId:null==T?void 0:T.templateId,url:null,title:null===(t=null==T?void 0:T.layoutOptions)||void 0===t?void 0:t.titleText,state:c.Loading};I((0,e.Immutable)(l)),N(!O),k(!1),oe({useUtility:null==o?void 0:o.useUtility,mapView:null==r?void 0:r.view,printTemplateProperties:yield V(T,r)}).then((t=>{l.url=null==t?void 0:t.url,l.state=c.Success,k(!0),I((0,e.Immutable)(l))}),(t=>{k(!0),l.state=c.Error,I((0,e.Immutable)(l))}))},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i},R=()=>!r||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:"w-100 h-100",css:h},(0,e.jsx)(t.Button,{className:"w-100 h-100 compact-con",type:"tertiary",ref:v,title:d("_widgetLabel"),onClick:P},(()=>{const l=null==p?void 0:p.icon;return l?"string"==typeof l?(0,e.jsx)(t.SVG,{src:l}):(0,e.jsx)(t.Icon,{className:"compact-icon",icon:null==l?void 0:l.svg}):(0,e.jsx)(ce,null)})()),(0,e.jsx)(t.Popper,{open:w,disableResize:!0,placement:"bottom",reference:v,modifiers:b,showArrow:!0,toggle:P,trapFocus:!1,autoFocus:!1,css:f},!R()&&(0,e.jsx)("div",{className:"d-flex flex-column w-100 h-100"},(0,e.jsx)("div",{className:"text-right close-con"},(0,e.jsx)(t.Button,{className:"print-button",type:"tertiary",title:d("closeTour"),onClick:P},(0,e.jsx)(X,null))),(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":O})},(()=>{var l;return(0,e.jsx)("div",{className:"d-flex flex-column"},(0,e.jsx)(E,{flowWrap:!0,className:"flex-grow-1",label:d("template")},(0,e.jsx)(t.Select,{value:null==T?void 0:T.templateId,onChange:L,size:"sm",className:"scalebar-unit","aria-label":d("template")},null==a?void 0:a.map(((l,n)=>(0,e.jsx)(t.Option,{key:l.templateId,value:l.templateId,title:l.label},l.label))))),(0,e.jsx)("div",{className:"print-button-con d-flex align-items-center mt-2"},(0,e.jsx)(G,{className:"flex-grow-1 compact-preview-con",id:u,jimuMapView:r,scale:null==T?void 0:T.outScale,selectedTemplate:T,scalebarUnit:null===(l=null==T?void 0:T.layoutOptions)||void 0===l?void 0:l.scalebarUnit,printExtentType:null==T?void 0:T.printExtentType}),(0,e.jsx)(t.Button,{className:"print-button text-truncate ml-1",type:"primary",onClick:A,title:d("_widgetLabel")},d("_widgetLabel"))))})()),O&&(0,e.jsx)(pe,{prinResult:S,restPrint:()=>{I(null),N(!1)}}))),R()&&(0,e.jsx)("div",null,s)))};function ye(t){const l={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[n]=e;return n(t,l).then((e=>function(e){return t=this,l=void 0,i=function*(){let t=!1,l=!1;const n=(null==e?void 0:e.parameters)||[];let i=[],o=[],a="png32";return null==n||n.forEach((e=>{var n,r;if("Layout_Template"===e.name){const t=e.choiceList,l=e.defaultValue;t?i=null==t?void 0:t.map((e=>be(e))):i.push(be(l))}if("Format"===e.name){const t=null===(n=null==e?void 0:e.choiceList)||void 0===n?void 0:n.map((e=>null==e?void 0:e.toLowerCase()));a=null===(r=e.defaultValue)||void 0===r?void 0:r.toLowerCase(),o=t||[a]}"string"==typeof e.name&&"web_map_as_json"===e.name.toLowerCase()&&(t=!0),"string"==typeof e.name&&"output_file"===e.name.toLowerCase()&&(l=!0)})),Promise.resolve({templates:i,formatList:o,defaultFormat:a,hasWebmapParam:t,hasOutputParam:l})},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i}(null==e?void 0:e.data)))}))}function be(e){const t=f(e)?{}:{layoutOptions:{legend:!1}};return Object.assign({label:e,layout:e,format:"PNG32"},t)}const we=(t,l,n)=>{const i=Se(null==l?void 0:l.utilityId);return ye(t).then((o=>{let a=n;const s=(null==o?void 0:o.templates)?((t,l,n)=>((e,t,l)=>{const n=((e,t)=>e===u.Customize||t===d.Customize?"custom":"org")(t,l);return e.map(((e,t)=>(e.templateId=`config_${n}_${t}`,e)))})(t.map((t=>{var l;let n=(0,e.Immutable)(t);return n=n.set("layout",null==t?void 0:t.layout),n=n.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],[]),f(null==n?void 0:n.layout)&&(n=n.set("exportOptions",Object.assign({width:800,height:1100},null==t?void 0:t.exportOptions))),null===(l=x((0,e.Immutable)(r),(0,e.Immutable)(n)))||void 0===l?void 0:l.asMutable({deep:!0})})),l,n))(null==o?void 0:o.templates,i,null==n?void 0:n.printTemplateType):[],c=null==s?void 0:s.map((e=>{var t;return(null==e?void 0:e.layout)&&(e.layout=null==e?void 0:e.layout),(null==e?void 0:e.format)&&(e.format=null===(t=null==e?void 0:e.format)||void 0===t?void 0:t.toLowerCase()),e}));return function(t){const l={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"};return function(t){var l;if(!t)return Promise.resolve(null);const n=`${null===(l=t.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,i={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,i).then((e=>{var t;const l=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks;let i=`${n}/Get Layout Templates Info Task/execute`;return null==l||l.forEach((e=>{(null==e?void 0:e.includes("Templates"))&&(null==e?void 0:e.includes("Info"))&&(i=`${n}/${e}/execute`)})),Promise.resolve(i)}))}))}(t).then((t=>(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[n]=e;return n(t,l).then((e=>{var t,l;return Promise.resolve((null===(l=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.results[0])||void 0===l?void 0:l.value)||[])}))}))))}(t).then((e=>{const t=je(e,c),n=Ne(null==o?void 0:o.templates,t);return a=a.set("printCustomTemplate",t).set("useUtility",l).set("formatList",null==o?void 0:o.formatList).set("defaultFormat",null==o?void 0:o.defaultFormat).set("layoutChoiceList",n),Promise.resolve(a)}))}))},je=(e,t)=>null==t?void 0:t.map((t=>{var l,n,i,o,a,r,s;let u;e.forEach((e=>{t.label===e.layoutTemplate&&(u=e)})),(null==u?void 0:u.webMapFrameSize)&&(t.mapFrameSize=null==u?void 0:u.webMapFrameSize,t.mapFrameUnit=null==u?void 0:u.pageUnits);const d=null===(n=null===(l=null==u?void 0:u.layoutOptions)||void 0===l?void 0:l.customTextElements)||void 0===n?void 0:n.map((e=>{const t={};for(const l in e)t[l]=!0;return t})),c=Oe(null==u?void 0:u.layoutOptions);return t.mapFrameUnit=null==u?void 0:u.pageUnits,t.hasAuthorText=null===(i=null==u?void 0:u.layoutOptions)||void 0===i?void 0:i.hasAuthorText,t.hasCopyrightText=null===(o=null==u?void 0:u.layoutOptions)||void 0===o?void 0:o.hasCopyrightText,t.hasLegend=null===(a=null==u?void 0:u.layoutOptions)||void 0===a?void 0:a.hasLegend,t.hasTitleText=null===(r=null==u?void 0:u.layoutOptions)||void 0===r?void 0:r.hasTitleText,t.selectedFormatList=[null==t?void 0:t.format],t.layoutOptions.customTextElements=(null===(s=null==u?void 0:u.layoutOptions)||void 0===s?void 0:s.customTextElements)||[],t.layoutOptions.elementOverrides=c,t.customTextElementEnableList=d||[],t.enableNorthArrow=!!j(c),t})),Oe=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],l=null==t?void 0:t.find((e=>"CIMMarkerNorthArrow"===e.type)),n={};return l&&(n[null==l?void 0:l.name]=l),(null==e?void 0:e.elementOverrides)||n},Ne=(e,t)=>(null==e?void 0:e.map((e=>(e.layoutTemplate=null==e?void 0:e.layout,null==t||t.forEach((t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText)})),e))))||[],Se=t=>{const l=e.UtilityManager.getInstance().getUtilityJson(t);return"org"===(null==l?void 0:l.source)?u.OrganizationService:u.Customize};class Ie extends e.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.10.0",description:"update layoutChoiceList of old print widget",upgrader:t=>{return l=this,n=void 0,o=function*(){const l=null==t?void 0:t.useUtility,n=t=>{var l,n,i,o,a,r;let s=(0,e.Immutable)(t);if(null===(l=null==t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi){const e=Number(null===(n=null==t?void 0:t.exportOptions)||void 0===n?void 0:n.dpi);e<0?s=s.setIn(["exportOptions","dpi"],1):parseInt(e)!==e&&(s=s.setIn(["exportOptions","dpi"],parseInt(e)))}return(null===(i=null==t?void 0:t.exportOptions)||void 0===i?void 0:i.width)?Number(null===(o=null==t?void 0:t.exportOptions)||void 0===o?void 0:o.width)<1&&(s=s.setIn(["exportOptions","width"],800)):(null==t?void 0:t.layout)&&f(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","width"],800)),(null===(a=null==t?void 0:t.exportOptions)||void 0===a?void 0:a.height)?Number(null===(r=null==t?void 0:t.exportOptions)||void 0===r?void 0:r.height)<1&&(s=s.setIn(["exportOptions","height"],1100)):(null==t?void 0:t.layout)&&f(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","height"],1100)),null==s?void 0:s.asMutable({deep:!0})};if(t=(e=>{var t,l;return(null===(l=null===(t=null==e?void 0:e.commonSetting)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi)?e.setIn(["commonSetting"],n(e.commonSetting)):e})(t),l){const e=yield(s=l,u=t,i=void 0,o=void 0,a=void 0,r=function*(){return b(s).then((e=>we(e,s,u)))},new(a||(a=Promise))((function(e,t){function l(e){try{s(r.next(e))}catch(e){t(e)}}function n(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(l,n)}s((r=r.apply(i,o||[])).next())})));if(null==e?void 0:e.layoutChoiceList){const l=((e,t)=>{var l;const i=(null===(l=null==e?void 0:e.printCustomTemplate)||void 0===l?void 0:l.asMutable({deep:!0}))||[];return i?null==i?void 0:i.map((e=>{var l;if(null==e?void 0:e.mapFrameSize)return n(e);{const i=null===(l=null==t?void 0:t.filter((t=>(null==t?void 0:t.layout)===(null==e?void 0:e.layout))))||void 0===l?void 0:l[0],o={mapFrameSize:null==i?void 0:i.mapFrameSize,mapFrameUnit:null==i?void 0:i.mapFrameUnit,hasAuthorText:null==i?void 0:i.hasAuthorText,hasCopyrightText:null==i?void 0:i.hasCopyrightText,hasLegend:null==i?void 0:i.hasLegend,hasTitleText:null==i?void 0:i.hasTitleText};return Object.assign(Object.assign({},n(e)),o)}})):i})(t,null==e?void 0:e.layoutChoiceList);return t.setIn(["layoutChoiceList"],null==e?void 0:e.layoutChoiceList).set("printCustomTemplate",l)}return t}var i,o,a,r,s,u;return t},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(l,n||[])).next())}));var l,n,i,o}}]}}const Te=new Ie,{useState:Me,useRef:Ce,useEffect:Pe}=e.React,Le=n=>{const{id:i,config:o,dispatch:a,useMapWidgetIds:r,layoutId:c,layoutItemId:v}=n,h=t.hooks.useTranslate(m,t.defaultMessages),x=e.ReactRedux.useSelector((e=>{var t;const l=null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.selection;return!(!l||l.layoutId!==c||l.layoutItemId!==v)})),g=Ce(!1),f=e.css`
    .jimu-widget-placeholder {
      border: none;
    }
    &.classic {
      background: var(--white);
    }
    .checkbox-con:hover {
      color: var(--dark-800);
    }
  `;Pe((()=>{I()}),[x]),Pe((()=>{S()}),[o]);const[y,b]=Me(null),[w,j]=Me(h("printPleaceholder")),[O,N]=Me(null),S=()=>{var e,t;const l=(e=null==o?void 0:o.printServiceType,t=null==o?void 0:o.printTemplateType,e===u.Customize||t===d.Customize?null==o?void 0:o.printCustomTemplate:null==o?void 0:o.printOrgTemplate);N(l)},I=()=>{c&&i&&v&&!g.current&&x&&(a(e.appActions.widgetStatePropChange(i,"layoutInfo",{layoutId:c,layoutItemId:v})),g.current=!0)},T=()=>{let e=w;return y&&!(null==o?void 0:o.useUtility)&&(e=""),e},M=()=>!y||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{classic:(null==o?void 0:o.modeType)===s.Classic}),css:f},(0,e.jsx)("div",{className:"map"},(0,e.jsx)("div",null,(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:null==r?void 0:r[0],onActiveViewChange:e=>null==e||"2d"!==e.view.type?(j(h("chooseMapTip")),void b(null)):(r&&0!==(null==r?void 0:r.length)||j(h("printPleaceholder")),void b(e)),onViewGroupCreate:e=>{}}))),(null==o?void 0:o.modeType)===s.Classic&&(0,e.jsx)("div",{className:"w-100 h-100"},!M()&&(0,e.jsx)(de,{id:i,config:o,jimuMapView:y,templateList:O}),M()&&(0,e.jsx)(t.WidgetPlaceholder,{icon:p(),widgetId:i,message:T()})),(null==o?void 0:o.modeType)===s.Compact&&(0,e.jsx)("div",{className:"w-100 h-100"},(0,e.jsx)(fe,{id:i,config:o,jimuMapView:y,templateList:O,errorTip:T()})))};Le.versionManager=Te;const Ee=Le})(),a})())}}}));