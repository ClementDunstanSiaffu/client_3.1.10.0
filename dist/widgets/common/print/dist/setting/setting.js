System.register(["jimu-core","jimu-arcgis","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/basic/list-tree","jimu-ui/advanced/utility-selector"],(function(e,t){var l={},i={},n={},a={},o={},s={},r={};return{setters:[function(e){l.Immutable=e.Immutable,l.LayoutType=e.LayoutType,l.React=e.React,l.ReactRedux=e.ReactRedux,l.SupportedUtilityType=e.SupportedUtilityType,l.UtilityManager=e.UtilityManager,l.classNames=e.classNames,l.css=e.css,l.defaultMessages=e.defaultMessages,l.esri=e.esri,l.jsx=e.jsx,l.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,l.moduleLoader=e.moduleLoader,l.polished=e.polished},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.getAppConfigAction=e.getAppConfigAction},function(e){a.AlertPopup=e.AlertPopup,a.Button=e.Button,a.Checkbox=e.Checkbox,a.Icon=e.Icon,a.Loading=e.Loading,a.MultiSelect=e.MultiSelect,a.NumericInput=e.NumericInput,a.Option=e.Option,a.Radio=e.Radio,a.Select=e.Select,a.Switch=e.Switch,a.TextInput=e.TextInput,a.defaultMessages=e.defaultMessages,a.hooks=e.hooks},function(e){o.MapWidgetSelector=e.MapWidgetSelector,o.SettingCollapse=e.SettingCollapse,o.SettingRow=e.SettingRow,o.SettingSection=e.SettingSection,o.SidePopper=e.SidePopper},function(e){s.List=e.List,s.TreeItemActionType=e.TreeItemActionType},function(e){r.UtilitySelector=e.UtilitySelector}],execute:function(){e((()=>{var e={748:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5Zm-9 0a3.501 3.501 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5ZM15.5 11l-5 1-3 4-1-9.5 9 4.5Zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38-2.517.503Z" fill="#000"></path></svg>'},55339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z" fill="#000"></path></svg>'},59216:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.226 1.312c-.403-.404-1.044-.417-1.431-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431l-1.462-1.462Zm-8.113 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991-1.781.32Zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402 1.461 1.461Z" fill="#000"></path><path d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1h-13Z" fill="#000"></path></svg>'},34750:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5Z" fill="#000"></path></svg>'},27218:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8Z" fill="#000"></path></svg>'},79964:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2.125 14.334 14H1.667L8 2.125Zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47L7.118 1.653ZM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995Zm1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="#000"></path></svg>'},69797:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA4NyA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHdpZHRoPSI4NyIgaGVpZ2h0PSI2NCIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMyIgeT0iNTIiIHdpZHRoPSI4MSIgaGVpZ2h0PSI4IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04NCAyNUgzVjI5SDg0VjI1Wk00MyAzN0gzVjQxSDQzVjM3WiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iMTQiIHk9IjUiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MyIgeT0iNSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjMiIHk9IjE2IiB3aWR0aD0iODEiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMyIgeT0iMTYiIHdpZHRoPSI0MCIgaGVpZ2h0PSIxIiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},80941:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNDYiIHZpZXdCb3g9IjAgMCA4NyA0NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHk9IjE2IiB3aWR0aD0iODciIGhlaWdodD0iMzAiIGZpbGw9IiMyODI4MjgiLz4NCjxyZWN0IHg9IjQiIHk9IjIzIiB3aWR0aD0iNzkiIGhlaWdodD0iNiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iNCIgeT0iMzgiIHdpZHRoPSI0MCIgaGVpZ2h0PSIzIiBmaWxsPSIjNDQ0NDQ0Ii8+DQo8cmVjdCB4PSI2MyIgeT0iMzYiIHdpZHRoPSIyMCIgaGVpZ2h0PSI3IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzUyNTI1MiIvPg0KPC9zdmc+DQo="},26826:e=>{"use strict";e.exports=i},48891:e=>{"use strict";e.exports=l},23137:e=>{"use strict";e.exports=n},30726:e=>{"use strict";e.exports=a},77756:e=>{"use strict";e.exports=o},52785:e=>{"use strict";e.exports=r},59587:e=>{"use strict";e.exports=s}},t={};function u(l){var i=t[l];if(void 0!==i)return i.exports;var n=t[l]={exports:{}};return e[l](n,n.exports,u),n.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var l in t)u.o(t,l)&&!u.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var d={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(d),u.d(d,{default:()=>pe});var e=u(48891),t=u(26826),l=u(23137),i=u(30726),n=u(77756);var a,o;!function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(a||(a={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(o||(o={}));const s={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:a.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:102100,wkidLabel:"WGS_1984_Web_Mercator_Auxiliary_Sphere",enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var r,c,p,m;!function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(r||(r={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(c||(c={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(p||(p={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(m||(m={}));const v={printSource:"Source",selectMap:"Select a map widget with 2D data",printMode:"Mode",printClassic:"Classic",printCompact:"Compact",configurePrintTemplate:"Print template",printService:"Print service",useOrganizationDervice:"Use organization service",printCustomize:"Customize",printTemplate:"Print template",useOrganizationTemplate:"Use organization template",newPrintTemplate:"New print template",newTemplate:"New template",templateCommonSettings:"Template common settings",setDefaults:"Set defaults",printTitle:"Title",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",allowEditing:"Select settings that allow editing at runtime",wellKnownId:"Enter a well-known ID ({wkid})",includeAttribution:"Include attribution",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",fileFormat:"File format",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",overrideCommonSettings:"Override common settings",overrideSettingsTitle:"Are you sure you want to disable override settings?",overrideSettingsRemind:"You will lose the settings configured.",printTemplateAuthor:"Author",copyright:"Copyright",legend:"Legend",scaleBarUnit:"Scalebar unit",miles:"Miles",kilometers:"Kilometers",meters:"Meters",feet:"Feet",mapAttribution:"Map attribution",utilityPlaceholder:"Click the “Select utility” button to add utilities for further configurations.",featureAttributes:"Feature attributes",includeAttributes:"Include attributes",northArrow:"North arrow",includeNorthArrow:"Include north arrow"};var g=function(e,t,l,i){return new(l||(l=Promise))((function(n,a){function o(e){try{r(i.next(e))}catch(e){a(e)}}function s(e){try{r(i.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const h=(e,t)=>e===c.Customize||t===p.Customize?"custom":"org",x=(t,l)=>{let i=l;return(null==t?void 0:t.exportOptions)&&(i=i.set("exportOptions",Object.assign(Object.assign({},t.exportOptions||{}),(null==l?void 0:l.exportOptions)||{}))),(null==t?void 0:t.layoutOptions)&&(null==l?void 0:l.layoutOptions)&&(i=i.set("layoutOptions",Object.assign(Object.assign({},(null==t?void 0:t.layoutOptions)||{}),(null==l?void 0:l.layoutOptions)||{}))),(0,e.Immutable)(Object.assign(Object.assign({},t),i))},y=(e,t)=>{let l;return null==e||e.forEach(((e,i)=>{(null==e?void 0:e.templateId)===t&&(l=i)})),l},f=(e,t)=>e===c.Customize||t===p.Customize,b=e=>"map-only"===(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===l?void 0:l.toLowerCase()})(e);function w(e={}){var t;let l=null;for(const i in e)"CIMMarkerNorthArrow"===(null===(t=null==e?void 0:e[i])||void 0===t?void 0:t.type)&&(l=i);return l}var S=u(59587);const I=u(55339),j=t=>{const l=i.hooks.useTranslate(e.defaultMessages,i.defaultMessages),{className:n,config:a,activeTemplateId:o,showNewTemplateItem:s,handelActiveTemplateIdChange:r,handelTemplateListChange:u}=t,d={isItemFocused:(e,t)=>{const{itemJsons:[l,i]}=t.props;return o&&i.indexOf(l)===y(g,o)},overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:S.TreeItemActionType.RenderOverrideItem,children:[{name:S.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:S.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:S.TreeItemActionType.RenderOverrideItemBody,children:[{name:S.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:S.TreeItemActionType.RenderOverrideItemDragHandle},{name:S.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:S.TreeItemActionType.RenderOverrideItemTitle},{name:S.TreeItemActionType.RenderOverrideItemDetailToggle},{name:S.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})};e.React.useEffect((()=>{v((null==a?void 0:a.printTemplateType)===p.Customize||(null==a?void 0:a.printServiceType)===c.Customize),x()}),[a]);const[m,v]=e.React.useState((null==a?void 0:a.printTemplateType)===p.Customize||(null==a?void 0:a.printServiceType)===c.Customize),[g,h]=e.React.useState([]),x=()=>{var e,t;(null==a?void 0:a.printServiceType)===c.Customize||(null==a?void 0:a.printTemplateType)===p.Customize?h((null===(e=null==a?void 0:a.printCustomTemplate)||void 0===e?void 0:e.asMutable({deep:!0}))||[]):h((null===(t=null==a?void 0:a.printOrgTemplate)||void 0===t?void 0:t.asMutable({deep:!0}))||[])},f=e=>(null==a?void 0:a.printTemplateType)===p.Customize?[{label:l("deleteOption"),iconProps:()=>({icon:I,size:12}),action:()=>{(e=>{const t=g;null==t||t.splice(e,1),u(t),r(null)})(e)}}]:[];return(0,e.jsx)("div",{className:`w-100 mt-2 ${n||""}`},(0,e.jsx)(S.List,Object.assign({className:"w-100",itemsJson:Array.from(g).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${null==e?void 0:e.templateId}`,itemStateTitle:null==e?void 0:e.label,itemStateIcon:null,itemStateCommands:f(t)}))),dndEnabled:m,renderOverrideItemDetailToggle:()=>"",onUpdateItem:(e,t)=>{const{itemJsons:l}=t.props,[,i]=l,n=i.map((e=>e.itemStateDetailContent));r(null),u(n)},onClickItemBody:(e,t)=>{const{itemJsons:[l]}=t.props;r(l.itemKey)}},d)),s&&(0,e.jsx)(S.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:[{name:"......"}].map(((e,t)=>({itemStateDetailContent:"item",itemKey:"index",itemStateTitle:"......",itemStateCommands:[]}))),dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},d,{isItemFocused:()=>!0})))};function T(t){const l={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[i]=e;return i(t,l).then((e=>function(e){return t=this,l=void 0,n=function*(){let t=!1,l=!1;const i=(null==e?void 0:e.parameters)||[];let n=[],a=[],o="png32";return null==i||i.forEach((e=>{var i,s;if("Layout_Template"===e.name){const t=e.choiceList,l=e.defaultValue;t?n=null==t?void 0:t.map((e=>C(e))):n.push(C(l))}if("Format"===e.name){const t=null===(i=null==e?void 0:e.choiceList)||void 0===i?void 0:i.map((e=>null==e?void 0:e.toLowerCase()));o=null===(s=e.defaultValue)||void 0===s?void 0:s.toLowerCase(),a=t||[o]}"string"==typeof e.name&&"web_map_as_json"===e.name.toLowerCase()&&(t=!0),"string"==typeof e.name&&"output_file"===e.name.toLowerCase()&&(l=!0)})),Promise.resolve({templates:n,formatList:a,defaultFormat:o,hasWebmapParam:t,hasOutputParam:l})},new((i=void 0)||(i=Promise))((function(e,a){function o(e){try{r(n.next(e))}catch(e){a(e)}}function s(e){try{r(n.throw(e))}catch(e){a(e)}}function r(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(o,s)}r((n=n.apply(t,l||[])).next())}));var t,l,i,n}(null==e?void 0:e.data)))}))}function C(e){const t=b(e)?{}:{layoutOptions:{legend:!1}};return Object.assign({label:e,layout:e,format:"PNG32"},t)}var N=u(34750),O=u.n(N);const M=t=>{const l=window.SVG,{className:i}=t,n=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l}(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return l?e.React.createElement(l,Object.assign({className:a,src:O()},n)):e.React.createElement("svg",Object.assign({className:a},n))};var R=u(27218),k=u.n(R);const A=t=>{const l=window.SVG,{className:i}=t,n=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l}(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return l?e.React.createElement(l,Object.assign({className:a,src:k()},n)):e.React.createElement("svg",Object.assign({className:a},n))};var L=function(e,t,l,i){return new(l||(l=Promise))((function(n,a){function o(e){try{r(i.next(e))}catch(e){a(e)}}function s(e){try{r(i.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const P=u(59216),E=new(0,e.esri.Sanitizer),{useRef:z}=e.React;var B;!function(e){e.Title="TITLE",e.Extents="EXTENTS",e.SpatialReference="SPATIAL REFERENCE",e.Feature="FEATURE ATTRIBUTION",e.Quality="QUALITY"}(B||(B={}));const U=t=>{var l,o;const s=i.hooks.useTranslate(v,e.defaultMessages,i.defaultMessages),u=e.React.useRef(null),d=z(null),c=z(!1),p=e.css`
    .dpi-input .input-wrapper{
      padding-right: 0;
    }
    .radio-con {
      cursor: ponter;
    }
    .use-current-map-scale svg{
      margin: 0 auto;
    }
    .enable-setting-con .jimu-widget-setting--row-label{
      margin-bottom: 0;
    }
    .wkid-describtion {
      font-size: ${e.polished.rem(12)};
      color: var(--dark-400);
    }
    .wkid-describtion-invalid {
      color: var(--danger-600)
    }
  `,{printTemplateProperties:m,modeType:g,jimuMapView:h,handleTemplatePropertyChange:x}=t,[y,f]=e.React.useState(null),[b,w]=e.React.useState((null===(l=m.layoutOptions)||void 0===l?void 0:l.titleText)||""),[S,I]=e.React.useState(null==m?void 0:m.wkid),[j,T]=e.React.useState(null===(o=null==m?void 0:m.exportOptions)||void 0===o?void 0:o.dpi),[C,N]=e.React.useState(null==m?void 0:m.outScale),[O,M]=e.React.useState(null);e.React.useEffect((()=>{var e,t;w((null===(e=m.layoutOptions)||void 0===e?void 0:e.titleText)||""),I(null==m?void 0:m.wkid),u.current=null==m?void 0:m.wkid,T(null===(t=null==m?void 0:m.exportOptions)||void 0===t?void 0:t.dpi),N(null==m?void 0:m.outScale),(null==m?void 0:m.wkidLabel)?M(null==m?void 0:m.wkidLabel):d.current&&R(null==m?void 0:m.wkid).then((e=>{M(e)}))}),[m]);const R=t=>L(void 0,void 0,void 0,(function*(){if(c.current){const{getSRLabel:e}=d.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{d.current=e,c.current=!0;const{getSRLabel:l}=d.current;return Promise.resolve(l(t))}))})),k=t=>L(void 0,void 0,void 0,(function*(){if(c.current){const{isValidWkid:e}=d.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{d.current=e,c.current=!0;const{isValidWkid:l}=d.current;return Promise.resolve(l(t))}))})),U=e=>L(void 0,void 0,void 0,(function*(){if(e===B.SpatialReference&&!(null==m?void 0:m.wkidLabel)){const e=yield R(null==m?void 0:m.wkid);M(e)}f(e)})),Z=()=>{f(null)},D=e=>{var t;let l=m.setIn(["printExtentType"],e);const i=h?null===(t=null==h?void 0:h.view)||void 0===t?void 0:t.scale:36978595.474472;switch(e){case a.CurrentMapExtent:l=l.setIn(["scalePreserved"],!1);break;case a.CurrentMapScale:l=l.setIn(["scalePreserved"],!0);break;case a.SetMapScale:l=l.setIn(["scalePreserved"],!0),l=l.setIn(["outScale"],i)}x(l)},V=e=>{const t=m.setIn([e],!(null==m?void 0:m[e]));x(t)};return(0,e.jsx)("div",{css:p},(0,e.jsx)(n.SettingRow,{label:s("setDefaults"),flow:"wrap"}),(0,e.jsx)(n.SettingCollapse,{label:s("printTitle"),isOpen:y===B.Title,onRequestOpen:()=>{U(B.Title)},onRequestClose:Z,role:"group","aria-label":s("printTitle"),rightIcon:P,type:"primary",className:y===B.Title&&"active-collapse"},(0,e.jsx)(n.SettingRow,{className:"mt-2"},(0,e.jsx)(i.TextInput,{size:"sm",className:"search-placeholder w-100",placeholder:s("printTitle"),value:b,onAcceptValue:e=>{const t=m.setIn(["layoutOptions","titleText"],e);x(t)},onChange:e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;w(l)},"aria-label":s("printTitle")}))),(0,e.jsx)(n.SettingCollapse,{label:s("mapPrintingExtents"),isOpen:y===B.Extents,onRequestOpen:()=>{U(B.Extents)},onRequestClose:Z,role:"group","aria-label":s("mapPrintingExtents"),rightIcon:P,type:"primary",className:y===B.Extents&&"active-collapse"},(0,e.jsx)(n.SettingRow,{className:"mt-2"},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(i.Button,{title:s("currentMapExtent"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con",onClick:()=>{D(a.CurrentMapExtent)}},(0,e.jsx)(i.Radio,{title:s("currentMapExtent"),checked:(null==m?void 0:m.printExtentType)===a.CurrentMapExtent,className:"mr-2"})," ",s("currentMapExtent")),(0,e.jsx)(i.Button,{title:s("currentMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con",onClick:()=>{D(a.CurrentMapScale)}},(0,e.jsx)(i.Radio,{title:s("currentMapScale"),checked:(null==m?void 0:m.printExtentType)===a.CurrentMapScale,className:"mr-2"})," ",s("currentMapScale")),(0,e.jsx)(i.Button,{title:s("setMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con",onClick:()=>{D(a.SetMapScale)}},(0,e.jsx)(i.Radio,{title:s("setMapScale"),checked:(null==m?void 0:m.printExtentType)===a.SetMapScale,className:"mr-2"})," ",s("setMapScale")),(null==m?void 0:m.printExtentType)===a.SetMapScale&&(0,e.jsx)("div",{className:"d-flex mt-1 align-items-center"},(0,e.jsx)(i.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",value:C,onAcceptValue:e=>{const t=m.setIn(["outScale"],e);x(t)},onChange:e=>{N(e)},showHandlers:!1}),(0,e.jsx)(i.Button,{className:"use-current-map-scale",size:"sm",title:s("useCurrentScale"),disabled:!h,onClick:()=>{var e;if(!h)return;const t=null===(e=null==h?void 0:h.view)||void 0===e?void 0:e.scale,l=m.setIn(["outScale"],t);x(l)}},(0,e.jsx)(A,null)))))),(0,e.jsx)(n.SettingCollapse,{label:s("outputSpatialReference"),isOpen:y===B.SpatialReference,onRequestOpen:()=>{U(B.SpatialReference)},onRequestClose:Z,role:"group",type:"primary","aria-label":s("outputSpatialReference"),rightIcon:P,className:y===B.SpatialReference&&"active-collapse"},(0,e.jsx)(n.SettingRow,{flow:"wrap",label:(0,e.jsx)("div",{className:"flex-grow-1",dangerouslySetInnerHTML:{__html:E.sanitize(s("wellKnownId",{wkid:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}}),className:"mt-2"},(0,e.jsx)(i.NumericInput,{size:"sm",className:"search-placeholder w-100",value:S,onAcceptValue:e=>L(void 0,void 0,void 0,(function*(){if(!(yield k(e))){I(u.current);const t=yield R(e);return M(t),!1}u.current=e;const t=m.setIn(["wkid"],e).set("wkidLabel",O);x(t);const l=yield R(e);M(l)})),onChange:e=>L(void 0,void 0,void 0,(function*(){if(I(e),yield k(e)){const t=yield R(e);M(t)}else M(s("uploadImageError"))})),showHandlers:!1,"aria-label":s("outputSpatialReference")}),(0,e.jsx)("div",{className:(0,e.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!(e=>{if(d.current){const{isValidWkid:t}=d.current;return t(e)}return!0})(Number(S))}),title:O,"aria-label":O},O))),(0,e.jsx)(n.SettingCollapse,{label:s("printQuality"),isOpen:y===B.Quality,onRequestOpen:()=>{U(B.Quality)},onRequestClose:Z,role:"group","aria-label":s("printQuality"),type:"primary",rightIcon:P,className:y===B.Quality&&"active-collapse"},(0,e.jsx)(n.SettingRow,{className:"mt-2"},(0,e.jsx)("div",{className:"d-flex align-items-center w-100"},(0,e.jsx)(i.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",placeholder:s("printQuality"),value:j,onAcceptValue:e=>{if(e<1)return!1;const t=m.setIn(["exportOptions","dpi"],parseInt(e));x(t)},onChange:e=>{if(e<1)return!1;T(parseInt(e))},showHandlers:!1,"aria-label":s("printQuality")}),(0,e.jsx)(i.Button,{disabled:!0,size:"sm",title:"DPI"},"DPI")))),(0,e.jsx)(n.SettingCollapse,{label:s("featureAttributes"),isOpen:y===B.Feature,onRequestOpen:()=>{U(B.Feature)},onRequestClose:Z,role:"group",type:"primary","aria-label":s("featureAttributes"),rightIcon:P,className:y===B.Feature&&"active-collapse"},(0,e.jsx)(n.SettingRow,{className:"mt-2"},(0,e.jsx)(i.Button,{title:s("includeAttributes"),className:"d-flex w-100 align-items-center",type:"tertiary",style:{paddingLeft:0,paddingRight:0},"aria-label":s("includeAttributes"),onClick:()=>{V("forceFeatureAttributes")}},(0,e.jsx)(i.Checkbox,{title:s("includeAttributes"),className:"lock-item-ratio","data-field":"forceFeatureAttributes",checked:(null==m?void 0:m.forceFeatureAttributes)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("includeAttributes"))))),g===r.Classic&&(0,e.jsx)(n.SettingRow,{className:"mt-3 enable-setting-con",flow:"wrap",role:"group","aria-label":s("selectEditableSettings"),label:s("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(i.Button,{title:s("printTitle"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{(()=>{let e=m.setIn(["showLabels"],!(null==m?void 0:m.showLabels));e=e.setIn(["enableTitle"],!(null==m?void 0:m.enableTitle)),x(e)})()}},(0,e.jsx)(i.Checkbox,{title:s("printTitle"),className:"lock-item-ratio","data-field":"enableTitle",checked:(null==m?void 0:m.enableTitle)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("printTitle"))),(0,e.jsx)(i.Button,{title:s("mapPrintingExtents"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{V("enableMapPrintExtents")}},(0,e.jsx)(i.Checkbox,{title:s("mapPrintingExtents"),className:"lock-item-ratio","data-field":"enableMapPrintExtents",checked:(null==m?void 0:m.enableMapPrintExtents)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("mapPrintingExtents"))),(0,e.jsx)(i.Button,{title:s("outputSpatialReference"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{V("enableOutputSpatialReference")}},(0,e.jsx)(i.Checkbox,{title:s("outputSpatialReference"),className:"lock-item-ratio","data-field":"enableOutputSpatialReference",checked:(null==m?void 0:m.enableOutputSpatialReference)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("outputSpatialReference"))),(0,e.jsx)(i.Button,{title:s("printQuality"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{V("enableQuality")}},(0,e.jsx)(i.Checkbox,{title:s("printQuality"),className:"lock-item-ratio","data-field":"enableQuality",checked:(null==m?void 0:m.enableQuality)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("printQuality"))),(0,e.jsx)(i.Button,{title:s("featureAttributes"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{V("enableFeatureAttribution")}},(0,e.jsx)(i.Checkbox,{title:s("featureAttributes"),className:"lock-item-ratio","data-field":"enableFeatureAttribution",checked:(null==m?void 0:m.enableFeatureAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s("featureAttributes"))))))};var Z=u(79964),D=u.n(Z);const V=t=>{const l=window.SVG,{className:i}=t,n=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l}(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return l?e.React.createElement(l,Object.assign({className:a,src:D()},n)):e.React.createElement("svg",Object.assign({className:a},n))};const{useEffect:F,useState:H}=e.React,G=u(59216);var Q;!function(e){e.MapSize="MAP SIZE",e.Author="AUTHOR",e.Copyright="COPYRIGHT",e.Legend="LEGEND",e.ScaleBarUnit="SCALE BAR UNIT",e.AttributionVisible="ATTRIBUTION VISIBLE",e.CustomTextElements="CUSTOM TEXZT ELEMENTS",e.NorthArrow="NORTH ARROW"}(Q||(Q={}));const $=t=>{var l,a,o,s,u;const d=i.hooks.useTranslate(v,i.defaultMessages,e.defaultMessages),{id:c,isOpen:m,trigger:h,popperFocusNode:S,config:I,activeTemplateId:j,jimuMapView:T,toggle:C,handelTemplateListChange:N}=t;F((()=>{re()}),[I,j]);const[O,M]=H(null),[R,k]=H(null),[A,L]=H(null),[P,E]=H((null==O?void 0:O.label)||""),[z,B]=H(null===(l=null==O?void 0:O.exportOptions)||void 0===l?void 0:l.width),[Z,D]=H(null===(a=null==O?void 0:O.exportOptions)||void 0===a?void 0:a.height),[$,W]=H((null===(o=null==O?void 0:O.layoutOptions)||void 0===o?void 0:o.authorText)||""),[q,_]=H((null===(s=null==O?void 0:O.layoutOptions)||void 0===s?void 0:s.copyrightText)||""),[J,K]=H(null),[Y,X]=H(null===(u=null==O?void 0:O.layoutOptions)||void 0===u?void 0:u.customTextElements),[ee,te]=H(null),[le,ie]=H(!1),[ne,ae]=H(null);F((()=>{var e,t,l,i,n,a;ae(w(null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.elementOverrides)),E((null==O?void 0:O.label)||""),B(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.width),D(null===(l=null==O?void 0:O.exportOptions)||void 0===l?void 0:l.height),W((null===(i=null==O?void 0:O.layoutOptions)||void 0===i?void 0:i.authorText)||""),_((null===(n=null==O?void 0:O.layoutOptions)||void 0===n?void 0:n.copyrightText)||""),X(null===(a=null==O?void 0:O.layoutOptions)||void 0===a?void 0:a.customTextElements)}),[O]),F((()=>{se()}),[]),F((()=>{oe()&&se()}),[Y]);const oe=()=>{if(!Y)return!1;if((null==Y?void 0:Y.length)!==(null==ee?void 0:ee.length))return!0;{let e=!1;return null==Y||Y.forEach(((t,l)=>{for(const i in t)Object.prototype.hasOwnProperty.call(ee[l],i)||(e=!0)})),e}},se=()=>{const t=null==Y?void 0:Y.map(((e,t)=>{const l={};for(const t in e)l[t]=!1;return l}));te((0,e.Immutable)(t||[]))},re=()=>{const e=f(null==I?void 0:I.printServiceType,null==I?void 0:I.printTemplateType)?null==I?void 0:I.printCustomTemplate:null==I?void 0:I.printOrgTemplate,t=y(null==e?void 0:e.asMutable({deep:!0}),j);k(t),L(e),M((null==e?void 0:e[t])||null)},ue=(e,t)=>{const l=O.setIn(e,t),i=null==A?void 0:A.asMutable({deep:!0});i[R]=null==l?void 0:l.asMutable({deep:!0}),N(i)},de=e=>{if(!e)return E(null==O?void 0:O.label),!1;ue(["label"],e)},ce=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;E(l)},pe=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;W(l)},me=e=>{ue(["layoutOptions","authorText"],e)},ve=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;_(l)},ge=e=>{ue(["layoutOptions","copyrightText"],e)},he=e=>{ye(),K(e)},xe=()=>{ye(),K(null)},ye=()=>{const e=null==ee?void 0:ee.map((e=>{const t={};for(const l in e)t[l]=!1;return t}));te(e)},fe=e=>{const t=e.target.value;ue(["layoutOptions","scalebarUnit"],t)},be=t=>{var l,i,n,a;const o=t.target.value,s=null===(n=null===(i=null===(l=null==I?void 0:I.layoutChoiceList)||void 0===l?void 0:l.filter((e=>(null==e?void 0:e.layout)===o)))||void 0===i?void 0:i[0])||void 0===n?void 0:n.asMutable({deep:!0}),r={mapFrameSize:null==s?void 0:s.mapFrameSize,mapFrameUnit:null==s?void 0:s.mapFrameUnit,hasAuthorText:null==s?void 0:s.hasAuthorText,hasCopyrightText:null==s?void 0:s.hasCopyrightText,hasLegend:null==s?void 0:s.hasLegend,hasTitleText:null==s?void 0:s.hasTitleText,layout:o};let u=Object.assign(Object.assign({},null==O?void 0:O.asMutable({deep:!0})),r);b(null==s?void 0:s.layout)&&(u=null===(a=(0,e.Immutable)(u).setIn(["exportOptions","width"],800).setIn(["exportOptions","height"],1100))||void 0===a?void 0:a.asMutable({deep:!0}));const d=null==A?void 0:A.asMutable({deep:!0});d[R]=u,N(d)},we=e=>{ue([e],!(null==O?void 0:O[e]))},Se=()=>{const e=!(null==O?void 0:O.overrideCommonSetting);if(e){let t=O.setIn(["overrideCommonSetting"],e);t=x(t,null==I?void 0:I.commonSetting);const l=null==A?void 0:A.asMutable({deep:!0});l[R]=null==t?void 0:t.asMutable({deep:!0}),N(l)}else ue(["overrideCommonSetting"],e)},Ie=t=>{return l=void 0,i=void 0,a=function*(){const t=je()?[]:yield function(t){return g(this,void 0,void 0,(function*(){return(0,e.loadArcGISJSAPIModules)(["esri/rest/support/LegendLayer"]).then((e=>{var l,i,n,a;const[o]=e,s=null===(a=null===(n=null===(i=null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.map)||void 0===i?void 0:i.layers)||void 0===n?void 0:n.toArray())||void 0===a?void 0:a.map((e=>new o({layerId:null==e?void 0:e.id,title:null==e?void 0:e.title})));return Promise.resolve(s)}))}))}(T);ue(["layoutOptions","legendLayers"],t)},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{r(a.next(e))}catch(e){t(e)}}function s(e){try{r(a.throw(e))}catch(e){t(e)}}function r(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(o,s)}r((a=a.apply(l,i||[])).next())}));var l,i,n,a},je=()=>{var e,t,l;return(null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.legendLayers)&&(null===(l=null===(t=null==O?void 0:O.layoutOptions)||void 0===t?void 0:t.legendLayers)||void 0===l?void 0:l.length)>0},Te=(e,t)=>{const l=null==ee?void 0:ee.map(((l,i)=>{const n={};for(const a in l)n[a]=t===i&&a===e&&!ee[t][e];return n}));K(null),te(l)},Ce=(e,t)=>{var l,i;const n=null===(l=null==O?void 0:O.customTextElementEnableList)||void 0===l?void 0:l[t],a=n.set(e,!(null==n?void 0:n[e])),o=null===(i=null==O?void 0:O.customTextElementEnableList)||void 0===i?void 0:i.asMutable({deep:!0});o.splice(t,1,a),ue(["customTextElementEnableList"],o)},Ne=(e,t,l)=>{const i=Y[e].set(t,l),n=null==Y?void 0:Y.asMutable({deep:!0});n.splice(e,1,i),ue(["layoutOptions","customTextElements"],n)},Oe=(t,l,i)=>{var n;const a=null===(n=null==i?void 0:i.target)||void 0===n?void 0:n.value,o=Y[t].set(l,a),s=null==Y?void 0:Y.asMutable({deep:!0});s.splice(t,1,o),X((0,e.Immutable)(s))},Me=()=>{var e,t,l;const i=null===(l=null===(t=null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.elementOverrides)||void 0===t?void 0:t[ne])||void 0===l?void 0:l.visible;ue(["layoutOptions","elementOverrides",ne,"visible"],!i)},Re=(e,t,l)=>{if(0===(null==l?void 0:l.length))return!1;let i=O.set("selectedFormatList",l);(null==l?void 0:l.includes(i.format))||(i=i.set("format",l[0]));const n=null==A?void 0:A.asMutable({deep:!0});n[R]=null==i?void 0:i.asMutable({deep:!0}),N(n)},ke=()=>{ie(!le)},Ae=e.css`
    .remind-con {
      padding-left: ${e.polished.rem(25)};
      color: var(--dark-800);
      margin-bottom: ${e.polished.rem(60)};
      margin-top: ${e.polished.rem(19)};
      font-size: ${e.polished.rem(13)};
    }
    .modal-body {
      padding: ${e.polished.rem(30)} ${e.polished.rem(30)} 0 ${e.polished.rem(30)};
    }
    .modal-footer {
      padding: 0 ${e.polished.rem(30)} ${e.polished.rem(30)} ${e.polished.rem(30)};
    }
    .remind-title {
      font-size: ${e.polished.rem(16)};
      font-weight: 500;
    }
  `,Le=e.css`
    & {
      overflow: auto;
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .setting-collapse {
      & {
        margin-bottom: ${e.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
        padding-left: ${e.polished.rem(8)} !important;
        padding-right: ${e.polished.rem(8)} !important;
      }
    }
  `;return(0,e.jsx)(n.SidePopper,{isOpen:m,position:"right",toggle:C,trigger:h,title:d("templateConfiguration"),backToFocusNode:S},(0,e.jsx)("div",{className:"w-100 h-100",css:Le},(()=>{var t;return(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,{flow:"wrap",label:d("templateName")},(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:P,onAcceptValue:de,onChange:ce,"aria-label":d("templateName"),disabled:(null==I?void 0:I.printTemplateType)===p.OrganizationTemplate})),(0,e.jsx)(n.SettingRow,{flow:"wrap",label:d("fileFormat"),role:"group","aria-label":d("fileFormat")},(0,e.jsx)(i.MultiSelect,{fluid:!0,"aria-label":d("fileFormat"),items:(0,e.Immutable)(null==I?void 0:I.formatList.map(((e,t)=>({value:e,label:e})))),onClickItem:Re,values:(0,e.Immutable)((null==O?void 0:O.selectedFormatList)||[]),size:"sm"})),(0,e.jsx)(n.SettingRow,{flow:"wrap",label:d("printLayout")},(0,e.jsx)(i.Select,{value:null==O?void 0:O.layout,onChange:be,size:"sm",disabled:(null==I?void 0:I.printTemplateType)===p.OrganizationTemplate,"aria-label":d("printLayout")},null===(t=null==I?void 0:I.layoutChoiceList)||void 0===t?void 0:t.map(((t,l)=>(0,e.jsx)(i.Option,{key:`layout${l}`,value:null==t?void 0:t.layoutTemplate,title:null==t?void 0:t.layoutTemplate},null==t?void 0:t.layoutTemplate))))))})(),b(null==O?void 0:O.layout)&&(0,e.jsx)(n.SettingSection,{title:d("MapOnlyOptions"),role:"group","aria-label":d("MapOnlyOptions")},(0,e.jsx)(n.SettingRow,{label:d("setDefaults"),flow:"wrap"}),(0,e.jsx)(n.SettingCollapse,{label:d("mapSize"),isOpen:J===Q.MapSize,onRequestOpen:()=>{he(Q.MapSize)},onRequestClose:xe,role:"group","aria-label":d("mapSize"),rightIcon:G,type:"primary",className:J===Q.MapSize&&"active-collapse"},(0,e.jsx)(n.SettingRow,{label:d("width"),className:"mt-2"},(0,e.jsx)(i.NumericInput,{size:"sm",placeholder:d("width"),value:z||800,onAcceptValue:e=>{var t;if(!e||Number(e)<1)return B(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.width),!1;ue(["exportOptions","width"],Number(e))},onChange:e=>{if(e<1)return!1;B(e)},showHandlers:!1,"aria-label":d("width")})),(0,e.jsx)(n.SettingRow,{label:d("height")},(0,e.jsx)(i.NumericInput,{size:"sm",placeholder:d("height"),value:Z||1100,onAcceptValue:e=>{var t;if(!e||Number(e)<1)return D(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.height),!1;ue(["exportOptions","height"],Number(e))},onChange:e=>{D(e)},showHandlers:!1,"aria-label":d("height")}))),(0,e.jsx)(n.SettingCollapse,{label:d("mapAttribution"),isOpen:J===Q.AttributionVisible,onRequestOpen:()=>{he(Q.AttributionVisible)},onRequestClose:xe,role:"group","aria-label":d("mapAttribution"),rightIcon:G,type:"primary",className:J===Q.AttributionVisible&&"active-collapse"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.Button,{title:d("includeAttribution"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:e=>{const t=!(null==O?void 0:O.attributionVisible);ue(["attributionVisible"],t)}},(0,e.jsx)(i.Checkbox,{title:d("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:!!(null==O?void 0:O.attributionVisible)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("includeAttribution"))))),I.modeType===r.Classic&&(0,e.jsx)(n.SettingRow,{className:"mt-2",flow:"wrap",label:d("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(i.Button,{title:d("printTitle"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableMapSize")}},(0,e.jsx)(i.Checkbox,{title:d("printTitle"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==O?void 0:O.enableMapSize)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("mapSize")))),(0,e.jsx)("div",{className:"w-100 mt-1"},(0,e.jsx)(i.Button,{title:d("mapAttribution"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableMapAttribution")}},(0,e.jsx)(i.Checkbox,{title:d("mapAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==O?void 0:O.enableMapAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("mapAttribution")))))),!b(null==O?void 0:O.layout)&&(()=>{var t,l,a,o,s,u,c,p;return(0,e.jsx)(n.SettingSection,{title:d("LayoutOptions"),role:"group","aria-label":d("LayoutOptions")},(0,e.jsx)(n.SettingRow,{label:d("setDefaults"),flow:"wrap"}),(null==O?void 0:O.hasAuthorText)&&(0,e.jsx)(n.SettingCollapse,{label:d("printTemplateAuthor"),isOpen:J===Q.Author,onRequestOpen:()=>{he(Q.Author)},onRequestClose:xe,role:"group","aria-label":d("printTemplateAuthor"),type:"primary",rightIcon:G,className:"mb-2"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:$,onAcceptValue:me,onChange:pe,"aria-label":d("printTemplateAuthor")}))),(null==O?void 0:O.hasCopyrightText)&&(0,e.jsx)(n.SettingCollapse,{label:d("copyright"),isOpen:J===Q.Copyright,onRequestOpen:()=>{he(Q.Copyright)},onRequestClose:xe,role:"group","aria-label":d("copyright"),rightIcon:G,type:"primary",className:"mb-2"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.TextInput,{size:"sm",className:"w-100",value:q,onAcceptValue:ge,onChange:ve,"aria-label":d("copyright")}))),(null==O?void 0:O.hasLegend)&&(0,e.jsx)(n.SettingCollapse,{label:d("legend"),isOpen:J===Q.Legend,onRequestOpen:()=>{he(Q.Legend)},onRequestClose:xe,role:"group",type:"primary","aria-label":d("legend"),rightIcon:G,className:"mb-2"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.Button,{title:d("includeLegend"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:Ie},(0,e.jsx)(i.Checkbox,{title:d("includeLegend"),className:"lock-item-ratio",checked:je()}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("includeLegend"))))),(0,e.jsx)(n.SettingCollapse,{label:d("scaleBarUnit"),isOpen:J===Q.ScaleBarUnit,onRequestOpen:()=>{he(Q.ScaleBarUnit)},onRequestClose:xe,role:"group","aria-label":d("scaleBarUnit"),rightIcon:G,type:"primary",className:J===Q.ScaleBarUnit&&"active-collapse"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.Select,{value:null===(t=null==O?void 0:O.layoutOptions)||void 0===t?void 0:t.scalebarUnit,onChange:fe,size:"sm","aria-label":d("scaleBarUnit")},function(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}(d).map(((t,l)=>(0,e.jsx)(i.Option,{key:`unit${l}`,value:t.value,title:t.label},t.label)))))),(null===(a=null===(l=null==O?void 0:O.layoutOptions)||void 0===l?void 0:l.customTextElements)||void 0===a?void 0:a.length)>0&&(()=>{const t=[];return null==Y||Y.forEach(((l,a)=>{var o;for(const s in l){const r=(0,e.jsx)(n.SettingCollapse,{label:s,key:`${s}_${a}`,isOpen:(null===(o=null==ee?void 0:ee[a])||void 0===o?void 0:o[s])||!1,onRequestOpen:()=>{Te(s,a)},onRequestClose:xe,role:"group","aria-label":s,rightIcon:G,type:"primary",className:ee[s]&&"active-collapse"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"align-item-center mt-2"},(0,e.jsx)(i.TextInput,{size:"sm",className:"flex-grow-1",value:l[s]||"","aria-label":s,onAcceptValue:e=>{Ne(a,s,e)},onChange:e=>{Oe(a,s,e)}})));t.push(r)}})),t})(),ne&&(0,e.jsx)(n.SettingCollapse,{label:d("northArrow"),isOpen:J===Q.NorthArrow,onRequestOpen:()=>{he(Q.NorthArrow)},onRequestClose:xe,role:"group",type:"primary","aria-label":d("northArrow"),rightIcon:G,className:"mb-2"},(0,e.jsx)(n.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(i.Button,{title:d("includeNorthArrow"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:Me},(0,e.jsx)(i.Checkbox,{title:d("includeNorthArrow"),className:"lock-item-ratio",checked:null===(u=null===(s=null===(o=null==O?void 0:O.layoutOptions)||void 0===o?void 0:o.elementOverrides)||void 0===s?void 0:s[ne])||void 0===u?void 0:u.visible}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("includeNorthArrow"))))),I.modeType===r.Classic&&(0,e.jsx)(n.SettingRow,{className:"mt-2",flow:"wrap",label:d("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(null==O?void 0:O.hasAuthorText)&&(0,e.jsx)(i.Button,{title:d("printTemplateAuthor"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableAuthor")}},(0,e.jsx)(i.Checkbox,{title:d("printTemplateAuthor"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableAuthor)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("printTemplateAuthor"))),(null==O?void 0:O.hasCopyrightText)&&(0,e.jsx)(i.Button,{title:d("copyright"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableCopyright")}},(0,e.jsx)(i.Checkbox,{title:d("copyright"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableCopyright)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("copyright"))),(null==O?void 0:O.hasLegend)&&(0,e.jsx)(i.Button,{title:d("legend"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableLegend")}},(0,e.jsx)(i.Checkbox,{title:d("legend"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableLegend)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("legend"))),(0,e.jsx)(i.Button,{title:d("scaleBarUnit"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableScalebarUnit")}},(0,e.jsx)(i.Checkbox,{title:d("scaleBarUnit"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableScalebarUnit)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("scaleBarUnit"))),(null===(p=null===(c=null==O?void 0:O.layoutOptions)||void 0===c?void 0:c.customTextElements)||void 0===p?void 0:p.length)>0&&(()=>{const t=[];return null==Y||Y.forEach(((l,n)=>{var a,o;for(const s in l){const l=(0,e.jsx)(i.Button,{key:`${s}_${n}`,title:s,className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{Ce(s,n)}},(0,e.jsx)(i.Checkbox,{title:s,className:"lock-item-ratio",checked:(null===(o=null===(a=null==O?void 0:O.customTextElementEnableList)||void 0===a?void 0:a[n])||void 0===o?void 0:o[s])||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s));t.push(l)}})),t})(),ne&&(0,e.jsx)(i.Button,{title:d("northArrow"),className:"d-flex w-100 align-items-center text-wrap",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{we("enableNorthArrow")}},(0,e.jsx)(i.Checkbox,{title:d("northArrow"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableNorthArrow)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},d("northArrow"))))))})(),(0,e.jsx)(n.SettingSection,null,(0,e.jsx)(n.SettingRow,{className:"mb-3",label:d("overrideCommonSettings")},(0,e.jsx)(i.Switch,{"aria-label":d("overrideCommonSettings"),checked:(null==O?void 0:O.overrideCommonSetting)||!1,onChange:e=>{e.target.checked?Se():ke()}})),(null==O?void 0:O.overrideCommonSetting)&&(0,e.jsx)(U,{id:c,printTemplateProperties:O,handleTemplatePropertyChange:e=>{const t=null==A?void 0:A.asMutable({deep:!0});t[R]=null==e?void 0:e.asMutable({deep:!0}),N(t)},modeType:null==I?void 0:I.modeType,jimuMapView:T}),(0,e.jsx)(i.AlertPopup,{isOpen:le,toggle:ke,hideHeader:!0,onClickOk:Se,onClickClose:ke,css:Ae},(0,e.jsx)("div",{className:"align-middle pt-2 remind-title d-flex align-items-center"},(0,e.jsx)("div",{className:"mr-1"},(0,e.jsx)(V,{className:"align-middle",size:"l",color:"var(--warning-600)"})),(0,e.jsx)("span",{className:"align-middle flex-grow-1"},d("overrideSettingsTitle"))),(0,e.jsx)("div",{className:"remind-con"},d("overrideSettingsRemind"))))))};var W=u(52785),q=u(748),_=u.n(q);const J=t=>{const l=window.SVG,{className:i}=t,n=function(e,t){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(l[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(l[i[n]]=e[i[n]])}return l}(t,["className"]),a=(0,e.classNames)("jimu-icon jimu-icon-component",i);return l?e.React.createElement(l,Object.assign({className:a,src:_()},n)):e.React.createElement("svg",Object.assign({className:a},n))};const K=(t,l)=>{return i=void 0,n=void 0,o=function*(){return(i=t,g(void 0,void 0,void 0,(function*(){return e.UtilityManager.getInstance().getUrlOfUseUtility(i).then((e=>Promise.resolve(e)))}))).then((e=>Y(e,t,l)));var i},new((a=void 0)||(a=Promise))((function(e,t){function l(e){try{r(o.next(e))}catch(e){t(e)}}function s(e){try{r(o.throw(e))}catch(e){t(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(l,s)}r((o=o.apply(i,n||[])).next())}));var i,n,a,o},Y=(t,l,i)=>{const n=le(null==l?void 0:l.utilityId);return T(t).then((a=>{let o=i;const r=(null==a?void 0:a.templates)?((t,l,i)=>((e,t,l)=>{const i=h(t,l);return e.map(((e,t)=>(e.templateId=`config_${i}_${t}`,e)))})(t.map((t=>{var l;let i=(0,e.Immutable)(t);return i=i.set("layout",null==t?void 0:t.layout),i=i.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],[]),b(null==i?void 0:i.layout)&&(i=i.set("exportOptions",Object.assign({width:800,height:1100},null==t?void 0:t.exportOptions))),null===(l=x((0,e.Immutable)(s),(0,e.Immutable)(i)))||void 0===l?void 0:l.asMutable({deep:!0})})),l,i))(null==a?void 0:a.templates,n,null==i?void 0:i.printTemplateType):[],u=null==r?void 0:r.map((e=>{var t;return(null==e?void 0:e.layout)&&(e.layout=null==e?void 0:e.layout),(null==e?void 0:e.format)&&(e.format=null===(t=null==e?void 0:e.format)||void 0===t?void 0:t.toLowerCase()),e}));return function(t){const l={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"};return function(t){var l;if(!t)return Promise.resolve(null);const i=`${null===(l=t.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,n={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(i,n).then((e=>{var t;const l=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks;let n=`${i}/Get Layout Templates Info Task/execute`;return null==l||l.forEach((e=>{(null==e?void 0:e.includes("Templates"))&&(null==e?void 0:e.includes("Info"))&&(n=`${i}/${e}/execute`)})),Promise.resolve(n)}))}))}(t).then((t=>(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[i]=e;return i(t,l).then((e=>{var t,l;return Promise.resolve((null===(l=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.results[0])||void 0===l?void 0:l.value)||[])}))}))))}(t).then((e=>{const t=X(e,u),i=te(null==a?void 0:a.templates,t);return o=o.set("printCustomTemplate",t).set("useUtility",l).set("formatList",null==a?void 0:a.formatList).set("defaultFormat",null==a?void 0:a.defaultFormat).set("layoutChoiceList",i),Promise.resolve(o)}))}))},X=(e,t)=>null==t?void 0:t.map((t=>{var l,i,n,a,o,s,r;let u;e.forEach((e=>{t.label===e.layoutTemplate&&(u=e)})),(null==u?void 0:u.webMapFrameSize)&&(t.mapFrameSize=null==u?void 0:u.webMapFrameSize,t.mapFrameUnit=null==u?void 0:u.pageUnits);const d=null===(i=null===(l=null==u?void 0:u.layoutOptions)||void 0===l?void 0:l.customTextElements)||void 0===i?void 0:i.map((e=>{const t={};for(const l in e)t[l]=!0;return t})),c=ee(null==u?void 0:u.layoutOptions);return t.mapFrameUnit=null==u?void 0:u.pageUnits,t.hasAuthorText=null===(n=null==u?void 0:u.layoutOptions)||void 0===n?void 0:n.hasAuthorText,t.hasCopyrightText=null===(a=null==u?void 0:u.layoutOptions)||void 0===a?void 0:a.hasCopyrightText,t.hasLegend=null===(o=null==u?void 0:u.layoutOptions)||void 0===o?void 0:o.hasLegend,t.hasTitleText=null===(s=null==u?void 0:u.layoutOptions)||void 0===s?void 0:s.hasTitleText,t.selectedFormatList=[null==t?void 0:t.format],t.layoutOptions.customTextElements=(null===(r=null==u?void 0:u.layoutOptions)||void 0===r?void 0:r.customTextElements)||[],t.layoutOptions.elementOverrides=c,t.customTextElementEnableList=d||[],t.enableNorthArrow=!!w(c),t})),ee=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],l=null==t?void 0:t.find((e=>"CIMMarkerNorthArrow"===e.type)),i={};return l&&(i[null==l?void 0:l.name]=l),(null==e?void 0:e.elementOverrides)||i},te=(e,t)=>(null==e?void 0:e.map((e=>(e.layoutTemplate=null==e?void 0:e.layout,null==t||t.forEach((t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText)})),e))))||[],le=t=>{const l=e.UtilityManager.getInstance().getUtilityJson(t);return"org"===(null==l?void 0:l.source)?c.OrganizationService:c.Customize};const{useState:ie,useEffect:ne,useRef:ae}=e.React,oe=t=>{const l=ae(!1),a=i.hooks.useTranslate(v,i.defaultMessages),{config:o,id:s,showLoading:r,onSettingChange:u,toggleLoading:d}=t,[c,p]=ie(null==o?void 0:o.useUtility),m=e.css`
    &>div>div {
      padding-left: 0!important;
      padding-right: 0!important;
    }
    .utility-placeholder {
      & {
        color: var(--dark-200);
      }
      p {
        color: var(--dark-500);
        font-size: ${e.polished.rem(14)};
        margin: ${e.polished.rem(16)} auto 0;
        line-height: ${e.polished.rem(19)};
        width: ${e.polished.rem(228)};
      }
    }
    .utility-list {
      margin-bottom: 0 !important;
    }
  }`;ne((()=>{p(null==o?void 0:o.useUtility)}),[o]);const g=()=>{let e=o;e=e.set("useUtility",null),d(!1),u({id:s,config:e,useUtilities:[]})},h=e=>{return t=void 0,i=void 0,a=function*(){d(!0),K(e,o).then((t=>{if(l.current)return!1;d(!1),u({id:s,config:t,useUtilities:e?[e]:[]})}),(e=>{g(),d(!1)}))},new((n=void 0)||(n=Promise))((function(e,l){function o(e){try{r(a.next(e))}catch(e){l(e)}}function s(e){try{r(a.throw(e))}catch(e){l(e)}}function r(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(o,s)}r((a=a.apply(t,i||[])).next())}));var t,i,n,a};return(0,e.jsx)("div",{css:m},(0,e.jsx)(n.SettingRow,{flow:"wrap",label:a("printService"),role:"group","aria-label":a("printService")},(0,e.jsx)(W.UtilitySelector,{useUtilities:(0,e.Immutable)(c?[c]:[]),onChange:e=>{const t=e[0];p(t),t?(l.current=!1,h(t)):(l.current=!0,g())},showRemove:!0,closePopupOnSelect:!0,type:e.SupportedUtilityType.Printing})),!(null==o?void 0:o.useUtility)&&!r&&(0,e.jsx)("div",{className:"w-100 mt-3 text-center utility-placeholder"},(0,e.jsx)("div",{className:"text-center w-100"},(0,e.jsx)(J,{size:48}),(0,e.jsx)("p",{className:"text-Secondary",id:"list-empty-tip",title:a("utilityPlaceholder")},a("utilityPlaceholder")))))},{useState:se}=e.React,re=t=>{const{config:l,id:a,jimuMapView:o,onSettingChange:r,handlePropertyChange:u}=t,d=i.hooks.useTranslate(v,i.defaultMessages),c=e.css`
    .radio-con {
      cursor: pointer;
    }
    .loading-con {
      height: ${e.polished.rem(100)};
    }
  `,[m,g]=se(null),[y,b]=se(!1),w=e=>{g(e===m?null:e)},S=e=>{const t=f(null==l?void 0:l.printServiceType,null==l?void 0:l.printTemplateType);u(t?"printCustomTemplate":"printOrgTemplate",e)};return(0,e.jsx)(n.SettingSection,{title:d("configurePrintTemplate"),css:c,role:"group","aria-label":d("configurePrintTemplate")},(0,e.jsx)(oe,{id:a,config:l,showLoading:y,onSettingChange:r,toggleLoading:e=>{b(e)}}),y&&(0,e.jsx)("div",{className:"loading-con position-relative"},(0,e.jsx)(i.Loading,null)),(null==l?void 0:l.useUtility)&&(0,e.jsx)("div",null,(null==l?void 0:l.printTemplateType)===p.Customize&&(0,e.jsx)(i.Button,{className:"w-100 mt-2",type:"primary",onClick:()=>{var t,i;let n=(null===(t=null==l?void 0:l.printCustomTemplate)||void 0===t?void 0:t[0])||(0,e.Immutable)({});const a=(null===(i=null==l?void 0:l.printCustomTemplate)||void 0===i?void 0:i.asMutable({deep:!0}))||[],o=((e,t,l)=>{const i=e.map((e=>e.templateId)),n=h(t,l);return i&&0!==(null==i?void 0:i.length)?`config_${n}_${(e=>{var t;const l=null==e?void 0:e.map((e=>{var t;const l=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return l?Number(l):0}));return null===(t=null==l?void 0:l.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]})(i)+1}`:`config_${n}_0`})(a,null==l?void 0:l.printServiceType,p.Customize);n=x(n,(0,e.Immutable)(s)),n=n.set("format",null==l?void 0:l.defaultFormat).set("templateId",o),a.push(null==n?void 0:n.asMutable({deep:!0})),u("printCustomTemplate",a),g(o)}},(0,e.jsx)(M,{className:"mr-1"}),d("newTemplate")),!y&&(0,e.jsx)(j,{id:a,handelActiveTemplateIdChange:w,handelTemplateListChange:S,showNewTemplateItem:!1,activeTemplateId:m,config:l}),(0,e.jsx)($,{id:a,isOpen:m,config:l,activeTemplateId:m,toggle:()=>{w(null)},handelTemplateListChange:S,jimuMapView:o})))},{useEffect:ue}=e.React,de={width:"360px",height:"460px"},ce={width:"40px",height:"40px"},pe=a=>{const{config:o,id:s,portalUrl:d,onSettingChange:c,useMapWidgetIds:p}=a,m=i.hooks.useTranslate(v,i.defaultMessages),g=e.ReactRedux.useSelector((e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[s])||void 0===l?void 0:l.layoutInfo})),h=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig)),[x,y]=e.React.useState(null),f=e.css`
    .select-mode-con {
      &>div {
        flex: 1;
      }
      button {
        height: ${e.polished.rem(80)};
        background: var(--light-200);
        border: 2px solid transparent;
        &:not(:disabled):not(.disabled).active {
          border-color: var(--primary);
          background: var(--light-200);
        }
      }
      img {
        width: 100%;
        height: 100%;
        margin: 0 auto;
      }
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .setting-collapse {
      & {
        margin-bottom: ${e.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
        padding-left: ${e.polished.rem(8)} !important;
        padding-right: ${e.polished.rem(8)} !important;
      }
      .handle{
        height: ${e.polished.rem(32)};
        background: var(--light-500);
        padding-left: ${e.polished.rem(8)};
        padding-right: ${e.polished.rem(8)};
      }
    }
  `;ue((()=>{b()}),[o]);const b=()=>{var e,t;const i=null===(t=null===(e=null==h?void 0:h.widgets)||void 0===e?void 0:e[s])||void 0===t?void 0:t.style;if(!(null==o?void 0:o.hasInitBorder)&&!(null==i?void 0:i.border)){const e=(0,l.getAppConfigAction)(),t={color:"var(--light-400)",type:"solid",width:"1px"};let n;n=i?i.set("border",t):{border:t};const a=null==o?void 0:o.set("hasInitBorder",!0);e.editWidgetProperty(s,"style",n).editWidgetProperty(s,"config",a).exec()}},w=t=>{var i;const n=o.setIn(["modeType"],t),a=(0,l.getAppConfigAction)();let u=de;if(t===r.Compact&&(u=ce),S()===e.LayoutType.FixedLayout){const{layoutId:e,layoutItemId:t}=g,l=h.layouts[e],o=(null===(i=null==l?void 0:l.content)||void 0===i?void 0:i[t]).bbox.set("width",u.width).set("height",u.height);a.editLayoutItemBBox(g,o).editWidgetProperty(s,"config",n).exec()}else a.editWidgetProperty(s,"config",n).exec()},S=()=>{var e,t;const l=null==g?void 0:g.layoutId;return null===(t=null===(e=null==h?void 0:h.layouts)||void 0===e?void 0:e[l])||void 0===t?void 0:t.type};return(0,e.jsx)("div",{className:"widget-setting-search jimu-widget-search",css:f},(0,e.jsx)(n.SettingSection,{className:"map-selector-section",title:m("printSource")},(0,e.jsx)(n.SettingRow,{flow:"wrap",label:m("selectMap"),role:"group","aria-label":m("selectMap")},(0,e.jsx)(n.MapWidgetSelector,{onSelect:e=>{c({id:s,useMapWidgetIds:e})},useMapWidgetIds:p})),(0,e.jsx)("div",{className:"fly-map"},(0,e.jsx)("div",null,(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null==p?void 0:p[0],onActiveViewChange:e=>{null==e||"3d"===e.view.type?y(null):(null==e?void 0:e.id)!==(null==x?void 0:x.id)&&y(e)}})))),(0,e.jsx)(n.SettingSection,{className:"map-selector-section"},(0,e.jsx)(n.SettingRow,{flow:"wrap",label:m("printMode"),role:"group","aria-label":m("printMode")},(0,e.jsx)("div",{className:"d-flex w-100 select-mode-con"},(0,e.jsx)("div",{className:"flex-grow-1 text-truncate"},(0,e.jsx)(i.Button,{className:"w-100",title:m("printClassic"),active:(null==o?void 0:o.modeType)===r.Classic,onClick:()=>{w(r.Classic)}},(0,e.jsx)(i.Icon,{autoFlip:!0,icon:u(69797)})),(0,e.jsx)("div",{className:"mt-1 w-100 text-center text-truncate",title:m("printClassic")},m("printClassic"))),(0,e.jsx)("div",{className:"flex-grow-1 ml-2 text-truncate"},(0,e.jsx)(i.Button,{className:"w-100",active:(null==o?void 0:o.modeType)===r.Compact,title:m("printCompact"),onClick:()=>{w(r.Compact)}},(0,e.jsx)(i.Icon,{autoFlip:!0,icon:u(80941)})),(0,e.jsx)("div",{className:"mt-1 text-center text-truncate",title:m("printCompact")},m("printCompact")))))),(0,e.jsx)(re,{id:s,config:o,portalUrl:d,handlePropertyChange:(e,t)=>{if((null==o?void 0:o[e])===t)return!1;const l=o.setIn([e],t);c({id:s,config:l})},onSettingChange:c,jimuMapView:x}),(null==o?void 0:o.useUtility)&&(0,e.jsx)(n.SettingSection,{title:m("templateCommonSettings"),role:"group","aria-label":m("templateCommonSettings")},(0,e.jsx)(U,{id:s,printTemplateProperties:null==o?void 0:o.commonSetting,handleTemplatePropertyChange:e=>{const t=o.set("commonSetting",e);c({id:s,config:t})},modeType:null==o?void 0:o.modeType,jimuMapView:x})))}})(),d})())}}}));