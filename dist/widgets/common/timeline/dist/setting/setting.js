System.register(["jimu-core","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector","jimu-ui","jimu-ui/advanced/style-setting-components","jimu-ui/basic/date-picker","jimu-core/react","jimu-core/dnd","jimu-arcgis","jimu-ui/basic/color-picker"],(function(e,t){var a={},s={},i={},n={},o={},l={},r={},c={},u={},p={};return{setters:[function(e){a.AllDataSourceTypes=e.AllDataSourceTypes,a.DataSourceComponent=e.DataSourceComponent,a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React,a.classNames=e.classNames,a.css=e.css,a.dataSourceUtils=e.dataSourceUtils,a.dateUtils=e.dateUtils,a.getAppStore=e.getAppStore,a.jsx=e.jsx,a.lodash=e.lodash,a.polished=e.polished},function(e){s.SettingRow=e.SettingRow,s.SettingSection=e.SettingSection,s.SidePopper=e.SidePopper},function(e){i.DataSourceSelector=e.DataSourceSelector},function(e){n.Button=e.Button,n.Checkbox=e.Checkbox,n.Icon=e.Icon,n.Label=e.Label,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Radio=e.Radio,n.Select=e.Select,n.Switch=e.Switch,n.Tooltip=e.Tooltip,n.defaultMessages=e.defaultMessages},function(e){o.DateUnitInput=e.DateUnitInput},function(e){l.DatePicker=e.DatePicker},function(e){r.default=e.default},function(e){c.interact=e.interact},function(e){u.ArcGISDataSourceTypes=e.ArcGISDataSourceTypes},function(e){p.ThemeColorPicker=e.ThemeColorPicker}],execute:function(){e((()=>{var e={19330:(e,t,a)=>{var s={"./style_classic.svg":47738,"./style_modern.svg":70608};function i(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id=19330},97803:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.182 9.727a1.91 1.91 0 1 0 0-3.818 1.91 1.91 0 0 0 0 3.818ZM7.3 7.182a3.183 3.183 0 1 0 0 1.273h1.4a3.183 3.183 0 1 0 0-1.273H7.3Z" fill="#000"></path></svg>'},28455:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1C4.15 1 1 4.15 1 8s3.15 7 7 7 7-3.15 7-7-3.15-7-7-7Zm1.167 11.667H6.834v-2.334h2.333v2.334Zm-2.333-4.5V3.333h2.333v4.834H6.834Z" fill="#000"></path></svg>'},748:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5Zm-9 0a3.501 3.501 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5ZM15.5 11l-5 1-3 4-1-9.5 9 4.5Zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38-2.517.503Z" fill="#000"></path></svg>'},25124:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m8 0 8 6-8 6-8-6 8-6ZM1.887 6 8 10.82 14.113 6 8 1.18 1.887 6ZM0 9.81.563 9 8 14.775 15.437 9l.563.81L8 16 0 9.81Z" fill="#000"></path></svg>'},88866:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16Zm0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14Z" fill="#000"></path></svg>'},47738:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA0IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA0IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04OCAyMkM4OCAyMC44OTU0IDg4Ljg5NTQgMjAgOTAgMjBIOTRDOTUuMTA0NiAyMCA5NiAyMC44OTU0IDk2IDIyQzk2IDIzLjEwNDYgOTUuMTA0NiAyNCA5NCAyNEg5MEM4OC44OTU0IDI0IDg4IDIzLjEwNDYgODggMjJaTTggMjFIMjJWMjNIOFYyMVpNOTQgNDZDOTIuODk1NCA0NiA5MiA0Ni44OTU0IDkyIDQ4QzkyIDQ5LjEwNDYgOTIuODk1NCA1MCA5NCA1MEM5NS4xMDQ2IDUwIDk2IDQ5LjEwNDYgOTYgNDhDOTYgNDYuODk1NCA5NS4xMDQ2IDQ2IDk0IDQ2Wk00NSA0NkM0My44OTU0IDQ2IDQzIDQ2Ljg5NTQgNDMgNDhDNDMgNDkuMTA0NiA0My44OTU0IDUwIDQ1IDUwQzQ2LjEwNDYgNTAgNDcgNDkuMTA0NiA0NyA0OEM0NyA0Ni44OTU0IDQ2LjEwNDYgNDYgNDUgNDZaTTQ5IDQ4QzQ5IDQ2Ljg5NTQgNDkuODk1NCA0NiA1MSA0NkM1Mi4xMDQ2IDQ2IDUzIDQ2Ljg5NTQgNTMgNDhDNTMgNDkuMTA0NiA1Mi4xMDQ2IDUwIDUxIDUwQzQ5Ljg5NTQgNTAgNDkgNDkuMTA0NiA0OSA0OFpNNTUgNDhDNTUgNDYuODk1NCA1NS44OTU0IDQ2IDU3IDQ2QzU4LjEwNDYgNDYgNTkgNDYuODk1NCA1OSA0OEM1OSA0OS4xMDQ2IDU4LjEwNDYgNTAgNTcgNTBDNTUuODk1NCA1MCA1NSA0OS4xMDQ2IDU1IDQ4Wk0xMCA0NkM4Ljg5NTQzIDQ2IDggNDYuODk1NCA4IDQ4QzggNDkuMTA0NiA4Ljg5NTQzIDUwIDEwIDUwQzExLjEwNDYgNTAgMTIgNDkuMTA0NiAxMiA0OEMxMiA0Ni44OTU0IDExLjEwNDYgNDYgMTAgNDZaTTkgMzBIMTBWMzRIOVYzMFpNMjMgMzJIMjRWMzRIMjNWMzJaTTM4IDMwSDM3VjM0SDM4VjMwWk01MSAzMkg1MlYzNEg1MVYzMlpNNjYgMzBINjVWMzRINjZWMzBaTTc5IDMySDgwVjM0SDc5VjMyWk05NCAzMEg5M1YzNEg5NFYzMFpNMTAuNSAzNkg5My41Qzk0Ljg4MDcgMzYgOTYgMzcuMTE5MyA5NiAzOC41Qzk2IDM5Ljg4MDcgOTQuODgwNyA0MSA5My41IDQxSDEwLjVDOS4xMTkyOSA0MSA4IDM5Ljg4MDcgOCAzOC41QzggMzcuMTE5MyA5LjExOTI5IDM2IDEwLjUgMzZaTTEwLjUgMzdDOS42NzE1NyAzNyA5IDM3LjY3MTYgOSAzOC41QzkgMzkuMzI4NCA5LjY3MTU3IDQwIDEwLjUgNDBIMjIuNDk4M0MyMS42Njk5IDQwIDIwLjk5ODMgMzkuMzI4NCAyMC45OTgzIDM4LjVDMjAuOTk4MyAzNy42NzE2IDIxLjY2OTkgMzcgMjIuNDk4MyAzN0gxMC41Wk05My41IDQwSDMxLjQ5NjlDMzIuMzI1MyA0MCAzMi45OTY5IDM5LjMyODQgMzIuOTk2OSAzOC41QzMyLjk5NjkgMzcuNjcxNiAzMi4zMjUzIDM3IDMxLjQ5NjkgMzdIOTMuNUM5NC4zMjg0IDM3IDk1IDM3LjY3MTYgOTUgMzguNUM5NSAzOS4zMjg0IDk0LjMyODQgNDAgOTMuNSA0MFoiIGZpbGw9IiM2QTZBNkEiLz4NCjwvc3ZnPg0K"},70608:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA0IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA0IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04MiAyMEM4MC44OTU0IDIwIDgwIDIwLjg5NTQgODAgMjJDODAgMjMuMTA0NiA4MC44OTU0IDI0IDgyIDI0SDg3Qzg4LjEwNDYgMjQgODkgMjMuMTA0NiA4OSAyMkM4OSAyMC44OTU0IDg4LjEwNDYgMjAgODcgMjBIODJaTTE4IDI3SDg2Qzg3LjY1NjkgMjcgODkgMjguMzQzMSA4OSAzMFY0NkM4OSA0Ny42NTY5IDg3LjY1NjkgNDkgODYgNDlIODNWNDZIODJWNDlINzNWNDFINzJWNDlINjNWNDZINjJWNDlINTNWNDFINTJWNDlINDNWNDhINDJWNDlIMzNWNDFIMzJWNDlIMjNWNDZIMjJWNDlIMThDMTYuMzQzMSA0OSAxNSA0Ny42NTY5IDE1IDQ2VjMwQzE1IDI4LjM0MzEgMTYuMzQzMSAyNyAxOCAyN1pNMTQgMzBDMTQgMjcuNzkwOSAxNS43OTA5IDI2IDE4IDI2SDg2Qzg4LjIwOTEgMjYgOTAgMjcuNzkwOSA5MCAzMFY0NkM5MCA0OC4yMDkxIDg4LjIwOTEgNTAgODYgNTBIMThDMTUuNzkwOSA1MCAxNCA0OC4yMDkxIDE0IDQ2VjMwWk0zNCAzMkMzNCAzMC4zNDMxIDM1LjM0MzEgMjkgMzcgMjlINDJDNDMuNjU2OSAyOSA0NSAzMC4zNDMxIDQ1IDMyVjQ0QzQ1IDQ1LjY1NjkgNDMuNjU2OSA0NyA0MiA0N0gzN0MzNS4zNDMxIDQ3IDM0IDQ1LjY1NjkgMzQgNDRWMzJaTTggMzRDOCAzMi44OTU0IDguODk1NDMgMzIgMTAgMzJDMTEuMTA0NiAzMiAxMiAzMi44OTU0IDEyIDM0QzEyIDM1LjEwNDYgMTEuMTA0NiAzNiAxMCAzNkM4Ljg5NTQzIDM2IDggMzUuMTA0NiA4IDM0Wk04IDQyQzggNDAuODk1NCA4Ljg5NTQzIDQwIDEwIDQwQzExLjEwNDYgNDAgMTIgNDAuODk1NCAxMiA0MkMxMiA0My4xMDQ2IDExLjEwNDYgNDQgMTAgNDRDOC44OTU0MyA0NCA4IDQzLjEwNDYgOCA0MlpNOTQgMzJDOTIuODk1NCAzMiA5MiAzMi44OTU0IDkyIDM0QzkyIDM1LjEwNDYgOTIuODk1NCAzNiA5NCAzNkM5NS4xMDQ2IDM2IDk2IDM1LjEwNDYgOTYgMzRDOTYgMzIuODk1NCA5NS4xMDQ2IDMyIDk0IDMyWk05NCA0MEM5Mi44OTU0IDQwIDkyIDQwLjg5NTQgOTIgNDJDOTIgNDMuMTA0NiA5Mi44OTU0IDQ0IDk0IDQ0Qzk1LjEwNDYgNDQgOTYgNDMuMTA0NiA5NiA0MkM5NiA0MC44OTU0IDk1LjEwNDYgNDAgOTQgNDBaTTE0IDIyQzE0IDIwLjg5NTQgMTQuODk1NCAyMCAxNiAyMEMxNy4xMDQ2IDIwIDE4IDIwLjg5NTQgMTggMjJDMTggMjMuMTA0NiAxNy4xMDQ2IDI0IDE2IDI0QzE0Ljg5NTQgMjQgMTQgMjMuMTA0NiAxNCAyMlpNNjAgMjFINDZWMjNINjBWMjFaIiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},26826:e=>{"use strict";e.exports=u},48891:e=>{"use strict";e.exports=a},54020:e=>{"use strict";e.exports=c},51315:e=>{"use strict";e.exports=r},30726:e=>{"use strict";e.exports=n},338:e=>{"use strict";e.exports=i},77756:e=>{"use strict";e.exports=s},55505:e=>{"use strict";e.exports=o},41362:e=>{"use strict";e.exports=p},28920:e=>{"use strict";e.exports=l}},t={};function g(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,g),i.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var a in t)g.o(t,a)&&!g.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.p="";var d={};return g.p=window.jimuConfig.baseUrl,(()=>{"use strict";g.r(d),g.d(d,{default:()=>ne});var e,t,a,s=g(48891),i=g(77756),n=g(338),o=g(30726);function l(e){return s.css`
    height: calc(100% - ${s.polished.rem(50)});
    overflow: auto;

    .date-label {
      color: ${e.colors.palette.dark[500]};
    }
    .time-step-details {
      margin-top: 0.75rem !important;
    }
  `}function r(e){return s.css`
    .style-container{
      display: flex;
      justify-content: space-between;
      .jimu-btn {
        padding: 0;
        background: ${e.colors.palette.light[200]};
        &.active{
          background: ${e.colors.palette.light[200]};
          outline: 2px solid ${e.colors.palette.primary[600]};
        }
      }
    }
    .autoplay-label{
      color: ${e.colors.palette.dark[400]};
    }

    .empty-placeholder {
      display: flex;
      flex-flow: column;
      justify-content: center;
      height: calc(100% - 165px);
      overflow: hidden;
      .empty-placeholder-inner {
        padding: 0px 20px;
        flex-direction: column;
        align-items: center;
        display: flex;

        .empty-placeholder-text {
          color: ${e.colors.palette.dark[500]};
          font-size: ${s.polished.rem(14)};
          margin-top: 16px;
          text-align: center;
        }
        .empty-placeholder-icon {
          color: ${e.colors.palette.dark[200]};
        }
      }
    }

    .honor-label {
      color: ${e.colors.palette.dark[800]};
    }
  `}!function(e){e.Classic="CLASSIC",e.Modern="MODERN"}(e||(e={})),function(e){e.Slowest="SLOWEST",e.Slow="SLOW",e.Medium="MEDIUM",e.Fast="FAST",e.Fastest="FASTEST"}(t||(t={})),function(e){e.current="CURRENT",e.cumulatively="CUMULATIVE"}(a||(a={}));var c=g(55505),u=g(28920),p=g(51315),m=g(54020),h=g(26826);const D=["year","month","day"],y=["hour","minute"],M=-59011488343e3,S=325036512e5,T="d/M/y",N="h:mm:ss a";var f;!function(e){e[e.year=31536e3]="year",e[e.month=2592e3]="month",e[e.day=86400]="day",e[e.hour=3600]="hour",e[e.minute=60]="minute",e[e.second=1]="second"}(f||(f={}));const j={slowest:5e3,slow:4e3,medium:3e3,fast:2e3,fastest:1e3};function x(e,t,a=!1){const{startTime:i,endTime:n,layerList:o,accuracy:l,stepLength:r}=e||{};let c;const{startTime:u,endTime:p}=function(e,t,a,s){let i=v(a),n=v(s,!1),o=null,l=null;if(!i||!n){const a=O(e,t);a&&(e=a),Object.keys(e).forEach((t=>{var a,s;const r=e[t].getTimeInfo();if(!i){const e=null===(a=null==r?void 0:r.timeExtent)||void 0===a?void 0:a[0];o=o?Math.min(o,e):e}if(!n){const e=null===(s=null==r?void 0:r.timeExtent)||void 0===s?void 0:s[1];l=l?Math.max(l,e):e}})),i=i||o,n=n||l}return{startTime:i,endTime:n}}(t,o,i,n),g=b(u,p),d=g[0],m=I(u,p,d);if(e){c=(0,s.Immutable)(e);const t=!g.includes(l);t&&(c=c.set("accuracy",d)),r&&(t||f[r.unit]>f[d]||1e3*f[r.unit]*r.val>p-u)&&(c=c.set("stepLength",m))}else c=(0,s.Immutable)(function(e,t){return{layerList:null,startTime:{value:s.dateUtils.VirtualDateType.Min},endTime:{value:s.dateUtils.VirtualDateType.Max},timeDisplayStrategy:"CURRENT",dividedCount:null,accuracy:e,stepLength:t}}(d,m));return a?(c=c.set("startTime",{value:u}).set("endTime",{value:p}),c):(0,s.Immutable)({config:c,exactStartTime:u,exactEndTime:p,minAccuracy:d,accuracyList:g})}function I(e,t,a){const s=(t-e)/1e3/f[a];return{val:s>10?10:s>5?5:1,unit:a}}function v(e,t=!0){let a=null;if(e)if("number"==typeof e.value)a=e.value;else{const i=new Date;i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),e.value===s.dateUtils.VirtualDateType.Today?(i.setHours(0),a=i.getTime()+w(e),a=t?a:a+1e3*f.day):e.value===s.dateUtils.VirtualDateType.Now&&(a=i.getTime()+w(e),a=t?a:a+1e3*f.hour)}return a}function w(e){return e.offset?e.offset.val*f[e.offset.unit]*1e3:0}function O(e,t){let a=null;const i=Object.keys(e).map((t=>e[t]))[0];if(i.type===h.ArcGISDataSourceTypes.WebMap){const e=[];i.getAllChildDataSources().forEach((t=>{(t.type===s.DataSourceTypes.MapService&&t.supportTime()||t.type===s.DataSourceTypes.FeatureLayer&&null===s.dataSourceUtils.findMapServiceDataSource(t)&&t.supportTime())&&e.push(t)}));const n=(null==t?void 0:t.map((e=>e.dataSourceId)))||[];a={},e.forEach((e=>{(0===n.length||n.includes(e.id))&&(a[e.id]=e)}))}return a}function b(e,t){const a=[...D,...y],s=[],i=t-e;return a.forEach((e=>{i>=1e3*f[e]&&s.push(e)})),s}function A(e,t,a,s){let i=0;t[0]!==a&&(i=e/((t[1]-t[0])/(a-t[0])),i<0&&(i=0));let n=e/((t[1]-t[0])/(s-a));return n<=2&&(n=2),{marginLeft:i+"px",width:n+"px"}}function C(e,t,a,s,i,n,o){let l=e,r=t;const c=(a[1]-a[0])/s*i;return n.edges.left?(l=e-c,l=Math.max(M,l)):(r=t+c,r=Math.min(S,r)),{newStart:l,newEnd:r}}const L=[{name:"offset",options:{offset:[0,10]}}],k=function(e){const{width:t,isRTL:a,shadowHeight:i,extent:n,intl:l,onChange:r}=e,c=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["width","isRTL","shadowHeight","extent","intl","onChange"]),{startValue:u,endValue:p}=c,[g,d]=s.React.useState([u,p]),[h,D]=s.React.useState(null),y=s.React.useRef(null),f=s.React.useRef(null),j=s.React.useRef(null);s.React.useEffect((()=>{const e=s.lodash.debounce((()=>{h&&h.unset(),y.current&&D(function(e,t,a,s,i,n,o,l){let r,c,u;const p=s-a;return e(t).resizable({edges:{left:".resize-left",right:".resize-right"}}).on("resizestart",(e=>{e.stopPropagation(),r=0;const a=t.getBoundingClientRect();c=a.width,u=parseFloat(t.style.marginLeft.split("px")[0]),t.style.minWidth="0px"})).on("resizemove",(e=>{e.stopPropagation();const l=e.deltaRect;r+=l.width,e.edges.left?r>0?(a<=M&&(r=u),r=Math.min(u+20,r)):r=Math.max(20-c,r):e.edges.right&&(r>0?(s>=S&&(r=n-u-c),r=Math.min(n-u-c+20,r)):r=Math.max(20-c,r));const g=p&&c+r;e.edges.left&&(t.style.marginLeft=u-r+"px"),t.style.width=g+"px";const d=C(a,s,i,n,r,e);o([d.newStart,d.newEnd])})).on("resizeend",(e=>{e.stopPropagation();const t=C(a,s,i,n,r,e);l(t.newStart,t.newEnd)}))}(m.interact,y.current,g[0],g[1],n,t,d,r))}),50);e()}),[n]),s.React.useEffect((()=>{d([u,p])}),[u,p]);const x=s.React.useMemo((()=>A(t,n,g[0],g[1])),[t,n,g]),I=s.React.useMemo((()=>s.dateUtils.formatDateLocally(g[0],l,T,N)),[l,g]),v=s.React.useMemo((()=>s.dateUtils.formatDateLocally(g[1],l,T,N)),[l,g]);return(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)("span",{className:"range-shadow",css:s.css`
          left: ${a?"unset":x.marginLeft};
          right: ${a?x.marginLeft:"unset"};
          width: ${x.width};
          height: ${i+"px"};
        `}),(0,s.jsx)("div",{className:"layer-line extent-line",style:{width:t}},(0,s.jsx)("div",{className:"resize-handlers",ref:e=>y.current=e,style:x},(0,s.jsx)(o.Tooltip,{placement:"bottom",modifiers:L,title:I},(0,s.jsx)("button",{className:"resize-handler resize-left",ref:e=>{f.current=e}})),(0,s.jsx)(o.Tooltip,{placement:"bottom",modifiers:L,title:v},(0,s.jsx)("button",{className:"resize-handler resize-right",ref:e=>{j.current=e}})))))};var z=g(25124),E=g.n(z);const Q=e=>{const t=window.SVG,{className:a}=e,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:E()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var U=g(97803),R=g.n(U);const P=e=>{const t=window.SVG,{className:a}=e,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:R()},i)):s.React.createElement("svg",Object.assign({className:n},i))};function W(e){const t=(0,s.getAppStore)().getState().appContext.isRTL;return s.css`
    .layer-lines{
      position: relative;

      .range-shadow {
        margin-left: ${t?"unset":"30px"};
        margin-right: ${t?"30px":"unset"};
        position: absolute;
        top: 0;
        z-index: -1;
        background: linear-gradient(0deg, #010101 0%, rgba(1, 1, 1, 0) 100%);
      }
      .layer-line-container {
        margin-bottom: 0.25rem;
        .layer-icon {
          margin-right: ${s.polished.rem(14)};
        }
        .layer-line, .extent-line {
          height: 2px;
        }
        .layer-line {
          background: ${e.colors.palette.dark[400]};
          .jimu-btn {
            margin-left: 1rem;
          }
        }
      }
      .extent-line {
        background: ${e.colors.palette.light[800]};
        .resize-handlers {
          background: ${e.colors.palette.primary[800]};
          height: 2px;
          display: flex;
          justify-content: space-between;
          .resize-handler {
            min-width: 10px;
            width: 10px;
            height: 10px;
            border-radius: 10px;
            overflow: visible;
            margin-top: -5px;
            padding: 0;
            border: none;
            background: ${e.colors.palette.light[400]};
            border: 2px solid ${e.colors.palette.primary[800]};
          }
        }
      }
    }
  `}const Y=function(e){const{startTime:t,endTime:a,theme:i,intl:n,overalExtentLabel:l,width:r=188,dataSources:c,onChange:u}=e,[g,d]=p.default.useState(null),[m,h]=p.default.useState(null),[D,y]=p.default.useState(null),M=(0,s.getAppStore)().getState().appContext.isRTL;p.default.useEffect((()=>{m&&f()}),[t,a]),p.default.useEffect((()=>{S()}),[c]);const S=()=>{let e=null,t=null;const a=[];Object.keys(c).forEach((i=>{var o,l;const r=c[i],u=r.getTimeInfo(),p=null===(o=null==u?void 0:u.timeExtent)||void 0===o?void 0:o[0],g=null===(l=null==u?void 0:u.timeExtent)||void 0===l?void 0:l[1];a.push({label:r.getLabel(),extent:[p,g],extentLabels:[s.dateUtils.formatDateLocally(p,n,T,N),s.dateUtils.formatDateLocally(g,n,T,N)]}),e=e?Math.min(e,p):p,t=t?Math.max(t,g):g})),d(a),h([e,t]),f(e,t)},f=(e=m[0],s=m[1])=>{const i=t?Math.min(t,e):e,n=a?Math.max(a,s):s;y([i,n])};return(0,s.jsx)("div",{className:"time-span w-100",dir:"ltr",css:W(i)},(0,s.jsx)("div",{className:"layer-lines",css:s.css`
          height: ${20*(Object.keys(c).length+1)};
        `},null==g?void 0:g.map(((e,t)=>{const a=A(r,D,e.extent[0],e.extent[1]);return(0,s.jsx)("div",{className:"d-flex align-items-center layer-line-container",key:"layerline-"+t},(0,s.jsx)(o.Tooltip,{placement:"bottom",title:(0,s.jsx)("div",{className:"p-2"},(0,s.jsx)("div",null,e.label),(0,s.jsx)("div",null,`${e.extentLabels[0]}-${e.extentLabels[1]}`))},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",className:"layer-icon p-0 border-0"},(0,s.jsx)(Q,{size:12}))),(0,s.jsx)("div",{className:"layer-line",css:s.css`
                  margin-left: ${M?"unset":a.marginLeft};
                  margin-right: ${M?a.marginLeft:"unset"};
                  width: ${a.width};
                `}))})),(0,s.jsx)("div",{className:"d-flex align-items-center layer-line-container"},(0,s.jsx)(o.Tooltip,{placement:"bottom",title:l},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",className:"layer-icon p-0"},(0,s.jsx)(P,{size:12}))),D&&(0,s.jsx)(k,{theme:i,width:r,isRTL:M,intl:n,shadowHeight:20*g.length+10,startValue:null!=t?t:D[0],endValue:null!=a?a:D[1],extent:D,onChange:(e,t)=>{u(e,t)}}))))};var V=g(88866),F=g.n(V);const B=e=>{const t=window.SVG,{className:a}=e,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:F()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var Z=g(28455),$=g.n(Z);const J=e=>{const t=window.SVG,{className:a}=e,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:$()},i)):s.React.createElement("svg",Object.assign({className:n},i))},H=(0,s.Immutable)([s.AllDataSourceTypes.FeatureLayer,s.AllDataSourceTypes.MapService]),G=[s.dateUtils.VirtualDateType.Min,s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now],_=[s.dateUtils.VirtualDateType.Max,s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now];class q extends s.React.PureComponent{constructor(e){super(e),this.timeSpanChanged=(e,t)=>{const{config:a,dataSources:s,exactStartTime:i,exactEndTime:n}=this.props;let o;if(i!==e)o=a.set("startTime",{value:e}),this.checkIfDatesInvalid({value:e},!0);else{if(n===t)return;o=a.set("endTime",{value:t}),this.checkIfDatesInvalid({value:t},!1)}if(a.stepLength){const e=x(o,s).config;o=o.set("accuracy",e.accuracy).set("stepLength",e.stepLength)}this.props.onChange(o)},this.onTimeChanged=(e,t)=>{const{config:a,dataSources:i}=this.props,n={value:e};e===s.dateUtils.VirtualDateType.Today?n.offset={val:0,unit:"day"}:e===s.dateUtils.VirtualDateType.Now?n.offset={val:0,unit:"minute"}:"number"==typeof e&&(n.value=t?Math.max(M,e):Math.min(S,e));let o=a.set((t?"start":"end")+"Time",n);if(this.checkIfDatesInvalid(n,t),a.stepLength){const e=x(o,i).config;o=o.set("accuracy",e.accuracy).set("stepLength",e.stepLength)}this.props.onChange(o)},this.checkIfDatesInvalid=(e,t)=>{const{exactStartTime:a,exactEndTime:s}=this.props;let i=!0;const n=v(e,t);(t&&n>s||!t&&n<a)&&(i=!1),this.setState({isDateValid:i})},this.getOffsetUnits=e=>{let t;return t=e===s.dateUtils.VirtualDateType.Today?D:[...D,...y],t},this.onDateOffsetChanged=(e,t=!1)=>{const a=t?"startTime":"endTime",s=this.props.config.setIn([a,"offset"],e);this.checkIfDatesInvalid(s[a],t),this.props.onChange(s)},this.onAccuracyChanged=e=>{const{config:t,exactStartTime:a,exactEndTime:s,accuracyList:i}=this.props,n=e.target.value;let o=t.set("accuracy",n);if(t.stepLength&&i.indexOf(n)<i.indexOf(t.stepLength.unit)){const e=I(a,s,n);o=o.set("stepLength",e)}this.props.onChange(o)},this.onStepChecked=()=>{const{config:e,exactStartTime:t,exactEndTime:a}=this.props,s=I(t,a,e.accuracy);this.props.onChange(this.props.config.set("stepLength",s).set("dividedCount",null))},this.onDividedChecked=()=>{this.props.onChange(this.props.config.set("stepLength",null).set("dividedCount",5))},this.onStepLengthChanged=e=>{this.props.onChange(this.props.config.set("stepLength",e).set("dividedCount",null))},this.onDividedCountChanged=e=>{this.props.onChange(this.props.config.set("dividedCount",e||2).set("stepLength",null))},this.onChange=(e,t)=>{this.props.onChange(this.props.config.set(e,t))},this.getAllSupportedLayersFromMap=()=>{const{dataSources:e,dataSourceType:t,config:a}=this.props;return t===s.AllDataSourceTypes.WebMap?O(e,null==a?void 0:a.layerList):null},this.getSupportedLayerIdsFromMap=()=>{if(this.props.dataSourceType===s.AllDataSourceTypes.WebMap){const e=Object.keys(this.allSupportedLayers).map((e=>e));return(0,s.Immutable)(e)}return null},this.getSelectedDataSources=()=>{const{dataSources:e,dataSourceType:t,config:a}=this.props;let i={};return t===s.AllDataSourceTypes.WebMap?Object.keys(this.allSupportedLayers).forEach((e=>{(null===a.layerList||a.layerList.filter((t=>t.dataSourceId===e)).length>0)&&(i[e]=this.allSupportedLayers[e])})):i=e,i},this.getSelectedUseDataSources=()=>{var e;const{config:t,dataSourceType:a}=this.props;if(a===s.AllDataSourceTypes.WebMap){if(null!==t.layerList)return t.layerList;const a=[];return null===(e=Object.keys(this.allSupportedLayers))||void 0===e||e.forEach((e=>{var t,s;const i=this.allSupportedLayers[e];a.push({rootDataSourceId:null===(t=i.getRootDataSource())||void 0===t?void 0:t.id,dataSourceId:e,mainDataSourceId:null===(s=i.getMainDataSource())||void 0===s?void 0:s.id})})),(0,s.Immutable)(a)}return null},this.dataSourceChange=e=>{const t=x(null,O(this.props.dataSources,e)).config;this.props.onChange(t.set("layerList",e))},this.getDateValue=e=>e?("number"==typeof e&&(e=new Date(e)),e):null,this.isSelectionDisabled=()=>{const{layerList:e}=this.props.config;return null===e||e.length===this.state.supportedLayerIdsFromMap.length},this.allSupportedLayers=this.getAllSupportedLayersFromMap(),this.state={supportedLayerIdsFromMap:this.getSupportedLayerIdsFromMap(),selectedUseDataSources:this.getSelectedUseDataSources(),selectedDataSources:this.getSelectedDataSources(),isDateValid:e.exactStartTime<=e.exactEndTime}}componentDidUpdate(e,t){this.props.config.layerList!==e.config.layerList&&this.setState({selectedUseDataSources:this.getSelectedUseDataSources(),selectedDataSources:this.getSelectedDataSources()})}render(){const{i18nMessage:e,config:t,dataSourceType:r,intl:p,theme:g,exactStartTime:d,exactEndTime:m,accuracyList:h}=this.props,{supportedLayerIdsFromMap:D,selectedUseDataSources:y,selectedDataSources:M}=this.state,{startTime:S,endTime:j,accuracy:x,timeDisplayStrategy:I,stepLength:v,dividedCount:w}=t,O=this.getDateValue(null==S?void 0:S.value),b=this.getDateValue(null==j?void 0:j.value),A="string"==typeof(null==S?void 0:S.value)&&[s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now].includes(null==S?void 0:S.value),C="string"==typeof(null==j?void 0:j.value)&&[s.dateUtils.VirtualDateType.Today,s.dateUtils.VirtualDateType.Now].includes(null==j?void 0:j.value);return(0,s.jsx)("div",{className:"time-panel w-100 h-100",css:l(g)},r===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(i.SettingSection,{className:"pt-0",title:(0,s.jsx)("span",{title:e("enableTimeAnimation")},e("enableTimeAnimation"))},(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(n.DataSourceSelector,{isMultiple:!0,types:H,useDataSources:y,mustUseDataSource:!0,disableDataView:!0,hideDataView:!0,closeDataSourceListOnChange:!0,disableRemove:()=>1===y.length,onChange:this.dataSourceChange,hideDs:e=>!D.includes(e.id),disableSelection:this.isSelectionDisabled})))),(0,s.jsx)(i.SettingSection,{className:"border-0 "+(r!==s.AllDataSourceTypes.WebMap?"pt-0":""),title:e("timeSpan")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(Y,{intl:p,theme:g,overalExtentLabel:e("overallTimeExtent"),dataSources:M,startTime:d,endTime:m,onChange:this.timeSpanChanged}))),(0,s.jsx)(i.SettingSection,{className:"border-0 pt-0",title:e("startTime")},(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(u.DatePicker,{style:{width:"226px"},"aria-label":e("startTime"),disablePortal:!1,selectedDate:O,format:"shortDateLongTime",runtime:!1,showDoneButton:!0,hideEmpty:!0,showTimeInput:!0,isTimeLong:!0,virtualDateListForSetting:G,onChange:e=>this.onTimeChanged(e,!0)})),"string"==typeof(null==S?void 0:S.value)&&S.value===s.dateUtils.VirtualDateType.Min&&(0,s.jsx)(i.SettingRow,{className:"mt-1 date-label"},s.dateUtils.formatDateLocally(d,p,T,N)),A&&(0,s.jsx)(i.SettingRow,{label:e("offset")},(0,s.jsx)(c.DateUnitInput,{style:{width:"125px"},step:1,value:S.offset,units:this.getOffsetUnits(S.value),onChange:e=>this.onDateOffsetChanged(e,!0)}))),(0,s.jsx)(i.SettingSection,{className:"border-0 pt-0",title:e("endTime")},(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(u.DatePicker,{style:{width:"226px"},"aria-label":e("endTime"),disablePortal:!1,selectedDate:b,format:"shortDateLongTime",runtime:!1,showDoneButton:!0,hideEmpty:!0,showTimeInput:!0,isTimeLong:!0,virtualDateListForSetting:_,onChange:e=>this.onTimeChanged(e,!1)})),"string"==typeof(null==j?void 0:j.value)&&j.value===s.dateUtils.VirtualDateType.Max&&(0,s.jsx)(i.SettingRow,{className:"mt-1 date-label"},s.dateUtils.formatDateLocally(m,p,T,N)),C&&(0,s.jsx)(i.SettingRow,{label:e("offset")},(0,s.jsx)(c.DateUnitInput,{style:{width:"125px"},step:1,value:j.offset,units:this.getOffsetUnits(j.value),onChange:e=>this.onDateOffsetChanged(e,!1)})),!this.state.isDateValid&&(0,s.jsx)("div",{className:"d-flex mt-2 ml-1 mr-1",role:"alert","aria-live":"polite"},(0,s.jsx)(J,{color:this.props.theme.colors.palette.danger[700],className:"mr-2"}),(0,s.jsx)("div",{className:"flex-grow-1",style:{color:g.colors.palette.danger[700]}},e("timeWarning")))),(0,s.jsx)(i.SettingSection,{className:"pt-0"},(0,s.jsx)(i.SettingRow,{flow:"wrap",label:(0,s.jsx)("div",{className:"m-0"},e("setMinTimeAccuracy"),(0,s.jsx)(o.Tooltip,{title:e("setMinTimeAccuracyTip"),showArrow:!0,placement:"left"},(0,s.jsx)(o.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0"},(0,s.jsx)(B,null))))}),(0,s.jsx)(i.SettingRow,{className:"mt-1"},(0,s.jsx)(o.Select,{onChange:this.onAccuracyChanged,value:x},h.map((t=>(0,s.jsx)(o.Option,{key:t,value:t,active:t===x},e(t))))))),(0,s.jsx)(i.SettingSection,{title:e("timeStep")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:!!v,onChange:this.onStepChecked}),e("lengthOfOneStep"))),v&&(0,s.jsx)(i.SettingRow,{className:"time-step-details"},(0,s.jsx)(c.DateUnitInput,{className:"w-100",min:1,step:1,value:v,units:h.filter((e=>f[e]>=f[x])),onChange:this.onStepLengthChanged})),(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:w>0,onChange:this.onDividedChecked}),e("totalTimeDividedIntoEqualSteps"))),w&&(0,s.jsx)(i.SettingRow,{className:"time-step-details",label:e("count")},(0,s.jsx)(o.NumericInput,{"aria-label":e("count"),size:"sm",min:2,showHandlers:!1,value:w,onAcceptValue:this.onDividedCountChanged}))),(0,s.jsx)(i.SettingSection,{title:e("timeDisplay")},(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Tooltip,{placement:"bottom",title:e("showCurrentWindowTip"),describeChild:!0},(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:I===a.current,onChange:()=>this.onChange("timeDisplayStrategy",a.current)}),e("showCurrentWindow")))),(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Tooltip,{placement:"bottom",title:e("showDataCumulativelyTip"),describeChild:!0},(0,s.jsx)(o.Label,{check:!0},(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:I===a.cumulatively,onChange:()=>this.onChange("timeDisplayStrategy",a.cumulatively)}),e("showDataCumulatively"))))))}}var K=g(748),X=g.n(K);const ee=e=>{const t=window.SVG,{className:a}=e,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",a);return t?s.React.createElement(t,Object.assign({className:n,src:X()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var te=g(41362);class ae extends s.React.PureComponent{constructor(){super(...arguments),this.onDataSourceCreated=e=>{this.props.onCreateDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,e)},this.onCreateDataSourceFailed=()=>{this.props.onCreateDataSourceCreatedOrFailed(this.props.useDataSource.dataSourceId,null)}}render(){return(0,s.jsx)(s.DataSourceComponent,{useDataSource:this.props.useDataSource,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})}}const se=Object.assign({},{selectDataSourceLabel:"One web map, multiple map services or feature layers",selectDataSourceTip:"You can choose either one web map, multiple map services or multiple feature layers for this widget. However, they must contain temporal data to be used. If the layers are not time-aware, they will not show in the select data panel.",timeSetting:"Time settings",honorTimeSettings:"Synchronize with the time settings in the web map",customTimeSettings:"Customize time settings",configureTime:"Configure time",classicStyle:"Classic",modernStyle:"Modern",displayOptions:"Display options",enableTimeAnimation:"Enable time animation for",timeSpan:"Time span",overallTimeExtent:"Overall time extent",startTime:"Start time",endTime:"End time",timeWarning:"The start time should be no later than the end time.",setMinTimeAccuracy:"Set the minimum time accuracy",setMinTimeAccuracyTip:"The minimum time accuracy represents the minimum time interval that users are allowed to see at runtime. If you set the time step based on defined length, you can move the slider by each minimum time accuracy.",timeDisplay:"Time display",showCurrentWindow:"Show current window",showCurrentWindowTip:"Only display data in the current time window.",showDataCumulatively:"Show data cumulatively",showDataCumulativelyTip:"Progressively display all data as time passes.",timeStep:"Time step",lengthOfOneStep:"Length of one step",totalTimeDividedIntoEqualSteps:"Total time divided into equal steps"},o.defaultMessages),ie=(0,s.Immutable)([s.AllDataSourceTypes.WebMap,s.AllDataSourceTypes.MapService,s.AllDataSourceTypes.FeatureLayer]);class ne extends s.React.PureComponent{constructor(e){super(e),this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:se[e]},t),this.updateConfigForOptions=(e,t)=>{const a={id:this.props.id,config:this.props.config.set(e,t)};this.props.onSettingChange(a)},this.dataSourceChange=e=>{return t=this,a=void 0,n=function*(){var t;let a=e,i=this.state.dataSources,n=this.props.config.set("timeSettings",null),o=n.dataSourceType;if(e.length<(null===(t=this.props.useDataSources)||void 0===t?void 0:t.length))delete i[this.props.useDataSources[this.props.useDataSources.length-1].dataSourceId],this.setState({dataSources:i});else{const t=e[e.length-1],l=yield this.dsManager.createDataSourceByUseDataSource((0,s.Immutable)(t));let r=l.type===s.AllDataSourceTypes.WebMap&&n.honorTimeSettings;l.type===n.dataSourceType&&l.type!==s.AllDataSourceTypes.WebMap||(a=[t],o=l.type,i={},l.type!==n.dataSourceType&&l.type===s.AllDataSourceTypes.WebMap&&(r=!0)),i[t.dataSourceId]=l,this.setState({dataSources:i}),n=n.set("honorTimeSettings",r).set("dataSourceType",o)}this.props.onSettingChange({id:this.props.id,config:n,useDataSources:a})},new((i=void 0)||(i=Promise))((function(e,s){function o(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(e){e(a)}))).then(o,l)}r((n=n.apply(t,a||[])).next())}));var t,a,i,n},this.getTimeSettings=()=>x(this.props.config.timeSettings,this.state.dataSources),this.setHonorTimeSettings=()=>{const{id:e,config:s,onSettingChange:i}=this.props;if(s.honorTimeSettings){const{settings:n}=function(e,s=!1){var i,n,o;let l=null;const r=e[Object.keys(e).filter((t=>e[t].type===h.ArcGISDataSourceTypes.WebMap))[0]],c=null===(o=null===(n=null===(i=null==r?void 0:r.getItemData())||void 0===i?void 0:i.widgets)||void 0===n?void 0:n.timeSlider)||void 0===o?void 0:o.properties;let u;if(c){const{startTime:e,endTime:i,timeStopInterval:n,numberOfStops:o,thumbMovingRate:r,thumbCount:p}=c;if(s&&(u=function(e){let a;const s=1e3*Math.ceil(e/1e3);return Object.keys(j).some((e=>j[e]===s&&(a=e.toUpperCase(),!0))),a||(s>j.slowest?a=t.Slowest:s<j.fastest&&(a=t.Fastest)),a}(r)),l={layerList:null,startTime:{value:e},endTime:{value:i},timeDisplayStrategy:2===p?a.current:a.cumulatively},n){const e=function(e){switch(e){case"esriTimeUnitsMonths":return"month";case"esriTimeUnitsDays":return"day";case"esriTimeUnitsHours":return"hour";case"esriTimeUnitsMinutes":return"minute";default:return"year"}}(n.units);l.accuracy=e,l.stepLength={val:n.interval,unit:e}}else if(o){l.dividedCount=o;const t=b(e,i);l.accuracy=t[0];const a=(i-e)/o;t.some((e=>a>=1e3*f[e]&&(l.accuracy=e,!0)))}}return{settings:l,speed:u}}(this.state.dataSources);i({id:e,config:s.set("honorTimeSettings",!1).set("speed",t.Medium).set("timeSettings",n)})}else i({id:e,config:s.set("honorTimeSettings",!0).set("speed",null).set("timeSettings",null)})},this.enablePlayControl=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("enablePlayControl",t).set("autoPlay",!1)})},this.onTimeSettingPanel=()=>{this.setState({isTimePanelOpen:!this.state.isTimePanelOpen})},this.onCreateDataSourceCreatedOrFailed=(e,t)=>{this.setState((a=>{const s=Object.assign({},a.dataSources);return s[e]=t,{dataSources:s}}))},this.hideDs=e=>{var t;let a=!1;const i=null===(t=this.dsManager)||void 0===t?void 0:t.getDataSource(e.id);return a=i.type===s.AllDataSourceTypes.FeatureLayer?!i.supportTime()||null!==s.dataSourceUtils.findMapServiceDataSource(i):i.type===s.AllDataSourceTypes.WebMap?0===i.getAllChildDataSources().filter((e=>[s.AllDataSourceTypes.FeatureLayer,s.AllDataSourceTypes.MapService].includes(e.type)&&e.supportTime())).length:!i.supportTime(),a},this.dsManager=s.DataSourceManager.getInstance(),this.state={isTimePanelOpen:!1,dataSources:{}}}render(){var t;const{theme:a,theme2:l,config:c,useDataSources:u,intl:p}=this.props,{honorTimeSettings:d,timeStyle:m,backgroundColor:h,foregroundColor:D,sliderColor:y,enablePlayControl:M,autoPlay:S,dataSourceType:T}=c,N=(null==u?void 0:u.length)>0;return(0,s.jsx)("div",{className:"jimu-widget-setting widget-setting-timeline",css:r(a)},null==u?void 0:u.map(((e,t)=>(0,s.jsx)(ae,{key:t,useDataSource:e,onCreateDataSourceCreatedOrFailed:this.onCreateDataSourceCreatedOrFailed}))),(0,s.jsx)(i.SettingSection,{title:this.i18nMessage("source"),className:N?"":"border-0"},(0,s.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2",label:(0,s.jsx)("div",{className:"m-0"},(0,s.jsx)("span",{id:"timeline-ds-label"},this.i18nMessage("selectDataSourceLabel")),(0,s.jsx)(o.Tooltip,{title:this.i18nMessage("selectDataSourceTip"),showArrow:!0,placement:"left"},(0,s.jsx)(o.Button,{icon:!0,type:"tertiary",size:"sm",className:"ml-2 p-0"},(0,s.jsx)(B,null))))}),(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(n.DataSourceSelector,{hideAllOptionOfTypeDropdown:!0,isMultiple:!0,"aria-describedby":"timeline-ds-label timeline-blank-msg",types:ie,useDataSources:u||(0,s.Immutable)([]),mustUseDataSource:!0,disableDataView:!0,hideDataView:!0,hideDs:this.hideDs,closeDataSourceListOnChange:!1,onChange:this.dataSourceChange}))),N?(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(i.SettingSection,{title:this.i18nMessage("timeSetting"),className:""},T===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{className:"honor-label",check:!0},(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:d,onChange:this.setHonorTimeSettings}),this.i18nMessage("honorTimeSettings"))),(0,s.jsx)(i.SettingRow,{className:"mt-2"},(0,s.jsx)(o.Label,{className:"honor-label",check:!0},T===s.AllDataSourceTypes.WebMap&&(0,s.jsx)(o.Radio,{style:{cursor:"pointer"},className:"mr-2 align-text-bottom",checked:!d,onChange:this.setHonorTimeSettings}),this.i18nMessage("customTimeSettings"))),(!d||T===s.AllDataSourceTypes.FeatureLayer)&&(0,s.jsx)(i.SettingRow,{className:"mt-3"},(0,s.jsx)(o.Button,{className:"w-100",ref:e=>{this.timeSettingsRef=e},"aria-label":this.i18nMessage("configureTime"),onClick:this.onTimeSettingPanel,disabled:0===Object.keys(this.state.dataSources).length},(0,s.jsx)("div",{className:"w-100 px-2 text-truncate"},this.i18nMessage("configureTime"))))),(0,s.jsx)(i.SettingSection,{role:"group",title:this.i18nMessage("style"),"aria-label":this.i18nMessage("style")},(0,s.jsx)(i.SettingRow,{className:"style-container"},[e.Classic,e.Modern].map(((e,t)=>{const a=e.toLowerCase();return(0,s.jsx)(o.Tooltip,{key:t,title:this.i18nMessage(`${a}Style`),placement:"bottom"},(0,s.jsx)(o.Button,{icon:!0,size:"sm",type:"tertiary",active:e===m,"aria-pressed":e===m,onClick:()=>this.updateConfigForOptions("timeStyle",e)},(0,s.jsx)(o.Icon,{width:104,height:70,icon:g(19330)(`./style_${a}.svg`)})))})))),(0,s.jsx)(i.SettingSection,{role:"grpup",title:this.i18nMessage("appearance"),"aria-label":this.i18nMessage("appearance")},(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("foregroundColor")},(0,s.jsx)(te.ThemeColorPicker,{specificTheme:l,value:D,onChange:e=>this.updateConfigForOptions("foregroundColor",e)})),(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("backgroundColor")},(0,s.jsx)(te.ThemeColorPicker,{specificTheme:l,value:h,onChange:e=>this.updateConfigForOptions("backgroundColor",e)})),(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("sliderColor")},(0,s.jsx)(te.ThemeColorPicker,{specificTheme:l,value:y,onChange:e=>this.updateConfigForOptions("sliderColor",e)}))),(0,s.jsx)(i.SettingSection,{role:"grpup",title:this.i18nMessage("displayOptions"),"aria-label":this.i18nMessage("displayOptions")},(0,s.jsx)(i.SettingRow,{label:this.i18nMessage("enablePlayControl")},(0,s.jsx)(o.Switch,{checked:M,onChange:this.enablePlayControl,"aria-label":this.i18nMessage("enablePlayControl")})),M&&(0,s.jsx)(i.SettingRow,null,(0,s.jsx)(o.Label,{className:"w-100 d-flex"},(0,s.jsx)(o.Checkbox,{style:{cursor:"pointer",marginTop:"2px"},checked:S,onChange:()=>this.updateConfigForOptions("autoPlay",!S)}),(0,s.jsx)("div",{className:"m-0 ml-2 flex-grow-1 autoplay-label"},this.i18nMessage("autoPlay"))))),this.state.isTimePanelOpen&&(0,s.jsx)(i.SidePopper,{position:"right",title:this.i18nMessage("configureTime"),isOpen:!0,trigger:null===(t=this.timeSettingsRef)||void 0===t?void 0:t.current,backToFocusNode:this.state.popperFocusNode,toggle:this.onTimeSettingPanel},(0,s.jsx)(q,Object.assign({intl:p,theme:a,i18nMessage:this.i18nMessage,dataSources:this.state.dataSources,dataSourceType:T},this.getTimeSettings(),{onChange:e=>this.updateConfigForOptions("timeSettings",e)})))):(0,s.jsx)("div",{className:"empty-placeholder w-100"},(0,s.jsx)("div",{className:"empty-placeholder-inner"},(0,s.jsx)("div",{className:"empty-placeholder-icon"},(0,s.jsx)(ee,{size:48})),(0,s.jsx)("div",{className:"empty-placeholder-text",id:"timeline-blank-msg"},this.i18nMessage("selectDataPlaceholder")))))}}})(),d})())}}}));