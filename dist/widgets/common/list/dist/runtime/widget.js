System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime","jimu-core/react","jimu-ui/basic/sql-expression-runtime"],(function(e,t){var i={},o={},s={},n={},r={};return{setters:[function(e){i.AppMode=e.AppMode,i.BaseVersionManager=e.BaseVersionManager,i.CONSTANTS=e.CONSTANTS,i.ClauseLogic=e.ClauseLogic,i.ClauseOperator=e.ClauseOperator,i.DataRecordsSelectionChangeMessage=e.DataRecordsSelectionChangeMessage,i.DataSourceComponent=e.DataSourceComponent,i.DataSourceManager=e.DataSourceManager,i.DataSourceStatus=e.DataSourceStatus,i.ExpressionResolverComponent=e.ExpressionResolverComponent,i.Immutable=e.Immutable,i.LayoutItemType=e.LayoutItemType,i.LayoutType=e.LayoutType,i.LinkType=e.LinkType,i.MessageManager=e.MessageManager,i.MessageType=e.MessageType,i.PageMode=e.PageMode,i.QueryScope=e.QueryScope,i.React=e.React,i.ReactRedux=e.ReactRedux,i.ReactResizeDetector=e.ReactResizeDetector,i.RepeatedDataSourceProvider=e.RepeatedDataSourceProvider,i.appActions=e.appActions,i.appConfigUtils=e.appConfigUtils,i.classNames=e.classNames,i.css=e.css,i.dataSourceUtils=e.dataSourceUtils,i.esri=e.esri,i.getAppStore=e.getAppStore,i.jsx=e.jsx,i.lodash=e.lodash,i.polished=e.polished,i.utils=e.utils},function(e){o.Alert=e.Alert,o.Button=e.Button,o.DataActionDropDown=e.DataActionDropDown,o.DistanceUnits=e.DistanceUnits,o.Dropdown=e.Dropdown,o.DropdownButton=e.DropdownButton,o.DropdownItem=e.DropdownItem,o.DropdownMenu=e.DropdownMenu,o.ListGroupItem=e.ListGroupItem,o.Pagination=e.Pagination,o.Popper=e.Popper,o.TextAlignValue=e.TextAlignValue,o.TextInput=e.TextInput,o.WidgetPlaceholder=e.WidgetPlaceholder,o._Link=e._Link,o.defaultMessages=e.defaultMessages,o.styleUtils=e.styleUtils,o.utils=e.utils},function(e){s.LayoutEntry=e.LayoutEntry,s.LayoutItemSizeModes=e.LayoutItemSizeModes,s.searchUtils=e.searchUtils},function(e){n.Fragment=e.Fragment,n.PureComponent=e.PureComponent,n.createElement=e.createElement,n.forwardRef=e.forwardRef},function(e){r.SqlExpressionRuntime=e.SqlExpressionRuntime,r.updateSQLExpressionByVersion=e.updateSQLExpressionByVersion}],execute:function(){e((()=>{var e={65354:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm5-3a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4Zm0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4Zm0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4ZM2 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm0 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z" fill="#FFF" fill-rule="nonzero"></path></svg>'},81411:e=>{e.exports='<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.5.995c0-.55-.43-.995-.96-.995H2.46a.94.94 0 0 0-.605.223 1.02 1.02 0 0 0-.14 1.4L6.5 7.72c.122.156.196.347.212.548l.835 10.815c.007.092.027.183.058.27a.951.951 0 0 0 1.237.582l2.112-.82a.99.99 0 0 0 .615-.797l1.325-10.062c.025-.193.105-.374.228-.52l5.141-6.087c.154-.181.238-.414.238-.655ZM2.5 1h14.999l-5.141 6.09-.117.153a2.016 2.016 0 0 0-.34.883l-1.325 10.062-2.035.792-.833-10.788-.02-.169a2.012 2.012 0 0 0-.402-.92L2.502 1.006 2.5 1Z" fill="#000"></path></svg>'},33869:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 7.5a.522.522 0 0 1-.516.527H2.976L6.473 11.6a.535.535 0 0 1 0 .746.508.508 0 0 1-.73 0L1 7.5l4.743-4.846a.508.508 0 0 1 .73 0 .535.535 0 0 1 0 .746L2.976 6.973h11.508c.285 0 .516.236.516.527Z" fill="#000"></path></svg>'},59788:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z" fill="#000"></path></svg>'},11407:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.347 2.146a.485.485 0 0 1 0 .708L5.76 8l5.587 5.146a.486.486 0 0 1 0 .708.538.538 0 0 1-.738 0l-5.956-5.5a.485.485 0 0 1 0-.708l5.956-5.5a.538.538 0 0 1 .738 0Z" fill="#000"></path></svg>'},3273:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.538.538 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.538.538 0 0 1-.738 0Z" fill="#000"></path></svg>'},96009:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .538.538 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.538.538 0 0 1 0 .738Z" fill="#000"></path></svg>'},55339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z" fill="#000"></path></svg>'},65283:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.438 1C.196 1 0 1.224 0 1.5s.196.5.438.5h15.124c.242 0 .438-.224.438-.5s-.196-.5-.438-.5H.438ZM0 7.5c0-.276.196-.5.438-.5h15.124c.242 0 .438.224.438.5s-.196.5-.438.5H.438C.196 8 0 7.776 0 7.5ZM0 13.5c0-.276.196-.5.438-.5h15.124c.242 0 .438.224.438.5s-.196.5-.438.5H.438C.196 14 0 13.776 0 13.5Z" fill="#000"></path></svg>'},27218:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8Z" fill="#000"></path></svg>'},30224:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0Zm-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707l-4.137-4.137Z" fill="#000"></path></svg>'},48957:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.88 2.825a.5.5 0 0 0-.759-.65l-2.323 2.71-1.265-1.265a.5.5 0 1 0-.707.707l1.265 1.265a1 1 0 0 0 1.466-.056l2.323-2.71Zm0 8a.5.5 0 0 0-.759-.65l-2.323 2.71-1.265-1.265a.5.5 0 1 0-.707.708l1.265 1.264a1 1 0 0 0 1.466-.056l2.323-2.71ZM9 4.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5ZM8.5 13a.5.5 0 0 0 0-1h-8a.5.5 0 0 0 0 1h8Z" fill="#000"></path></svg>'},87830:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5ZM16 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5ZM5.146 2.12a.5.5 0 0 1 .055.705l-2.324 2.71a1 1 0 0 1-1.466.057L.146 4.327a.5.5 0 0 1 .708-.707l1.264 1.265 2.323-2.71a.5.5 0 0 1 .705-.055ZM5.146 10.12a.5.5 0 0 1 .055.705l-2.324 2.71a1 1 0 0 1-1.466.057L.146 12.328a.5.5 0 1 1 .708-.708l1.264 1.265 2.323-2.71a.5.5 0 0 1 .705-.055Z" fill="#000"></path></svg>'},41235:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m2.116 1.5.969 1.678H1.05v3H0l1.5 2 1.5-2h-.951v-2h1.614l4.618 8H2.049v-2H1.05v3h7.809l1.257 2.178.866-.5L2.982 1l-.866.5Zm9.982 8.678h.95v2h-2.611l.576 1h3.036v-3h1.05l-1.501-2-1.5 2Zm.951-4v-2H5.817l-.578-1h8.81v3h-1Z" fill="#000"></path></svg>'},60397:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.049 6V3h13v3h-1V4h-11v2H3L1.5 7.999 0 6h1.049Zm12 4h-.952l1.5-2 1.5 2h-1.049v3H1.05v-3h1v2h11v-2Z" fill="#000"></path></svg>'},43036:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m11.366 7.841-.732-.682-3.125 3.349-1.635-1.84-.748.664 2.365 2.66 3.875-4.15Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 3V1.167C4.5.469 5.204 0 6 0h4c.796 0 1.5.47 1.5 1.167V3h4a.5.5 0 0 1 0 1H14l-.929 11.077a1 1 0 0 1-.997.923H3.926a1 1 0 0 1-.997-.923L2 4H.5a.5.5 0 0 1 0-1h4ZM3.003 4h9.994l-.923 11H3.926L3.003 4ZM10.5 1v2h-5V1c0-.04 5-.04 5 0Z" fill="#000"></path></svg>'},79964:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2.125 14.334 14H1.667L8 2.125Zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47L7.118 1.653ZM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995Zm1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="#000"></path></svg>'},48891:e=>{"use strict";e.exports=i},51315:e=>{"use strict";e.exports=n},74758:e=>{"use strict";e.exports=s},30726:e=>{"use strict";e.exports=o},15506:e=>{"use strict";e.exports=r}},t={};function l(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,l),s.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var i in t)l.o(t,i)&&!l.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var a={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(a),l.d(a,{Widget:()=>Et,default:()=>At});var e=l(48891),t=l(30726);const i=20;var o,s,n,r,d,c,u,h,p,g,m,f;!function(e){e.None="NONE",e.Arrangement="ARRANGEMENT",e.States="STATES",e.Tools="TOOLS"}(o||(o={})),function(e){e.AUTO="Auto",e.CUSTOM="Custom"}(s||(s={})),function(e){e.None="NONE",e.Single="SINGLE",e.Multiple="MULTIPLE"}(n||(n={})),function(e){e.Scroll="SCROLL",e.MultiPage="MULTIPAGE"}(r||(r={})),function(e){e.Start="FLEX-START",e.Center="CENTER",e.End="FLEX-END"}(d||(d={})),function(e){e.Horizon="HORIZON",e.Vertical="VERTICAL"}(c||(c={})),function(e){e.Row="ROW",e.Column="COLUMN",e.GRID="GRID"}(u||(u={})),function(e){e.Glide="GLIDE",e.Fade="FADE",e.Float="FLOAT"}(h||(h={})),function(e){e.Hover0="HOVER0",e.Hover1="HOVER1",e.Hover2="HOVER2",e.Hover3="HOVER3"}(p||(p={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3"}(g||(g={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3",e.Style4="STYLE4",e.Style5="STYLE5",e.Style6="STYLE6",e.Style7="STYLE7",e.Style8="STYLE8",e.Style9="STYLE9"}(m||(m={})),function(e){e.Regular="REGULAR",e.Selected="SELECTED",e.Hover="HOVER"}(f||(f={}));var v=l(74758),S=function(e,t,i,o){return new(i||(i=Promise))((function(s,n){function r(e){try{a(o.next(e))}catch(e){n(e)}}function l(e){try{a(o.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};function y(t,i,o,s=!1){const n=i.searchFields.split(","),r=!s&&i.searchExact?e.ClauseOperator.StringOperatorIs:e.ClauseOperator.StringOperatorContains;if(i.searchOpen&&i.searchFields){const i=n.map((i=>e.dataSourceUtils.createSQLClause(i,r,t))),s=e.dataSourceUtils.createSQLExpression(e.ClauseLogic.Or,i);return e.dataSourceUtils.getArcGISSQL(s,o)}}function w(e,t){if(!t)return e;const i=new RegExp(`(${t})`,"gi");return e.replace(i,"<strong >$1</strong>")}const b=e.utils.memoize((function(t){const{showTopTools:i,bottomToolH:o,topRightToolW:s,hasRecords:n,currentCardSize:l,pageStyle:a,scrollBarOpen:d,appMode:h,theme:p,isHeightAuto:g,isWidthAuto:m,listTemplateDefaultCardSize:f,layoutType:v,listLeftPadding:S}=t,y=i?42:0,w=v===u.Column?c.Horizon:c.Vertical,b=v===u.Column,x=v===u.Column?"column":"row";return e.css`
    &.list-container {
      /* position: ${g?"absolute":"relative"}; */
      position: relative;
      z-index: 0;
      overflow: hidden;
      .bottom-boundary {
        height: 2px;
        width: 2px;
        position: absolute;
        bottom: 0;
        right: 0;
        opacity: 0;
      }
      ${w===c.Horizon?`\n          margin-left: 0px;\n          height: ${g?"auto":"100%"};\n          width: ${m?"auto":"calc(100% - 0px)"};\n        `:`\n          margin-top: 0px;\n          width: ${m?"auto":"100%"};\n          height: ${g?"auto":"calc(100% - 0px)"};\n        `}

      .editing-mask-con {
        &:before {
          content: '';
          position: absolute;
          left: 0;
          top: ${y}px;
          z-index: 10;
          height: ${l.height}px;
          width: ${S}px;
          background-color: ${e.polished.rgba(p.colors.black,.2)};
        }
        .editing-mask-list-grid {
          position: absolute;
          left: ${l.width+S}px;
          top: ${y}px;
          right: 0;
          z-index: 10;
          height: ${l.height}px;
          background-color: ${e.polished.rgba(p.colors.black,.2)};
        }
      }
      .editing-mask-list {
        position: absolute;
        top: ${v!==u.Column&&n?l.height+y:y}px;
        left: ${v===u.Column&&n?l.width:0}px;
        bottom: ${e.polished.rem(o)};
        right: 0;
        z-index: 10;
        background-color: ${e.polished.rgba(p.colors.black,.2)};
      }

      .editing-mask-ds-tool {
        position: absolute;
        z-index: 10;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background-color: ${e.polished.rgba(p.colors.black,.2)};
      }

      .editing-mask-bottom-tool {
        position: absolute;
        z-index: 10;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background-color: ${e.polished.rgba(p.colors.black,.2)};
      }

      .empty-con {
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        z-index: 10;
        transform: translateY(-50%);
        padding-top: ${y}px;
        .jimu-icon {
          color: ${p.colors.palette.warning[900]};
        }
        .discribtion {
          margin: ${e.polished.rem(9)} 0 ${e.polished.rem(8)} 0;
          font-size: ${e.polished.rem(14)};
          color: ${p.colors.black}
        }
        .clear-message-action-button {
          width: ${e.polished.rem(65)};
        }
      }

      .datasource-tools {
        position: relative;
        height: ${e.polished.rem(y)};
        padding-bottom: ${e.polished.rem(14)};
        .sort-fields-input {
          width: 200px;
          margin-left: 8px;
          margin-right: 16px;
        }

        .tool-row {
          height: ${28}px;
        }
        .ds-tools-line {
          width: 100%;
          height: 1px;
          margin-top: ${e.polished.rem(6)};
          background-color: ${p.colors.palette.light[500]};
        }
        .ds-tools-line-blue {
          background-color: ${p.colors.palette.info[500]};
        }
        .list-search-div {
          width: calc(100% - ${s}px);
          .list-search {
            margin-bottom: ${e.polished.rem(-4)};
            width: 100%;
          }
        }

      }
      .tools-menu {
        color: ${p.colors.palette.light[800]};
      }
      .tools-menu:hover {
        color: ${p.colors.palette.info[500]};
      }
      .bottom-tools {
        position: relative;
        padding-top: ${e.polished.rem(14)};
        min-height: ${e.polished.rem(40)};
        .scroll-navigator {
          .btn {
            border-radius: ${p.borderRadiuses.circle};
          }
        }
      }

      .widget-list-list:focus {
        outline: none;
      }
      .widget-list-list {
        & {
          padding: 0;
          position: relative;
          padding-left: ${`${S}px`};
        }
        &>div {
          position: relative;
          flex: 1;
          box-sizing: content-box;
        }
        /* box-sizing: border-box; */
        ${window.jimuConfig.isInBuilder&&h!==e.AppMode.Run?"overflow: hidden !important;":`overflow-${b?"y":"x"}: hidden !important;`}
        height: ${g?"auto":`calc(100% - ${y}px - ${o}px)`} !important;
        width: ${m?"auto":"100%"} !important;
        display: flex;
        ${`flex-direction: ${x}`};
        ${g&&`min-height: ${f.height}px;`};
        ${m&&`min-width: ${f.width}px;`};
        ${b?`\n              max-width: ${t.mexSize.maxWidth};\n            `:`\n              max-height: calc(${t.mexSize.maxHeight} - ${y}px - ${o}px);\n            `}
      }
      .hide-list {
        overflow: hidden !important;
      }
      ${a!==r.Scroll||d?"":"\n          .widget-list-list::-webkit-scrollbar {\n            display: none; //Safari and Chrome\n          }\n          .widget-list-list {\n              -ms-overflow-style: none; //IE 10+\n              overflow: -moz-scrollbars-none; //Firefox\n          }\n        "}
      .placeholder-alert-con {
        position: absolute;
        bottom: ${e.polished.rem(8)};
        right: ${e.polished.rem(8)};
        z-index: 11;
      }
    }
  `}));function x(t,i,o){var s,n,r,l,a,d,u,h,p,g;const{config:m,id:f,appMode:v,isHeightAuto:S,isWidthAuto:y,theme:w}=t;return e.css`
    ${"&.list-widget-"+f} {
      overflow: visible;
      background-color: transparent;
      border: ${e.polished.rem(0)} solid ${e.polished.rgba(w.colors.black,window.jimuConfig.isInBuilder&&i?.2:0)};
      height: ${S?"auto":"100%"};
      width: ${y?"auto":"100%"};
      .list-with-mask {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        background-color: ${e.polished.rgba(w.colors.black,0)};
        z-index: 1;
      }
      .list-toggle-button {
        background: none;
      }
      .list-loading-con {
        min-height: ${e.polished.rem(120)};
        min-width: ${e.polished.rem(160)};
      }
      .refresh-loading-con {
        right: 0;
        bottom:${o?e.polished.rem(40):0};
        align-items: center;
        height: ${e.polished.rem(24)};
        .auto-refresh-loading {
          background: ${e.polished.rgba(null===(r=null===(n=null===(s=w.colors)||void 0===s?void 0:s.palette)||void 0===n?void 0:n.dark)||void 0===r?void 0:r[100],.2)};
          color: ${null===(l=w.colors)||void 0===l?void 0:l.black};
          font-size: ${e.polished.rem(12)};
          line-height: ${e.polished.rem(24)};
          padding: 0 ${e.polished.rem(7)};
        }
        &.horizon-loading {
          bottom:${o?e.polished.rem(46):e.polished.rem(6)};
        }
        &.vertical-loading {
          right: ${e.polished.rem(6)};
        }
      }
      .loading-con {
        @keyframes loading {
          0% {transform: rotate(0deg); };
          100% {transform: rotate(360deg)};
        }
        width: ${e.polished.rem(16)};
        height: ${e.polished.rem(16)};
        border: 1px solid ${null===(u=null===(d=null===(a=null==w?void 0:w.colors)||void 0===a?void 0:a.palette)||void 0===d?void 0:d.dark)||void 0===u?void 0:u[100]};
        border-radius: 50%;
        border-top: 1px solid ${null===(g=null===(p=null===(h=null==w?void 0:w.colors)||void 0===h?void 0:h.palette)||void 0===p?void 0:p.dark)||void 0===g?void 0:g[800]};
        box-sizing: border-box;
        animation:loading 2s infinite linear;
        margin-right: ${e.polished.rem(4)};
      }
      .widget-list {
        overflow: ${window.jimuConfig.isInBuilder&&v!==e.AppMode.Run?"hidden":"auto"};
        height: ${S?"auto":"100%"};
        width: ${y?"auto":"100%"};
        /* align-items: ${m.alignType};
        justify-content: ${m.alignType}; */
        ${m.direction===c.Horizon?"\n            overflow-y: hidden;\n          ":"\n            overflow-x: hidden;\n          "}
      }
    }

  `}function I(t){const{theme:i}=t;return e.css`
    & {
      padding: ${e.polished.rem(6)} ${e.polished.rem(11)};
      height: ${e.polished.rem(40)};
    }
    .ds-tools-line {
      width: 100%;
      height: 1px;
      background-color: ${i.colors.palette.light[500]};
    }
    .ds-tools-line-blue {
      background-color: ${i.colors.palette.info[500]};
    }
    .close-search {
      margin-top: ${e.polished.rem(-6)};
    }
  `}function C(t){const{theme:i}=t;return e.css`
    .close-search {
      border: 1px solid ${i.colors.palette.light[500]};
      box-sizing: border-box;
      background-color: ${i.colors.white};
    }
    .search-box-content {
      flex-direction: column;
      align-items: flex-start;
    }
  `}class R extends e.React.Component{constructor(){super(...arguments),this.getNewProviderData=()=>{const{widgetId:e,datasourceId:t,index:i,record:o}=this.props;return{widgetId:e,dataSourceId:t,recordIndex:i,record:o}},this.shouldComponentUpdateExcept=(e,t,i,o=[])=>{let s=!1;return this.props&&Object.keys(this.props).some((t=>!i.includes(t)&&this.props[t]!==e[t]&&(s=!0,!0))),this.state&&Object.keys(this.state).some((e=>!o.includes(e)&&this.state[e]!==t[e]&&(s=!0,!0))),s},this.isProviderEqual=(e,t)=>{let i=!0;if(e)Object.keys(e).some((o=>t?e[o]!==t[o]&&(i=!1,!0):(i=!1,!0)));else if(t)return!1;return i},this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.getStyle=t=>{const{widgetId:i,selectable:o,appMode:s,theme:n}=this.props,r=this.checkIsBackgroundTransparent(t);return e.css`
      ${"&.list-card-"+i} {
        padding: 0;
        border: 0;
        background-color: transparent;
        &:focus {
          outline: ${e.polished.rem(2)} solid ${n.colors.palette.primary[700]};
          outline-offset: ${e.polished.rem(2)};
        }
        .list-card-content {
          width: 100%;
          height: 100%;
        }
      }
      &.surface-1 {
        border: none !important;
        background: ${r&&"none !important"};
      }
      .list-clear-background {
        background: transparent !important;
      }
      .list-link {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
      }
      .list-item-con {
        overflow: hidden;
      }
      ${"&.list-card-"+i}:hover {
        ${window.jimuConfig.isInBuilder&&s!==e.AppMode.Run||!o?"":"cursor: pointer;"}
      }
      .card-editor-mask {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 100;
      }
      .jimu-link {
        text-align: left;
      }
    `}}checkIsBackgroundTransparent(e){var t,i,o;const{cardConfigs:s}=this.props;return"rgba(0,0,0,0)"===(null===(o=null===(i=null===(t=null==s?void 0:s[e])||void 0===t?void 0:t.backgroundStyle)||void 0===i?void 0:i.background)||void 0===o?void 0:o.color)}}var T=l(60397),M=l.n(T);const O=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:M()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var L=l(41235),j=l.n(L);const z=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:j()},s)):e.React.createElement("svg",Object.assign({className:n},s))},D=[0,5],k=[{name:"flip",options:{boundary:document.body,fallbackPlacements:["right-start","left-start","bottom-start","top-end","top-start"]}}],P=[{name:"offset",options:{offset:[0,10]}},{name:"arrow",enabled:!0}],E=e.ReactRedux.connect(((t,i)=>{var o;const{selectionIsList:s,builderSupportModules:n,appMode:r,widgetId:l,browserSizeMode:a}=i;if(!window.jimuConfig.isInBuilder||r===e.AppMode.Run)return{selection:void 0,showBreak:!1};const d=null===(o=null==n?void 0:n.widgetModules)||void 0===o?void 0:o.searchUtils,c=n.jimuForBuilderLib.getAppConfigAction().appConfig,u=0===i.index&&i.selectionIsInList&&t&&t.appRuntimeInfo&&t.appRuntimeInfo.selection;return{selection:u,showBreak:!s&&u&&d&&d.getRelatedLayoutItemsInWidgetByLayoutInfo(c,u,l,a).length>1}}))(class extends R{constructor(t){super(t),this.lastResizeCall=null,this.getNewCardSize=(e,t=!1)=>{const{keepAspectRatio:i,layoutType:o,gridItemSizeRatio:s,horizontalSpace:n,isWidthPercentage:r}=this.props;let l,a=e.right-e.left;return!t&&r&&(a=e.right-e.left+n),l=o===u.GRID&&i?{width:a,height:a*s}:{width:a,height:e.bottom-e.top},l},this.handleItemClick=e=>{const{selectCard:t}=this.props;e&&e.stopPropagation(),t()},this.handleCopyTo=(t,i,o,s)=>{if(!o)return;const{layouts:n,builderSupportModules:r,browserSizeMode:l,builderStatus:a}=this.props,d=r.jimuForBuilderLib.getAppConfigAction(),c=d.appConfig,u=v.searchUtils.findLayoutId(n[a],l,c.mainSizeMode),h=v.searchUtils.findLayoutId(n[i],l,c.mainSizeMode);if(s){const t=r.widgetModules.searchUtils.getContainerLayoutItem(c.layouts[h],o.widgetId,e.LayoutItemType.Widget);t&&d.removeLayoutItem({layoutId:h,layoutItemId:t.id},!1)}d.duplicateLayoutItem(u,h,o.id,!1,s),d.exec(),t.stopPropagation(),t.nativeEvent.stopImmediatePropagation()},this.editStatus=(t,i)=>{const{dispatch:o,widgetId:s}=this.props;o(e.appActions.widgetStatePropChange(s,t,i))},this.handleBreakLink=t=>{const{layouts:i,builderSupportModules:o,browserSizeMode:s,selection:n,builderStatus:r,dispatch:l}=this.props,a=o.jimuForBuilderLib.getAppConfigAction(),d=a.appConfig,c=v.searchUtils.findLayoutItem(d,n);if(!c)return;const u=v.searchUtils.findLayoutId(i[r],s,d.mainSizeMode);a.duplicateLayoutItem(u,u,c.id,!0),a.removeLayoutItem({layoutId:u,layoutItemId:c.id},!1),a.exec(),n.layoutId===u&&n.layoutItemId===c.id&&l(e.appActions.selectionChanged(null));const h=a.appConfig.layouts[u].content,p=Object.keys(h)[Object.keys(h).length-1];if(p){const t=h[p];l(e.appActions.selectionChanged({layoutId:u,layoutItemId:t.id}))}t.stopPropagation(),t.nativeEvent.stopImmediatePropagation()},this.getCopyDropdownItems=t=>{var i,o;const{cardConfigs:r,layouts:l,browserSizeMode:a,selection:d,builderStatus:c,builderSupportModules:u}=this.props,h=u.jimuForBuilderLib.getAppConfigAction().appConfig,p=v.searchUtils.findLayoutItem(h,d);if(!d||!p||!window.jimuConfig.isInBuilder)return{items:(0,e.Immutable)([]),title:""};const g=[];let m="",S=!0,y=r[f.Selected].selectionMode!==n.None,w=!!r[f.Hover].enable;const b=(t,i)=>u.widgetModules.searchUtils.getContentsInLayoutWithRecrusiveLayouts(h,t,e.LayoutItemType.Widget,a).indexOf(i)>-1,x=(null===(i=r[f.Hover])||void 0===i?void 0:i.listLayout)!==(null==s?void 0:s.AUTO),I=(null===(o=r[f.Selected])||void 0===o?void 0:o.listLayout)!==(null==s?void 0:s.AUTO),C=()=>{if(r[f.Hover].enable){const e=v.searchUtils.findLayoutId(l[f.Hover],a,h.mainSizeMode);b(e,h.layouts[d.layoutId].content[d.layoutItemId].widgetId)||(w=!1),g.push({label:this.formatMessage("applyTo",{status:this.formatMessage("hover").toLocaleLowerCase()}),event:e=>{this.handleCopyTo(e,f.Hover,p,w)}})}},R=()=>{if(r[f.Selected].selectionMode!==n.None){const e=v.searchUtils.findLayoutId(l[f.Selected],a,h.mainSizeMode);b(e,h.layouts[d.layoutId].content[d.layoutItemId].widgetId)||(y=!1),g.push({label:this.formatMessage("applyTo",{status:this.formatMessage("selected").toLocaleLowerCase()}),event:e=>{this.handleCopyTo(e,f.Selected,p,y)}})}},T=()=>{const e=v.searchUtils.findLayoutId(l[f.Regular],a,h.mainSizeMode);b(e,h.layouts[d.layoutId].content[d.layoutItemId].widgetId)||(S=!1),g.push({label:this.formatMessage("applyTo",{status:this.formatMessage("default").toLocaleLowerCase()}),event:e=>{this.handleCopyTo(e,f.Regular,p,S)}})};return c===f.Regular?(x&&C(),I&&R(),w&&y?m=this.formatMessage("linkedToAnd",{where1:this.formatMessage("selected").toLocaleLowerCase(),where2:this.formatMessage("hover").toLocaleLowerCase()}):w?m=this.formatMessage("linkedTo",{where:this.formatMessage("hover").toLocaleLowerCase()}):y&&(m=this.formatMessage("linkedTo",{where:this.formatMessage("selected").toLocaleLowerCase()}))):c===f.Hover?(T(),R(),S&&y?m=this.formatMessage("linkedToAnd",{where1:this.formatMessage("default").toLocaleLowerCase(),where2:this.formatMessage("selected").toLocaleLowerCase()}):S?m=this.formatMessage("linkedTo",{where:this.formatMessage("default").toLocaleLowerCase()}):y&&(m=this.formatMessage("linkedTo",{where:this.formatMessage("selected").toLocaleLowerCase()}))):(T(),C(),S&&w?m=this.formatMessage("linkedToAnd",{where1:this.formatMessage("default").toLocaleLowerCase(),where2:this.formatMessage("hover").toLocaleLowerCase()}):S?m=this.formatMessage("linkedTo",{where:this.formatMessage("default").toLocaleLowerCase()}):w&&(m=this.formatMessage("linkedTo",{where:this.formatMessage("hover").toLocaleLowerCase()}))),t?g.push({label:this.formatMessage("isolate"),event:this.handleBreakLink}):m=this.formatMessage("isolate"),{items:(0,e.Immutable)(g),title:m}},this._renderAction=()=>{const t=[],{theme:i,layoutType:o,keepAspectRatio:s}=this.props,n=e.css`
      box-shadow: none;

      &:after {
        position: absolute;
        content: '';
        width: ${12}px;
        height: ${12}px;
        background-color: ${i.colors.palette.primary[500]};
        border: 2px solid ${i.colors.white};
        border-radius: 50%;
        z-index: ${20};
      }
    `,r=e.css`
      box-shadow: none;
      height: ${16}px;
      left: 0px;
      right: 0px;
      bottom: ${-8}px;
      &:after {
        position: absolute;
        content: '';
        bottom: 50%;
        left: 0;
        right: 0;
        height: 2px;
        background-color: ${i.colors.palette.primary[300]};
        z-index: ${20};
      }
    `,l=e.css`
      box-shadow: none;
      width: ${16}px;
      top: 0px;
      bottom: 0px;
      right: ${-8}px;
      &:after {
        position: absolute;
        content: '';
        right: 50%;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: ${i.colors.palette.primary[300]};
        z-index: ${20};
      }
    `,a=e.css`
      position: absolute;
    `,d=e.css`
      width: ${16}px;
      top: ${10}px;
      bottom: ${10}px;
      right: ${-8}px;

      &:after {
        top: 50%;
        right: 50%;
        margin-top: ${-5}px;
        margin-right: ${-5}px;
      }
    `,c=e.css`
      height: ${16}px;
      left: ${10}px;
      right: ${10}px;
      bottom: ${-8}px;

      &:after {
        left: 50%;
        bottom: 50%;
        margin-left: ${-5}px;
        margin-bottom: ${-5}px;
      }
    `;switch(o){case u.Column:t.push((0,e.jsx)("span",{key:"10",className:"list-card-rnd-resize-left-line",css:[a,l]})),t.push((0,e.jsx)("span",{key:"4",className:"list-card-rnd-resize-right",css:[a,n,d]}));break;case u.Row:t.push((0,e.jsx)("span",{key:"9",className:"list-card-rnd-resize-bottom-line",css:[a,r]})),t.push((0,e.jsx)("span",{key:"6",className:"list-card-rnd-resize-bottom",css:[a,n,c]}));break;case u.GRID:t.push((0,e.jsx)("span",{key:"10",className:"list-card-rnd-resize-left-line",css:[a,l]})),t.push((0,e.jsx)("span",{key:"4",className:"list-card-rnd-resize-right",css:[a,n,d]})),s||(t.push((0,e.jsx)("span",{key:"9",className:"list-card-rnd-resize-bottom-line",css:[a,r]})),t.push((0,e.jsx)("span",{key:"6",className:"list-card-rnd-resize-bottom",css:[a,n,c]})))}return t},this.getCardToolsStyle=t=>e.css`
      width: 100%;
      .btn {
        width: 100%;
      }
      .dropdown-toggle {
        justify-content: center;
      }
    `,this.renderCardTools=()=>{const{index:t}=this.props;if(!window.jimuConfig.isInBuilder||t>0)return;const{cardConfigs:i,appMode:o,builderSupportModules:s,datasourceId:r,selectionIsInList:l,selectionIsList:a,hideCardTool:d}=this.props;let c=!0;const{BuilderPopper:u,GLOBAL_RESIZING_CLASS_NAME:h,GLOBAL_H5_DRAGGING_CLASS_NAME:p,GLOBAL_DRAGGING_CLASS_NAME:g}=s.widgetModules;return(l||a)&&o!==e.AppMode.Run&&!d&&r||(c=!1),c&&this.props.isEditing&&(i[f.Hover].enable||i[f.Selected].selectionMode!==n.None)&&(0,e.jsx)(u,{placement:"left-start",trapFocus:!1,autoFocus:!1,css:e.css`
            .${g} &,
            .${h} &,
            .${p} & {
              &.popper {
                display: none;
              }
            }
          `,reference:this.resizeRef.current,offset:D,modifiers:k,open:c},this.getCardMenuElement())},this.getCardMenuElement=()=>{var t;const{index:i}=this.props;if(!window.jimuConfig.isInBuilder||i>0)return;const{cardConfigs:o,selection:r,widgetId:l,builderSupportModules:a,browserSizeMode:d,builderStatus:c,selectionIsList:u}=this.props,h=a.jimuForBuilderLib.getAppConfigAction().appConfig,{searchUtils:p,BuilderDropDown:g,BuilderButton:m,withBuilderTheme:v}=a.widgetModules,S=u,y=!S&&r&&p&&p.getRelatedLayoutItemsInWidgetByLayoutInfo(h,r,l,d).length>1,{items:w,title:b}=this.getCopyDropdownItems(y),x=w&&w.length>0,I=(null===(t=o[c])||void 0===t?void 0:t.listLayout)||s.CUSTOM,C=!S&&(x||y)&&I===s.CUSTOM,R=v((t=>(0,e.jsx)("div",{className:"status-group d-flex flex-column align-items-center p-2",css:this.getCardToolsStyle(t)},(0,e.jsx)(m,{active:c===f.Regular,onClick:e=>this.handleBuilderStatusChange(e,f.Regular)},this.formatMessage("default")),o[f.Hover].enable&&(0,e.jsx)(m,{active:c===f.Hover,className:"mt-1",onClick:e=>this.handleBuilderStatusChange(e,f.Hover)},this.formatMessage("hover")),o[f.Selected].selectionMode!==n.None&&(0,e.jsx)(m,{active:c===f.Selected,className:"mt-1",onClick:e=>this.handleBuilderStatusChange(e,f.Selected)},this.formatMessage("selected")),C&&(0,e.jsx)(g,{className:"mt-1 w-100",toggleIsIcon:!0,toggleTitle:b,toggleType:"default",direction:"left",toggleArrow:!1,toggleContent:t=>y?(0,e.jsx)(O,{size:16}):(0,e.jsx)(z,{size:16}),modifiers:P,items:w}))));return(0,e.jsx)(R,null)},this.isItemAccept=(e,t)=>{var i,o;if(!e)return!1;const{isEditing:s}=this.props,n=null===(o=null===(i=e.manifest)||void 0===i?void 0:i.properties)||void 0===o?void 0:o.supportRepeat,{builderSupportModules:r,widgetId:l}=this.props,a=r.jimuForBuilderLib.getAppConfigAction().appConfig,d=r.widgetModules.selectionInList;return s&&n&&(!e.layoutInfo||e.layoutInfo&&d(e.layoutInfo,l,a,!1))},this.getEditorStyle=()=>e.css`
      &.list-card-content {
        .fixed-layout {
          border: 0 !important;
        }
      }
    `,this.state={didMount:!1},this.resizeRef=e.React.createRef(),this.providerData=this.getNewProviderData()}shouldComponentUpdate(t,i){let o=this.shouldComponentUpdateExcept(t,i,["listStyle","selection"]);if(o=o||!e.utils.isDeepEqual(this.props.listStyle,t.listStyle),!o){const{selectionIsInList:i,selectionIsList:s}=this.props;(s||i)&&(o=!e.utils.isDeepEqual(this.props.selection,t.selection))}return o}componentDidUpdate(e){const{selectionIsInList:t,isEditing:i,layoutType:o,isRTL:s,lockItemRatio:n,keepAspectRatio:r,index:l}=this.props;window.jimuConfig.isInBuilder&&0===l&&this.interactable&&(i&&!t?o===u.GRID?(this.interactable.resizable({edges:{top:!1,left:s,bottom:!r,right:!s}}),this.interactable.resizable(!0)):n||(this.interactable.resizable({edges:{top:!1,left:o===u.Column&&s,bottom:o===u.Row,right:o===u.Column&&!s}}),this.interactable.resizable(!0)):this.interactable.resizable(!1))}componentDidMount(){const{index:e,layoutType:t,updateCardToolPosition:o,keepAspectRatio:s}=this.props;if(0===e&&window.jimuConfig.isInBuilder&&this.resizeRef.current){const{interact:e,handleResizeCard:n,isRTL:r}=this.props;this.interactable=e(this.resizeRef.current).resizable({edges:{top:!1,left:(t===u.Column||t===u.GRID)&&r,bottom:t===u.Row||t===u.GRID&&!s,right:(t===u.Column||t===u.GRID)&&!r},modifiers:[e.modifiers.restrictEdges({endOnly:!0}),e.modifiers.restrictSize({min:{width:i,height:i}})],inertia:!1,onstart:e=>{const{changeIsResizingCard:t}=this.props;t&&t(!0),e.stopPropagation()},onmove:e=>{e.stopPropagation(),this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall);const t=e.rect,i=this.getNewCardSize(t,!0);o(),this.lastResizeCall=requestAnimationFrame((()=>{const e={};n(i,!1,e.top,e.left)}))},onend:e=>{e.stopPropagation(),this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall),this.lastResizeCall=requestAnimationFrame((()=>{const t=e.rect,i=this.getNewCardSize(t);n(i,!0);const{changeIsResizingCard:o}=this.props;o&&o(!1)}))}})}this.setState({didMount:!0})}componentWillUnMount(){this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall),this.interactable&&(this.interactable.unset(),this.interactable=null)}handleBuilderStatusChange(e,t){this.editStatus("showCardSetting",t),this.editStatus("builderStatus",t);const{selectCard:i}=this.props;i(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}render(){var i;const{selectable:o,active:n,cardConfigs:r,LayoutEntry:l,selectionIsInList:a,isEditing:d,widgetId:c,listStyle:h,lockItemRatio:p,builderStatus:g,layouts:m,layoutType:v}=this.props,{didMount:S}=this.state,y=m[g],w=(null===(i=r[g])||void 0===i?void 0:i.listLayout)||s.CUSTOM,b=m[f.Regular],x=w===s.AUTO?b:y,I=r[g].backgroundStyle,C=w===s.AUTO&&g!==f.Regular,R=Object.assign({},t.styleUtils.toCSSStyle(I||{})),T=Object.assign({},t.styleUtils.toCSSStyle({borderRadius:(null==I?void 0:I.borderRadius)||0}||{})),M=this.getNewProviderData();this.isProviderEqual(M,this.providerData)||(this.providerData=M);const O=v!==u.GRID&&p;return(0,e.jsx)(e.RepeatedDataSourceProvider,{data:this.providerData},(0,e.jsx)(t.ListGroupItem,{active:o&&n,css:this.getStyle(g),style:Object.assign(Object.assign({},T),h),className:(0,e.classNames)("surface-1",`list-card-${c}`),onClick:this.handleItemClick,role:"listCardEditor"},C&&(0,e.jsx)("div",{className:"card-editor-mask position-absolute"}),S&&this.renderCardTools(),(0,e.jsx)("div",{className:"list-card-content d-flex",style:R,css:this.getEditorStyle(),ref:this.resizeRef},(0,e.jsx)(l,{isItemAccepted:this.isItemAccept,isRepeat:!0,layouts:x,isInWidget:!0}),d&&!a&&!O&&this._renderAction())))}});var A=l(51315);class N extends R{constructor(t){super(t),this.updateExpressionRecords=()=>{var e,t;this.expressionRecords={},(null===(e=this.providerData)||void 0===e?void 0:e.dataSourceId)&&(null===(t=this.providerData)||void 0===t?void 0:t.record)&&(this.expressionRecords[this.providerData.dataSourceId]=this.providerData.record)},this.onUrlExpResolveChange=e=>{if(e.isSuccessful)this.setState({url:e.value});else{const e="";this.setState({url:e})}},this.handleItemClick=e=>{const{onChange:t,active:i}=this.props,{providerData:o,linkRef:s}=this,n=e.target&&e.target.tagName||"";if("a"===n.toLowerCase()||"button"===n.toLowerCase()||"linkClick"===e.exbEventType||i||s.current&&s.current.click(),i){const i=e.target&&e.target.tagName||"";"a"!==i.toLowerCase()&&"button"!==i.toLowerCase()&&"linkClick"!==e.exbEventType&&t(o&&o.record)}else t(o&&o.record);"linkClick"===e.exbEventType&&delete e.exbEventType},this.handleLinkClick=e=>{e.stopPropagation()},this.state={url:""},this.providerData=this.getNewProviderData(),this.updateExpressionRecords(),this.layoutRef=e.React.createRef(),this.linkRef=e.React.createRef()}shouldComponentUpdate(t,i){let o=this.shouldComponentUpdateExcept(t,i,["listStyle"]);return o=o||!e.utils.isDeepEqual(this.props.listStyle,t.listStyle),o}render(){var i;const{selectable:o,active:n,cardConfigs:r,widgetId:l,listStyle:a,layouts:d,hoverLayoutOpen:c,appMode:u,isHover:h,linkParam:p,useDataSources:g,itemIdex:m,handleListMouseLeave:S,handleListMouseMove:y}=this.props;let{queryObject:w}=this.props;const{url:b}=this.state;let x,I,C,R,T=f.Regular;window.jimuConfig.isInBuilder&&u!==e.AppMode.Run?(I=r[f.Regular].backgroundStyle,x=d[f.Regular]):(x=d[f.Regular],I=r[f.Regular].backgroundStyle,p&&p.linkType&&(C=p.openType,R={linkType:p.linkType},p.linkType===e.LinkType.WebAddress?(R.value=b,w=void 0):R.value=p.value),c&&h&&d[f.Hover]&&(T=f.Hover,x=null==d?void 0:d[f.Hover],I=r[f.Hover].backgroundStyle),o&&n&&d[f.Selected]&&(T=f.Selected,x=null==d?void 0:d[f.Selected],I=r[f.Selected].backgroundStyle,w=void 0,R=void 0,C=void 0));const M=(null===(i=r[T])||void 0===i?void 0:i.listLayout)||s.CUSTOM,O=d[f.Regular],L=M===s.AUTO?O:x,j=Object.assign({},t.styleUtils.toCSSStyle(I||{})),z=Object.assign({},t.styleUtils.toCSSStyle({borderRadius:(null==I?void 0:I.borderRadius)||0}||{})),D=this.getNewProviderData();return this.isProviderEqual(D,this.providerData)||(this.providerData=D,this.updateExpressionRecords()),(0,e.jsx)(e.RepeatedDataSourceProvider,{data:this.providerData},(0,e.jsx)(t.ListGroupItem,{active:o&&n,css:this.getStyle(T),style:Object.assign(Object.assign({},a),z),className:(0,e.classNames)("surface-1",`list-card-${l}`),role:"listCardViewer",onClick:this.handleItemClick},(0,e.jsx)("div",{className:"list-card-content d-flex",onMouseLeave:S,onMouseMove:()=>{y(m)},style:j},(0,e.jsx)("div",{className:"position-relative h-100 w-100"},(0,e.jsx)(A.Fragment,null,(0,e.jsx)(t._Link,{className:"p-0 w-100 h-100 border-0 list-clear-background list-link",ref:this.linkRef,to:R,target:C,queryObject:w,onClick:this.handleLinkClick}),(0,e.jsx)("div",{className:"d-flex w-100 h-100 list-item-con",ref:this.layoutRef},(0,e.jsx)(v.LayoutEntry,{layouts:L}))))),(0,e.jsx)(e.ExpressionResolverComponent,{useDataSources:g,expression:null==p?void 0:p.expression,onChange:this.onUrlExpResolveChange,widgetId:this.props.widgetId})))}}var $=l(55339),B=l.n($);const _=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:B()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var H=l(30224),F=l.n(H);const U=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:F()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var W=l(33869),G=l.n(W);const V=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:G()},s)):e.React.createElement("svg",Object.assign({className:n},s))},q=new(0,e.esri.Sanitizer);class Z extends e.React.PureComponent{constructor(i){super(i),this.handleChange=e=>{this.setState({searchText:e,isShowSuggestion:(null==e?void 0:e.length)>2},(()=>{const{onSearchTextChange:t}=this.props;t&&t(e)}))},this.handleSubmit=(e,t=!1)=>{const{onSubmit:i}=this.props;i&&i(e,t)},this.onKeyUp=e=>{e&&e.target&&"Enter"===e.key&&(this.setState({isShowSuggestion:!1}),this.handleSubmit(e.target.value,!0))},this.onSuggestionConfirm=e=>{this.setState({searchText:e,isShowSuggestion:!1},(()=>{var t;this.handleSubmit(e),null===(t=this.props)||void 0===t||t.toggleSearchBoxVisible(!0)}))},this.handleClear=e=>{this.setState({searchText:""}),e.stopPropagation()},this.getStyle=()=>{var t,i,o,s,n,r,l,a,d;const{theme:c}=this.props;return e.css`
      position: relative;
      .search-input {
        margin-bottom: -1px;
        padding-left: 3px;
        border: 0;
        // border-bottom-width: 1px;
        // border-bottom-style: solid;
        // border-color: ${c.colors.primary};
        background: transparent;
        height: ${e.polished.rem(26)};
        min-width: 0;
        .input-wrapper {
          background: transparent;
          border: none;
          padding: 0;
          height: 100%;
        }
      }
      .search-input:focus {
        background: transparent;
      }
      .search-loading-con {
        @keyframes loading {
          0% {transform: rotate(0deg); };
          100% {transform: rotate(360deg)};
        }
        width: ${e.polished.rem(13)};
        height: ${e.polished.rem(13)};
        min-width: ${e.polished.rem(13)};
        border: 2px solid ${null===(o=null===(i=null===(t=null==c?void 0:c.colors)||void 0===t?void 0:t.palette)||void 0===i?void 0:i.secondary)||void 0===o?void 0:o[300]};
        border-radius: 50%;
        border-top: 2px solid ${null===(r=null===(n=null===(s=null==c?void 0:c.colors)||void 0===s?void 0:s.palette)||void 0===n?void 0:n.primary)||void 0===r?void 0:r[500]};
        box-sizing: border-box;
        animation:loading 2s infinite linear;
        margin-right: ${e.polished.rem(4)};
      }
      .clear-search, .search-back {
        cursor: pointer;
        padding: ${e.polished.rem(6)};
        background: none;
        border: none;
        color: ${null===(d=null===(a=null===(l=null==c?void 0:c.colors)||void 0===l?void 0:l.palette)||void 0===a?void 0:a.dark)||void 0===d?void 0:d[800]}
      }
      .search-back {
        margin-left: ${e.polished.rem(-6)};
      }
      .clear-search:hover {
        background: none;
      }
    `},this.getSuggestionListStyle=()=>{const{suggestionWidth:t}=this.props;return e.css`
      & {
        max-height: ${e.polished.rem(300)};
        min-width: ${e.polished.rem(t)};
        overflow: auto;
      }
      button {
        display: block;
        width: 100%;
        text-align: left;
        border: none;
        border-radius: 0;
      }
      button:hover {
        border: none;
      }
    `},this.clearSearchText=()=>{const{searchText:e}=this.state;e&&(this.handleChange(""),this.setState({isShowSuggestion:!1}))},this.getTextInputSuffixElement=()=>{const{theme:i,showLoading:o,formatMessage:s}=this.props,{searchText:n}=this.state;return(0,e.jsx)("div",{className:"d-flex align-items-center"},o&&(0,e.jsx)("div",{className:"search-loading-con"}),n&&(0,e.jsx)(t.Button,{color:"tertiary",className:"clear-search",icon:!0,size:"sm",onClick:this.clearSearchText,title:s("clearSearch")},(0,e.jsx)(_,{size:14,color:i.colors.palette.dark[800]})))},this.getTextInputPrefixElement=()=>{const{theme:i}=this.props;return(0,e.jsx)(t.Button,{type:"tertiary",icon:!0,size:"sm",onClick:e=>this.handleSubmit(this.state.searchText)},(0,e.jsx)(U,{size:16,color:i.colors.palette.light[800]}))},this.state={searchText:i.searchText||"",isShowSuggestion:!1}}componentDidUpdate(t){var i;if(this.props.searchText!==t.searchText&&this.props.searchText!==this.state.searchText){const{searchText:e}=this.props;this.setState({searchText:e})}(null===(i=this.props)||void 0===i?void 0:i.appMode)===e.AppMode.Design&&this.state.isShowSuggestion&&this.setState({isShowSuggestion:!1,searchText:""})}render(){const{placeholder:i,className:o,showClear:s,hideSearchIcon:n,inputRef:r,onFocus:l,onBlur:a,theme:d,searchSuggestion:c,formatMessage:u,isShowBackButton:h}=this.props,{searchText:p,isShowSuggestion:g}=this.state;return(0,e.jsx)("div",null,(0,e.jsx)("div",{css:this.getStyle(),className:`d-flex align-items-center ${o}`},h&&(0,e.jsx)(t.Button,{color:"tertiary",className:"search-back",icon:!0,size:"sm",onClick:e=>{var t;null===(t=this.props)||void 0===t||t.toggleSearchBoxVisible(!1)},title:u("topToolBack")},(0,e.jsx)(V,{size:20,color:d.colors.palette.dark[800]})),(0,e.jsx)(t.TextInput,{className:"search-input flex-grow-1",ref:r,placeholder:i,onChange:e=>this.handleChange(e.target.value),onBlur:a,onFocus:l,value:p||"",onKeyDown:e=>this.onKeyUp(e),prefix:!n&&!h&&this.getTextInputPrefixElement(),suffix:this.getTextInputSuffixElement()}),s&&(0,e.jsx)(t.Button,{color:"tertiary",icon:!0,size:"sm",onClick:this.handleSubmit},(0,e.jsx)(_,{size:12,color:d.colors.palette.dark[800]}))),(0,e.jsx)("div",{ref:e=>this.reference=e},(0,e.jsx)(t.Popper,{css:this.getSuggestionListStyle(),placement:"bottom-start",reference:this.reference,offset:[0,8],open:g,trapFocus:!1,autoFocus:!1,toggle:e=>{this.setState({isShowSuggestion:!g})}},c.map(((i,o)=>{const s=q.sanitize(i.suggestionHtml);return(0,e.jsx)(t.Button,{key:o,type:"secondary",size:"sm",onClick:()=>{this.onSuggestionConfirm(i.suggestion)},dangerouslySetInnerHTML:{__html:s}})})))))}}function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Q.apply(this,arguments)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}function X(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,K(e,t)}var J=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function ee(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!((o=e[i])===(s=t[i])||J(o)&&J(s)))return!1;var o,s;return!0}const te=function(e,t){var i;void 0===t&&(t=ee);var o,s=[],n=!1;return function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return n&&i===this&&t(r,s)||(o=e.apply(this,r),n=!0,i=this,s=r),o}};var ie="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function oe(e){cancelAnimationFrame(e.id)}function se(e,t){var i=ie(),o={id:requestAnimationFrame((function s(){ie()-i>=t?e.call(null):o.id=requestAnimationFrame(s)}))};return o}var ne=-1,re=null;function le(e){if(void 0===e&&(e=!1),null===re||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";var o=document.createElement("div"),s=o.style;return s.width="100px",s.height="100px",t.appendChild(o),document.body.appendChild(t),t.scrollLeft>0?re="positive-descending":(t.scrollLeft=1,re=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),re}return re}var ae=function(e){var t=e.columnIndex;return e.data,e.rowIndex+":"+t};function de(e){var t,i=e.getColumnOffset,o=e.getColumnStartIndexForOffset,s=e.getColumnStopIndexForStartIndex,n=e.getColumnWidth,r=e.getEstimatedTotalHeight,l=e.getEstimatedTotalWidth,a=e.getOffsetForColumnAndAlignment,d=e.getOffsetForRowAndAlignment,c=e.getRowHeight,u=e.getRowOffset,h=e.getRowStartIndexForOffset,p=e.getRowStopIndexForStartIndex,g=e.initInstanceProps,m=e.shouldResetStyleCacheOnItemSizeChange,f=e.validateProps;return(t=function(e){function t(t){var o;return(o=e.call(this,t)||this)._instanceProps=g(o.props,Y(o)),o._resetIsScrollingTimeoutId=null,o._outerRef=void 0,o.state={instance:Y(o),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof o.props.initialScrollLeft?o.props.initialScrollLeft:0,scrollTop:"number"==typeof o.props.initialScrollTop?o.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},o._callOnItemsRendered=void 0,o._callOnItemsRendered=te((function(e,t,i,s,n,r,l,a){return o.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:i,overscanRowStopIndex:s,visibleColumnStartIndex:n,visibleColumnStopIndex:r,visibleRowStartIndex:l,visibleRowStopIndex:a})})),o._callOnScroll=void 0,o._callOnScroll=te((function(e,t,i,s,n){return o.props.onScroll({horizontalScrollDirection:i,scrollLeft:e,scrollTop:t,verticalScrollDirection:s,scrollUpdateWasRequested:n})})),o._getItemStyle=void 0,o._getItemStyle=function(e,t){var s,r=o.props,l=r.columnWidth,a=r.direction,d=r.rowHeight,h=o._getItemStyleCache(m&&l,m&&a,m&&d),p=e+":"+t;if(h.hasOwnProperty(p))s=h[p];else{var g=i(o.props,t,o._instanceProps),f="rtl"===a;h[p]=s={position:"absolute",left:f?void 0:g,right:f?g:void 0,top:u(o.props,e,o._instanceProps),height:c(o.props,e,o._instanceProps),width:n(o.props,t,o._instanceProps)}}return s},o._getItemStyleCache=void 0,o._getItemStyleCache=te((function(e,t,i){return{}})),o._onScroll=function(e){var t=e.currentTarget,i=t.clientHeight,s=t.clientWidth,n=t.scrollLeft,r=t.scrollTop,l=t.scrollHeight,a=t.scrollWidth;o.setState((function(e){if(e.scrollLeft===n&&e.scrollTop===r)return null;var t=o.props.direction,d=n;if("rtl"===t)switch(le()){case"negative":d=-n;break;case"positive-descending":d=a-s-n}d=Math.max(0,Math.min(d,a-s));var c=Math.max(0,Math.min(r,l-i));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<n?"forward":"backward",scrollLeft:d,scrollTop:c,verticalScrollDirection:e.scrollTop<r?"forward":"backward",scrollUpdateWasRequested:!1}}),o._resetIsScrollingDebounced)},o._outerRefSetter=function(e){var t=o.props.outerRef;o._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},o._resetIsScrollingDebounced=function(){null!==o._resetIsScrollingTimeoutId&&oe(o._resetIsScrollingTimeoutId),o._resetIsScrollingTimeoutId=se(o._resetIsScrolling,150)},o._resetIsScrolling=function(){o._resetIsScrollingTimeoutId=null,o.setState({isScrolling:!1},(function(){o._getItemStyleCache(-1)}))},o}X(t,e),t.getDerivedStateFromProps=function(e,t){return ce(e,t),f(e),null};var v=t.prototype;return v.scrollTo=function(e){var t=e.scrollLeft,i=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==i&&(i=Math.max(0,i)),this.setState((function(e){return void 0===t&&(t=e.scrollLeft),void 0===i&&(i=e.scrollTop),e.scrollLeft===t&&e.scrollTop===i?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:i,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<i?"forward":"backward"}}),this._resetIsScrollingDebounced)},v.scrollToItem=function(e){var t=e.align,i=void 0===t?"auto":t,o=e.columnIndex,s=e.rowIndex,n=this.props,c=n.columnCount,u=n.height,h=n.rowCount,p=n.width,g=this.state,m=g.scrollLeft,f=g.scrollTop,v=function(e){if(void 0===e&&(e=!1),-1===ne||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",document.body.appendChild(t),ne=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ne}();void 0!==o&&(o=Math.max(0,Math.min(o,c-1))),void 0!==s&&(s=Math.max(0,Math.min(s,h-1)));var S=r(this.props,this._instanceProps),y=l(this.props,this._instanceProps)>p?v:0,w=S>u?v:0;this.scrollTo({scrollLeft:void 0!==o?a(this.props,o,i,m,this._instanceProps,w):m,scrollTop:void 0!==s?d(this.props,s,i,f,this._instanceProps,y):f})},v.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,i=e.initialScrollTop;if(null!=this._outerRef){var o=this._outerRef;"number"==typeof t&&(o.scrollLeft=t),"number"==typeof i&&(o.scrollTop=i)}this._callPropsCallbacks()},v.componentDidUpdate=function(){var e=this.props.direction,t=this.state,i=t.scrollLeft,o=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var s=this._outerRef;if("rtl"===e)switch(le()){case"negative":s.scrollLeft=-i;break;case"positive-ascending":s.scrollLeft=i;break;default:var n=s.clientWidth,r=s.scrollWidth;s.scrollLeft=r-n-i}else s.scrollLeft=Math.max(0,i);s.scrollTop=Math.max(0,o)}this._callPropsCallbacks()},v.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&oe(this._resetIsScrollingTimeoutId)},v.render=function(){var e=this.props,t=e.children,i=e.className,o=e.columnCount,s=e.direction,n=e.height,a=e.innerRef,d=e.innerElementType,c=e.innerTagName,u=e.itemData,h=e.itemKey,p=void 0===h?ae:h,g=e.outerElementType,m=e.outerTagName,f=e.rowCount,v=e.style,S=e.useIsScrolling,y=e.width,w=this.state.isScrolling,b=this._getHorizontalRangeToRender(),x=b[0],I=b[1],C=this._getVerticalRangeToRender(),R=C[0],T=C[1],M=[];if(o>0&&f)for(var O=R;O<=T;O++)for(var L=x;L<=I;L++)M.push((0,A.createElement)(t,{columnIndex:L,data:u,isScrolling:S?w:void 0,key:p({columnIndex:L,data:u,rowIndex:O}),rowIndex:O,style:this._getItemStyle(O,L)}));var j=r(this.props,this._instanceProps),z=l(this.props,this._instanceProps);return(0,A.createElement)(g||m||"div",{className:i,onScroll:this._onScroll,ref:this._outerRefSetter,style:Q({position:"relative",height:n,width:y,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:s},v)},(0,A.createElement)(d||c||"div",{children:M,ref:a,style:{height:j,pointerEvents:w?"none":void 0,width:z}}))},v._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,i=e.onItemsRendered,o=e.onScroll,s=e.rowCount;if("function"==typeof i&&t>0&&s>0){var n=this._getHorizontalRangeToRender(),r=n[0],l=n[1],a=n[2],d=n[3],c=this._getVerticalRangeToRender(),u=c[0],h=c[1],p=c[2],g=c[3];this._callOnItemsRendered(r,l,u,h,a,d,p,g)}if("function"==typeof o){var m=this.state,f=m.horizontalScrollDirection,v=m.scrollLeft,S=m.scrollTop,y=m.scrollUpdateWasRequested,w=m.verticalScrollDirection;this._callOnScroll(v,S,f,w,y)}},v._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,i=e.overscanColumnCount,n=e.overscanColumnsCount,r=e.overscanCount,l=e.rowCount,a=this.state,d=a.horizontalScrollDirection,c=a.isScrolling,u=a.scrollLeft,h=i||n||r||1;if(0===t||0===l)return[0,0,0,0];var p=o(this.props,u,this._instanceProps),g=s(this.props,p,u,this._instanceProps),m=c&&"backward"!==d?1:Math.max(1,h),f=c&&"forward"!==d?1:Math.max(1,h);return[Math.max(0,p-m),Math.max(0,Math.min(t-1,g+f)),p,g]},v._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,i=e.overscanCount,o=e.overscanRowCount,s=e.overscanRowsCount,n=e.rowCount,r=this.state,l=r.isScrolling,a=r.verticalScrollDirection,d=r.scrollTop,c=o||s||i||1;if(0===t||0===n)return[0,0,0,0];var u=h(this.props,d,this._instanceProps),g=p(this.props,u,d,this._instanceProps),m=l&&"backward"!==a?1:Math.max(1,c),f=l&&"forward"!==a?1:Math.max(1,c);return[Math.max(0,u-m),Math.max(0,Math.min(n-1,g+f)),u,g]},t}(A.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},t}var ce=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance},ue=function(e,t){var i=e.rowCount,o=t.rowMetadataMap,s=t.estimatedRowHeight,n=t.lastMeasuredRowIndex,r=0;if(n>=i&&(n=i-1),n>=0){var l=o[n];r=l.offset+l.size}return r+(i-n-1)*s},he=function(e,t){var i=e.columnCount,o=t.columnMetadataMap,s=t.estimatedColumnWidth,n=t.lastMeasuredColumnIndex,r=0;if(n>=i&&(n=i-1),n>=0){var l=o[n];r=l.offset+l.size}return r+(i-n-1)*s},pe=function(e,t,i,o){var s,n,r;if("column"===e?(s=o.columnMetadataMap,n=t.columnWidth,r=o.lastMeasuredColumnIndex):(s=o.rowMetadataMap,n=t.rowHeight,r=o.lastMeasuredRowIndex),i>r){var l=0;if(r>=0){var a=s[r];l=a.offset+a.size}for(var d=r+1;d<=i;d++){var c=n(d);s[d]={offset:l,size:c},l+=c}"column"===e?o.lastMeasuredColumnIndex=i:o.lastMeasuredRowIndex=i}return s[i]},ge=function(e,t,i,o){var s,n;return"column"===e?(s=i.columnMetadataMap,n=i.lastMeasuredColumnIndex):(s=i.rowMetadataMap,n=i.lastMeasuredRowIndex),(n>0?s[n].offset:0)>=o?me(e,t,i,n,0,o):fe(e,t,i,Math.max(0,n),o)},me=function(e,t,i,o,s,n){for(;s<=o;){var r=s+Math.floor((o-s)/2),l=pe(e,t,r,i).offset;if(l===n)return r;l<n?s=r+1:l>n&&(o=r-1)}return s>0?s-1:0},fe=function(e,t,i,o,s){for(var n="column"===e?t.columnCount:t.rowCount,r=1;o<n&&pe(e,t,o,i).offset<s;)o+=r,r*=2;return me(e,t,i,Math.min(o,n-1),Math.floor(o/2),s)},ve=function(e,t,i,o,s,n,r){var l="column"===e?t.width:t.height,a=pe(e,t,i,n),d="column"===e?he(t,n):ue(t,n),c=Math.max(0,Math.min(d-l,a.offset)),u=Math.max(0,a.offset-l+r+a.size);switch("smart"===o&&(o=s>=u-l&&s<=c+l?"auto":"center"),o){case"start":return c;case"end":return u;case"center":return Math.round(u+(c-u)/2);default:return s>=u&&s<=c?s:u>c||s<u?u:c}},Se=de({getColumnOffset:function(e,t,i){return pe("column",e,t,i).offset},getColumnStartIndexForOffset:function(e,t,i){return ge("column",e,i,t)},getColumnStopIndexForStartIndex:function(e,t,i,o){for(var s=e.columnCount,n=e.width,r=pe("column",e,t,o),l=i+n,a=r.offset+r.size,d=t;d<s-1&&a<l;)d++,a+=pe("column",e,d,o).size;return d},getColumnWidth:function(e,t,i){return i.columnMetadataMap[t].size},getEstimatedTotalHeight:ue,getEstimatedTotalWidth:he,getOffsetForColumnAndAlignment:function(e,t,i,o,s,n){return ve("column",e,t,i,o,s,n)},getOffsetForRowAndAlignment:function(e,t,i,o,s,n){return ve("row",e,t,i,o,s,n)},getRowOffset:function(e,t,i){return pe("row",e,t,i).offset},getRowHeight:function(e,t,i){return i.rowMetadataMap[t].size},getRowStartIndexForOffset:function(e,t,i){return ge("row",e,i,t)},getRowStopIndexForStartIndex:function(e,t,i,o){for(var s=e.rowCount,n=e.height,r=pe("row",e,t,o),l=i+n,a=r.offset+r.size,d=t;d<s-1&&a<l;)d++,a+=pe("row",e,d,o).size;return d},initInstanceProps:function(e,t){var i=e,o={columnMetadataMap:{},estimatedColumnWidth:i.estimatedColumnWidth||50,estimatedRowHeight:i.estimatedRowHeight||50,lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,rowMetadataMap:{}};return t.resetAfterColumnIndex=function(e,i){void 0===i&&(i=!0),t.resetAfterIndices({columnIndex:e,shouldForceUpdate:i})},t.resetAfterRowIndex=function(e,i){void 0===i&&(i=!0),t.resetAfterIndices({rowIndex:e,shouldForceUpdate:i})},t.resetAfterIndices=function(e){var i=e.columnIndex,s=e.rowIndex,n=e.shouldForceUpdate,r=void 0===n||n;"number"==typeof i&&(o.lastMeasuredColumnIndex=Math.min(o.lastMeasuredColumnIndex,i-1)),"number"==typeof s&&(o.lastMeasuredRowIndex=Math.min(o.lastMeasuredRowIndex,s-1)),t._getItemStyleCache(-1),r&&t.forceUpdate()},o},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.columnWidth,e.rowHeight}}),ye=function(e,t){return e};function we(e){var t,i=e.getItemOffset,o=e.getEstimatedTotalSize,s=e.getItemSize,n=e.getOffsetForIndexAndAlignment,r=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,a=e.initInstanceProps,d=e.shouldResetStyleCacheOnItemSizeChange,c=e.validateProps;return t=function(e){function t(t){var o;return(o=e.call(this,t)||this)._instanceProps=a(o.props,Y(o)),o._outerRef=void 0,o._resetIsScrollingTimeoutId=null,o.state={instance:Y(o),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof o.props.initialScrollOffset?o.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},o._callOnItemsRendered=void 0,o._callOnItemsRendered=te((function(e,t,i,s){return o.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:i,visibleStopIndex:s})})),o._callOnScroll=void 0,o._callOnScroll=te((function(e,t,i){return o.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:i})})),o._getItemStyle=void 0,o._getItemStyle=function(e){var t,n=o.props,r=n.direction,l=n.itemSize,a=n.layout,c=o._getItemStyleCache(d&&l,d&&a,d&&r);if(c.hasOwnProperty(e))t=c[e];else{var u=i(o.props,e,o._instanceProps),h=s(o.props,e,o._instanceProps),p="horizontal"===r||"horizontal"===a,g="rtl"===r,m=p?u:0;c[e]=t={position:"absolute",left:g?void 0:m,right:g?m:void 0,top:p?0:u,height:p?"100%":h,width:p?h:"100%"}}return t},o._getItemStyleCache=void 0,o._getItemStyleCache=te((function(e,t,i){return{}})),o._onScrollHorizontal=function(e){var t=e.currentTarget,i=t.clientWidth,s=t.scrollLeft,n=t.scrollWidth;o.setState((function(e){if(e.scrollOffset===s)return null;var t=o.props.direction,r=s;if("rtl"===t)switch(le()){case"negative":r=-s;break;case"positive-descending":r=n-i-s}return r=Math.max(0,Math.min(r,n-i)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:r,scrollUpdateWasRequested:!1}}),o._resetIsScrollingDebounced)},o._onScrollVertical=function(e){var t=e.currentTarget,i=t.clientHeight,s=t.scrollHeight,n=t.scrollTop;o.setState((function(e){if(e.scrollOffset===n)return null;var t=Math.max(0,Math.min(n,s-i));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),o._resetIsScrollingDebounced)},o._outerRefSetter=function(e){var t=o.props.outerRef;o._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},o._resetIsScrollingDebounced=function(){null!==o._resetIsScrollingTimeoutId&&oe(o._resetIsScrollingTimeoutId),o._resetIsScrollingTimeoutId=se(o._resetIsScrolling,150)},o._resetIsScrolling=function(){o._resetIsScrollingTimeoutId=null,o.setState({isScrolling:!1},(function(){o._getItemStyleCache(-1,null)}))},o}X(t,e),t.getDerivedStateFromProps=function(e,t){return be(e,t),c(e),null};var u=t.prototype;return u.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},u.scrollToItem=function(e,t){void 0===t&&(t="auto");var i=this.props.itemCount,o=this.state.scrollOffset;e=Math.max(0,Math.min(e,i-1)),this.scrollTo(n(this.props,e,t,o,this._instanceProps))},u.componentDidMount=function(){var e=this.props,t=e.direction,i=e.initialScrollOffset,o=e.layout;if("number"==typeof i&&null!=this._outerRef){var s=this._outerRef;"horizontal"===t||"horizontal"===o?s.scrollLeft=i:s.scrollTop=i}this._callPropsCallbacks()},u.componentDidUpdate=function(){var e=this.props,t=e.direction,i=e.layout,o=this.state,s=o.scrollOffset;if(o.scrollUpdateWasRequested&&null!=this._outerRef){var n=this._outerRef;if("horizontal"===t||"horizontal"===i)if("rtl"===t)switch(le()){case"negative":n.scrollLeft=-s;break;case"positive-ascending":n.scrollLeft=s;break;default:var r=n.clientWidth,l=n.scrollWidth;n.scrollLeft=l-r-s}else n.scrollLeft=s;else n.scrollTop=s}this._callPropsCallbacks()},u.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&oe(this._resetIsScrollingTimeoutId)},u.render=function(){var e=this.props,t=e.children,i=e.className,s=e.direction,n=e.height,r=e.innerRef,l=e.innerElementType,a=e.innerTagName,d=e.itemCount,c=e.itemData,u=e.itemKey,h=void 0===u?ye:u,p=e.layout,g=e.outerElementType,m=e.outerTagName,f=e.style,v=e.useIsScrolling,S=e.width,y=this.state.isScrolling,w="horizontal"===s||"horizontal"===p,b=w?this._onScrollHorizontal:this._onScrollVertical,x=this._getRangeToRender(),I=x[0],C=x[1],R=[];if(d>0)for(var T=I;T<=C;T++)R.push((0,A.createElement)(t,{data:c,key:h(T,c),index:T,isScrolling:v?y:void 0,style:this._getItemStyle(T)}));var M=o(this.props,this._instanceProps);return(0,A.createElement)(g||m||"div",{className:i,onScroll:b,ref:this._outerRefSetter,style:Q({position:"relative",height:n,width:S,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:s},f)},(0,A.createElement)(l||a||"div",{children:R,ref:r,style:{height:w?"100%":M,pointerEvents:y?"none":void 0,width:w?M:"100%"}}))},u._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],i=e[1],o=e[2],s=e[3];this._callOnItemsRendered(t,i,o,s)}if("function"==typeof this.props.onScroll){var n=this.state,r=n.scrollDirection,l=n.scrollOffset,a=n.scrollUpdateWasRequested;this._callOnScroll(r,l,a)}},u._getRangeToRender=function(){var e=this.props,t=e.itemCount,i=e.overscanCount,o=this.state,s=o.isScrolling,n=o.scrollDirection,a=o.scrollOffset;if(0===t)return[0,0,0,0];var d=r(this.props,a,this._instanceProps),c=l(this.props,d,a,this._instanceProps),u=s&&"backward"!==n?1:Math.max(1,i),h=s&&"forward"!==n?1:Math.max(1,i);return[Math.max(0,d-u),Math.max(0,Math.min(t-1,c+h)),d,c]},t}(A.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var be=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},xe=function(e,t,i){var o=e.itemSize,s=i.itemMetadataMap,n=i.lastMeasuredIndex;if(t>n){var r=0;if(n>=0){var l=s[n];r=l.offset+l.size}for(var a=n+1;a<=t;a++){var d=o(a);s[a]={offset:r,size:d},r+=d}i.lastMeasuredIndex=t}return s[t]},Ie=function(e,t,i,o,s){for(;o<=i;){var n=o+Math.floor((i-o)/2),r=xe(e,n,t).offset;if(r===s)return n;r<s?o=n+1:r>s&&(i=n-1)}return o>0?o-1:0},Ce=function(e,t){var i=e.itemCount,o=t.itemMetadataMap,s=t.estimatedItemSize,n=t.lastMeasuredIndex,r=0;if(n>=i&&(n=i-1),n>=0){var l=o[n];r=l.offset+l.size}return r+(i-n-1)*s},Re=we({getItemOffset:function(e,t,i){return xe(e,t,i).offset},getItemSize:function(e,t,i){return i.itemMetadataMap[t].size},getEstimatedTotalSize:Ce,getOffsetForIndexAndAlignment:function(e,t,i,o,s){var n=e.direction,r=e.height,l=e.layout,a=e.width,d="horizontal"===n||"horizontal"===l?a:r,c=xe(e,t,s),u=Ce(e,s),h=Math.max(0,Math.min(u-d,c.offset)),p=Math.max(0,c.offset-d+c.size);switch("smart"===i&&(i=o>=p-d&&o<=h+d?"auto":"center"),i){case"start":return h;case"end":return p;case"center":return Math.round(p+(h-p)/2);default:return o>=p&&o<=h?o:o<p?p:h}},getStartIndexForOffset:function(e,t,i){return function(e,t,i){var o=t.itemMetadataMap,s=t.lastMeasuredIndex;return(s>0?o[s].offset:0)>=i?Ie(e,t,s,0,i):function(e,t,i,o){for(var s=e.itemCount,n=1;i<s&&xe(e,i,t).offset<o;)i+=n,n*=2;return Ie(e,t,Math.min(i,s-1),Math.floor(i/2),o)}(e,t,Math.max(0,s),i)}(e,i,t)},getStopIndexForStartIndex:function(e,t,i,o){for(var s=e.direction,n=e.height,r=e.itemCount,l=e.layout,a=e.width,d="horizontal"===s||"horizontal"===l?a:n,c=xe(e,t,o),u=i+d,h=c.offset+c.size,p=t;p<r-1&&h<u;)p++,h+=xe(e,p,o).size;return p},initInstanceProps:function(e,t){var i={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,o){void 0===o&&(o=!0),i.lastMeasuredIndex=Math.min(i.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),o&&t.forceUpdate()},i},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}});class Te extends e.React.PureComponent{constructor(i){super(i),this.onDropDownToggle=e=>{e.stopPropagation();const{isDropDownOpen:t,onDropDownOpenChange:i}=this.props;if(void 0!==t)i&&i(!t);else{const{isOpen:e}=this.state;this.setState({isOpen:!e})}},this.onItemClick=(e,t)=>{const{isDropDownOpen:i,onDropDownOpenChange:o}=this.props;void 0!==i?o&&o(!1):this.setState({isOpen:!1}),t.event(e,t),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.onDropDownMouseClick=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.getStyle=()=>{var t,i,o,s,n,r;const{theme:l}=this.props;return e.css`
      & button {
        padding: 0;
      }
      .list-toggle-button {
        background: ${null===(o=null===(i=null===(t=l.colors)||void 0===t?void 0:t.palette)||void 0===i?void 0:i.light)||void 0===o?void 0:o[500]};
        border: none;
        &:hover, &[aria-expanded="true"] {
          background: ${null===(r=null===(n=null===(s=l.colors)||void 0===s?void 0:s.palette)||void 0===n?void 0:n.light)||void 0===r?void 0:r[800]};
        }
      }
    `},this.state={isOpen:!1};const{withBuilderStyle:o}=i;this.MyDropdown=o?o(t.Dropdown):t.Dropdown,this.MyDropdownButton=o?o(t.DropdownButton):t.DropdownButton,this.MyDropdownMenu=o?o(t.DropdownMenu):t.DropdownMenu,this.MyDropdownItem=o?o(t.DropdownItem):t.DropdownItem}render(){const{items:t,toggleContent:i,caret:o,toggleType:s,toggleArrow:n,menuContent:r,appMode:l,modifiers:a,toggleIsIcon:d,theme:c,isDropDownOpen:u,size:h,appendToBody:p,toggleTitle:g,direction:m,menuCss:f,className:v,showActive:S,activeLabel:y,fluid:w}=this.props;let{isOpen:b}=this.state;b=void 0===u?b:u;const{MyDropdown:x,MyDropdownButton:I,MyDropdownMenu:C,MyDropdownItem:R}=this;return(0,e.jsx)(x,{size:h,toggle:this.onDropDownToggle,direction:m,fluid:w,isOpen:b&&l!==e.AppMode.Design,className:`my-dropdown ${v}`,css:this.getStyle()},i&&(0,e.jsx)(I,{icon:d,title:g,size:h,type:s,caret:o,className:"list-toggle-button",arrow:n},i&&i(c)),(0,e.jsx)(C,{appendToBody:p,modifiers:a,css:f&&f(c)},r?r(c):t&&t.asMutable().map(((t,i)=>!t.hide&&(0,e.jsx)(R,{key:i,className:"no-user-select",title:t.label,active:S&&t.label===y,onClick:e=>this.onItemClick(e,t)},t.label)))))}}var Me=l(15506),Oe=l(81411),Le=l.n(Oe);const je=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:Le()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var ze=l(27218),De=l.n(ze);const ke=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:De()},s)):e.React.createElement("svg",Object.assign({className:n},s))},Pe=[0,5],Ee=[{name:"flip",options:{boundary:document.body,fallbackPlacements:["bottom-start","right-end","top-start","left-start"]}}];class Ae extends e.React.PureComponent{constructor(t){super(t),this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.onPopperToggle=e=>{const{filter:t}=this.props,{isOpen:i}=this.state;i||this.setState({currentFilter:t}),this.setState({isOpen:!i})},this.onItemClick=(e,t)=>{this.setState({isOpen:!1}),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.handleFilterChange=e=>{this.setState({currentFilter:e})},this.handleApplyClick=e=>{const{currentFilter:t}=this.state,{handleFilterApplyChange:i,handleFilterChange:o}=this.props;o(t),i(!0),this.setState({isOpen:!1})},this.handleResetClick=e=>{const{handleFilterApplyChange:t,handleFilterChange:i}=this.props;t(!1),i(this.props.filterInConfig),this.setState({currentFilter:this.props.filterInConfig})},this.handleClearClick=e=>{const{handleFilterApplyChange:t}=this.props;t(!1),this.setState({isOpen:!1})},this.getStyle=()=>{const{theme:t}=this.props;return e.css`
      position: relative;
      .dot {
        position: absolute;
        width: 6px;
        height: 6px;
        right: -2px;
        top: 0px;
        .dot-bottom {
          width: 6px;
          height: 6px;
          background-color: transparent;
          .dot-top {
            width: 4px;
            height: 4px;
            background-color: ${t.colors.palette.dark[600]};
          }
        }
      }
      :hover {
        .dot-top {
          background-color: ${t.colors.palette.primary[500]};
        }
      }
      & .active {
        .dot-top {
          background-color: ${t.colors.white};
        }
        :hover {
          .dot-top {
            background-color: ${t.colors.white};
          }
        }
      }
    `},this.getPopperStyle=()=>e.css`
      .filter-button-con  {
        & {
          text-align: right;
        }
        button {
          max-width: ${e.polished.rem(92)};
          overflow: hidden;
          text-overflow: ellipsis;
        }
        button svg {
          margin-right: 0 !important;
        }
        .reset-button {
          padding-left: ${e.polished.rem(5)};
          padding-right: ${e.polished.rem(5)};
        }
      }
      .clear-button, .reset-button {
        margin-left: ${e.polished.rem(8)};
      }
    `,this.toggleRef=e.React.createRef(),this.state={isOpen:!1,currentFilter:t.filter}}componentDidUpdate(t){const{filter:i,appMode:o}=this.props;i!==t.filter&&this.setState({currentFilter:i}),o!==t.appMode&&o===e.AppMode.Design&&this.setState({isOpen:!1})}render(){const{filter:i,selectedDs:o,widgetId:s,title:n,applied:r}=this.props,{isOpen:l,currentFilter:a}=this.state,d=r&&(null==i?void 0:i.sql)===(null==a?void 0:a.sql);return(0,e.jsx)(A.Fragment,null,(0,e.jsx)(t.Button,{css:this.getStyle(),size:"sm",type:"tertiary",icon:!0,title:n,ref:this.toggleRef,onClick:this.onPopperToggle},(0,e.jsx)(je,{size:16}),r&&(0,e.jsx)("div",{className:"dot align-items-center justify-content-center"},(0,e.jsx)("div",{className:"dot-bottom rounded-circle"},(0,e.jsx)("div",{className:"dot-top rounded-circle"})))),(0,e.jsx)(t.Popper,{placement:"bottom-start",reference:this.toggleRef.current,offset:Pe,toggle:this.onPopperToggle,css:this.getPopperStyle(),open:l,modifiers:Ee},(0,e.jsx)("div",{style:{padding:e.polished.rem(20),width:e.polished.rem(250)}},(0,e.jsx)("div",null,(0,e.jsx)(Me.SqlExpressionRuntime,{widgetId:s,dataSource:o,expression:a,onChange:this.handleFilterChange})),(0,e.jsx)("div",{className:"w-100 mt-3 filter-button-con"},(0,e.jsx)(t.Button,{disabled:d,onClick:this.handleApplyClick,type:"primary",title:this.formatMessage("apply"),size:"sm"},this.formatMessage("apply")),(0,e.jsx)(t.Button,{disabled:!r,onClick:this.handleClearClick,title:this.formatMessage("commonModalCancel"),className:"clear-button",size:"sm"},this.formatMessage("commonModalCancel")),(0,e.jsx)(t.Button,{onClick:this.handleResetClick,title:this.formatMessage("resetFilters"),className:"reset-button",size:"sm"},(0,e.jsx)(ke,{size:"s"}))))))}}var Ne=l(11407),$e=l.n(Ne);const Be=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:$e()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var _e=l(96009),He=l.n(_e);const Fe=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:He()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var Ue=l(3273),We=l.n(Ue);const Ge=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:We()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var Ve=l(59788),qe=l.n(Ve);const Ze=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:qe()},s)):e.React.createElement("svg",Object.assign({className:n},s))};function Qe(i){const{isRTL:o,totalPage:s,pageStyle:n,currentPage:l,scrollStatus:a,isScrollEnd:d,isEditing:c,showLoading:h,layoutType:p,handleScrollDown:g,handleScrollUp:m,handleSwitchPage:f,formatMessage:v}=i;return e.React.createElement("div",{className:"bottom-tools w-100 d-flex align-items-center justify-content-center pl-2 pr-2"},n===r.MultiPage?e.React.createElement(t.Pagination,{size:"sm",totalPage:s,current:l,onChangePage:f,disabled:h}):e.React.createElement("div",{className:"d-flex scroll-navigator"},e.React.createElement(t.Button,{title:v("previous"),disabled:"start"===a,type:"secondary",size:"sm",icon:!0,onClick:m},p===u.Column?e.React.createElement(Be,{size:12}):e.React.createElement(Fe,{size:12})),e.React.createElement(t.Button,{title:v("next"),disabled:"end"===a||d,type:"secondary",size:"sm",style:o?{marginRight:e.polished.rem(10)}:{marginLeft:e.polished.rem(10)},icon:!0,onClick:g},p===u.Column?e.React.createElement(Ge,null):e.React.createElement(Ze,null))),window.jimuConfig.isInBuilder&&c&&e.React.createElement("div",{className:"editing-mask-bottom-tool"}))}var Ye=function(e,t,i,o){return new(i||(i=Promise))((function(s,n){function r(e){try{a(o.next(e))}catch(e){n(e)}}function l(e){try{a(o.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};const Ke=function(t,i){var o,s,n,r;return Ye(this,void 0,void 0,(function*(){let l;const a=null===(r=null===(n=null===(s=null===(o=(0,e.getAppStore)().getState())||void 0===o?void 0:o.appConfig)||void 0===s?void 0:s.widgets[i])||void 0===n?void 0:n.useDataSources)||void 0===r?void 0:r[0],d=e.DataSourceManager.getInstance();return t&&a&&(l=d.createDataSourceByUseDataSource(Object.assign({},a,{mainDataSourceId:a.mainDataSourceId}),"localId")),yield Promise.resolve(l)}))};class Xe extends e.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.1.0",description:"",upgrader:(e,t)=>Ye(this,void 0,void 0,(function*(){const i=e.filter;return yield Ke(i,t).then((t=>{let o=e;const s=i?(0,Me.updateSQLExpressionByVersion)(i,"1.1.0",t):null;return o=o.set("filter",s),o}))}))},{version:"1.5.0",description:"1.5.0",upgrader:(e,t)=>Ye(this,void 0,void 0,(function*(){const i=e.filter;return yield Ke(i,t).then((t=>{let i=e;if("boolean"!=typeof(null==e?void 0:e.isShowAutoRefresh)){const e=!!(o=t)&&((null==o?void 0:o.getAutoRefreshInterval())||0)>0;i=i.set("isShowAutoRefresh",e)}var o;return i}))}))},{version:"1.8.0",description:"1.8.0",upgrader:(e,t)=>Ye(this,void 0,void 0,(function*(){let t=e;if((null==e?void 0:e.direction)&&!(null==e?void 0:e.layoutType)){const i=(null==e?void 0:e.direction)===c.Horizon?u.Column:u.Row;t=t.set("layoutType",i).set("keepAspectRatio",!1)}return t}))}]}}const Je=new Xe;function et(e,t){return Math.abs(e-t)<1e-4}function tt(e,o){const{config:s}=e,n=it(e),r=t.utils.toLinearUnit(n.width);let l=nt(t.utils.toLinearUnit(n.width),o.width+s.horizontalSpace-8);r.unit===t.DistanceUnits.PERCENTAGE&&(l=l-s.horizontalSpace>0?l-s.horizontalSpace:i);let a=nt(t.utils.toLinearUnit(n.height),o.height);return s.keepAspectRatio&&(null==s?void 0:s.layoutType)===u.GRID&&(a=l*(null==s?void 0:s.gridItemSizeRatio)),{width:l,height:a}}function it(e){var t;const{config:i,builderStatus:o,browserSizeMode:s}=e;let n=null==i?void 0:i.asMutable({deep:!0}).cardConfigs[o];n&&n.cardSize||(n=null==i?void 0:i.asMutable({deep:!0}).cardConfigs[f.Regular]);let r=null===(t=null==n?void 0:n.cardSize)||void 0===t?void 0:t[s];return r||(r=n.cardSize[Object.keys(n.cardSize)[0]]),r}function ot(e){const o=it(e),s={width:i,height:i},n=t.utils.toLinearUnit(o.width),r=t.utils.toLinearUnit(o.height);return n.unit===t.DistanceUnits.PERCENTAGE&&(s.width=50/n.distance*100),r.unit===t.DistanceUnits.PERCENTAGE&&(s.height=50/r.distance*100),s}function st(e){const{config:o}=e,s=it(e),n=t.utils.toLinearUnit(s.width);return n.unit===t.DistanceUnits.PERCENTAGE&&(n.distance=n.distance-o.horizontalSpace>0?n.distance-o.horizontalSpace:i),{width:n,height:t.utils.toLinearUnit(s.height)}}function nt(e,i){return e.unit===t.DistanceUnits.PERCENTAGE?e.distance/100*i:e.distance}function rt(e,t,i,o){const s=tt(i,e),{config:n,isHeightAuto:l,isWidthAuto:a}=i;let d;if(n.pageStyle===r.Scroll){if(!e)return 0;switch(null==n?void 0:n.layoutType){case u.Row:if(0===e.height)return 0;l&&(t=document.body.scrollHeight),d=Math.ceil((t+n.space)/(s.height+n.space))+1;break;case u.Column:if(0===e.width)return 0;let i=e.width;a&&(i=document.body.scrollWidth),d=Math.ceil((i+n.space)/(s.width+n.space))+1;break;case u.GRID:if(0===e.height)return 0;l&&(t=document.body.scrollHeight),d=Math.ceil((t+(null==n?void 0:n.verticalSpace))/(s.height+n.space))*o}n.navigatorOpen&&(d=Math.max(d,n.scrollStep))}else d=n.itemsPerPage;return d}function lt(e,t){let i=40;return e&&(i=e.clientHeight),i=t?i:0,i}function at(e,t,i){const o=i?42:0;if(!e)return 0;const s=e.height-o-t;return s<0?0:s}function dt(e,t){const{config:i}=e,{datasource:o}=t;return!(!o||i.pageStyle===r.Scroll&&!i.navigatorOpen)}function ct(e){return ut(e)||ht(e)}function ut(e){return pt(e)||ft(e)||vt(e)||mt(e)||gt(e)}function ht(t){var i,o,s;const{id:n}=t,r=null===(o=null===(i=(0,e.getAppStore)())||void 0===i?void 0:i.getState())||void 0===o?void 0:o.appConfig,l=null===(s=null==r?void 0:r.widgets)||void 0===s?void 0:s[n];return(void 0===(null==l?void 0:l.enableDataAction)||(null==l?void 0:l.enableDataAction))&&function(e){const{useDataSources:t}=e;return!!t&&!!t[0]}(t)}function pt(e){const{config:t}=e;if(!t.sortOpen||!t.sorts||t.sorts.length<1)return!1;const i=t.sorts;let o=!1;return i.some((e=>(e.rule&&e.rule.some((e=>(e&&e.jimuFieldName&&(o=!0),o))),o))),o}function gt(e){const{config:t}=e;return t.searchOpen&&t.searchFields&&""!==t.searchFields}function mt(e){const{config:t}=e;return t.filterOpen&&!!t.filter}function ft(e){const{config:t}=e;return t.showSelectedOnlyOpen&&t.cardConfigs[f.Selected].selectionMode!==n.None}function vt(e){const{config:t}=e;return t.showClearSelected&&t.cardConfigs[f.Selected].selectionMode!==n.None}var St=l(65283),yt=l.n(St);const wt=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:yt()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var bt=l(87830),xt=l.n(bt),It=l(48957),Ct=l.n(It);const Rt=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component has-rtl-svg",o);return i?e.React.createElement(i,Object.assign({className:n,src:xt(),srcRTL:Ct()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var Tt=l(43036),Mt=l.n(Tt);const Ot=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:Mt()},s)):e.React.createElement("svg",Object.assign({className:n},s))};var Lt=l(79964),jt=l.n(Lt);const zt=t=>{const i=window.SVG,{className:o}=t,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(t,["className"]),n=(0,e.classNames)("jimu-icon jimu-icon-component",o);return i?e.React.createElement(i,Object.assign({className:n,src:jt()},s)):e.React.createElement("svg",Object.assign({className:n},s))};const Dt={fake:!0},kt=Object.assign({},{_widgetLabel:"List",_widgetDescription:"A widget to display data in a list view.",_action_filter_label:"Filter",_layout_REGULAR_label:"Regular",_layout_HOVER_label:"Hover",_layout_SELECTED_label:"Selected",applyTo:"Apply to {status}",listLoading:"Loading",pleaseSelect:"Please select",listNoData:"No data",selectSortFields:"Select sorting fields",clearFilter:"Clear filter",isolate:"Isolate",linkedToAnd:"Linked to {where1} and {where2}",linkedTo:"Linked to {where}",placeHolderTip:"Please select a list template.",showSelected:"Show selected",clearSelected:"Clear selected",listSorting:"Sorting",listSort:"Sort",guideStep2Title:"Template",guideStep2Content:"Click on a template and click start.",guideStep3Title:"Data",guideStep3Content:"Click on select data to add a data source.",guideStep4Title:"Add new data",guideStep4Content:"Click add new data to select a web map.",guideStep5Title:"Select data",guideStep5Content:"Click the feature layer in the select data panel and close the panel.",guideStep6Title:"Data",guideStep6Content:"Specifies the data source, allows you to filter the data and limit the number of features that appear in the list.",guideStep7Title:"Arrangement",guideStep7Content:"Click the expand icon to explore the Arrangement section. In here, it allows you to define the direction, height, spacing, and paging style for your list.",guideStep8Title:"States",guideStep8Content:"Click the expand icon to explore the available States. In this section, it provides a visual representation to communicate the state of the list items. There are three states: regular, selected, and hover. By default, the selected state is always on.",guideStep9Title:"Tools",guideStep9Content:"Click the expand icon to explore the available Tools. In here, you can include search, sort, filter, and show selected tools in your list.",guideStep10Title:"Select image",guideStep10Content:"Click the image widget to configure it in the content panel.",guideStep10Title2:"Image settings",guideStep10Content2:"Allows you to select the image source and other settings for your widget.",guideStep11Title:"Select text",guideStep11Content:"Click the text widget to add attributes in the widget toolbar.",guideStep11Title2:"Text settings",guideStep11Content2:"Provides the configurations and style, including adding dynamic content from the widget toolbar. ",guideStep12Title:"End of tour",guideStep12Content:"Add other widgets to enhance your experience.",clearSearch:"Clear search",minimize:"Minimize",topToolBack:"Back",showAllListRecords:"Show all records",listDataActionLabel:"{layer} list selection",searchResult:"Search result"},t.defaultMessages),{SELECTION_DATA_VIEW_ID:Pt}=e.CONSTANTS;class Et extends e.React.PureComponent{constructor(o){super(o),this.isFirstLoad=!0,this.isHasScrolled=!1,this.isHasRenderList=!1,this.isHasPublishMessageAction=!1,this.isSetlayout=!1,this.resetTimeout=null,this.isHasInitCurrentCardSize=!1,this.updateWidgetRectTimeout=void 0,this.checkIsRecordsChange=(e,t)=>{var i;const o=(null==e?void 0:e.map((e=>null==e?void 0:e.getId())))||[],s=(null==t?void 0:t.map((e=>null==e?void 0:e.getId())))||[];return(null==o?void 0:o.length)!==s||(null===(i=null==o?void 0:o.filter((e=>!(null==s?void 0:s.includes(e)))))||void 0===i?void 0:i.length)>0},this.resetAfterIndices=()=>{var e,t,i,o;(null===(t=null===(e=this.listRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.resetAfterIndices)&&(null===(o=null===(i=this.listRef)||void 0===i?void 0:i.current)||void 0===o||o.resetAfterIndices({columnIndex:0,rowIndex:0,shouldForceUpdate:!1}))},this.setListLayoutInWidgetState=()=>{const{layoutId:t,layoutItemId:i,id:o,selectionIsSelf:s}=this.props;t&&o&&i&&!this.isSetlayout&&s&&(this.props.dispatch(e.appActions.widgetStatePropChange(o,"layoutInfo",{layoutId:t,layoutItemId:i})),this.isSetlayout=!0)},this.setListParentSizeInWidgetState=()=>{const{browserSizeMode:t,id:i,parentSize:o,layoutId:s}=this.props,n=(0,e.getAppStore)().getState().appConfig,r=e.utils.findViewportSize(n,t),l=`div.layout[data-layoutid=${s}]`,a=document.querySelector(l),d={width:(null==a?void 0:a.clientWidth)||r.width,height:(null==a?void 0:a.clientHeight)||r.height};o&&o.height===d.height&&o.width===d.width||this.props.dispatch(e.appActions.widgetStatePropChange(i,"parentSize",d))},this.getBodySize=()=>{this.bodySize={scrollWidth:document.documentElement.scrollWidth,scrollHeight:document.documentElement.scrollHeight,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight}},this.updateListInBuilder=(e,t)=>{var i;const{config:o}=this.props;if(!window.jimuConfig.isInBuilder)return!1;const s=tt(this.props,null===(i=this.state)||void 0===i?void 0:i.widgetRect);let n=this.layoutPropertiesChange(e,t);this.updateScrollContentSize(e.config),this.pageTypeChange(e),this.useDatasourcesChange(e),n=this.listDivSizeChange(e,t,s,n),n&&this.updateCardToolPosition(),this.listSortChange(e),this.listFilterChange(e),o.cardConfigs[f.Selected].selectionMode!==e.config.cardConfigs[f.Selected].selectionMode&&this.selectRecords([])},this.layoutPropertiesChange=(e,t)=>{var i,o;const{config:s,top:n,left:r}=this.props;let l=!1;if(!window.jimuConfig.isInBuilder)return!1;let a=!1;const d=tt(this.props,this.state.widgetRect),c=tt(e,null==t?void 0:t.widgetRect);this.updateScrollContentSize(e.config);const h=n!==e.top||r!==e.left,p=(null==s?void 0:s.layoutType)!==e.config.layoutType,g=(m=c,f=d,!((v=s.layoutType)===u.Column?et(m.width,f.width):(v===u.Row||et(m.width,f.width))&&et(m.height,f.height)));var m,f,v;if(p||g||h)if(l=!0,g){const e={currentCardSize:d};a=!0,this.setState(e,(()=>{a&&this.refreshList()}))}else p&&this.handleResizeCard(this.state.currentCardSize,!0,!1,!1,!0);return a||((null==s?void 0:s.layoutType)===u.GRID?et(null==s?void 0:s.horizontalSpace,null===(i=e.config)||void 0===i?void 0:i.horizontalSpace)&&et(null==s?void 0:s.verticalSpace,null===(o=e.config)||void 0===o?void 0:o.verticalSpace):et(s.space,e.config.space))&&s.layoutType===e.config.layoutType||(a=!0,this.refreshList()),l},this.listDivSizeChange=(e,t,o,s)=>{var n;const{config:r,isHeightAuto:l}=this.props,{listDivSize:a}=this.state,d=dt(this.props,this.state),c=dt(e,t),h=ct(this.props),p=ct(e);if(d!==c||h!==p)if(l)s=!0;else if(r.layoutType===u.Column){let e=(null===(n=this.state.widgetRect)||void 0===n?void 0:n.height)||(null==a?void 0:a.clientHeight);if(e-=lt(this.paginatorDiv.current,d)+42*(h?1:0),e<i)return;const t={height:e,width:o.width};this.handleResizeCard(t,!0,!1,!1,!0)}return s},this.appModeChange=t=>{const{appMode:i,selectionIsSelf:o,selectionStatus:s,builderStatus:n}=this.props;t.appMode!==i&&(i===e.AppMode.Run?this.editBuilderAndSettingStatus(f.Regular):(s!==n&&(s?this.editBuilderAndSettingStatus(s):o||this.editBuilderAndSettingStatus(f.Regular)),this.setState({showSelectionOnly:!1,searchText:void 0,filterApplied:!1,hoverIndex:-1},(()=>{this.scrollToIndex(0)}))))},this.pageTypeChange=e=>{const{pageStyle:t}=this.props.config;t!==e.config.pageStyle&&this.setState({page:1})},this.useDatasourcesChange=e=>{const{useDataSources:t}=this.props,i=e.useDataSources;if(t&&t[0]){const e=i&&i[0];e&&e.dataSourceId===t[0].dataSourceId||this.setState({page:1})}else this.setState({datasource:void 0})},this.listSortChange=e=>{const{config:t}=this.props;t.sortOpen&&t.sorts!==e.config.sorts&&this.setState({sortOptionName:void 0})},this.listFilterChange=e=>{const{config:t}=this.props;t.filterOpen&&t.filter!==e.config.filter&&this.setState({currentFilter:void 0,filterApplied:!1})},this.setSelectionStatus=()=>{const{id:t,selectionIsInSelf:i}=this.props;this.props.dispatch(e.appActions.widgetStatePropChange(t,"selectionIsInSelf",i))},this.updateScrollContentSize=e=>{const{config:t}=this.props,i=(null==t?void 0:t.layoutType)===u.GRID?et(null==t?void 0:t.horizontalSpace,null==e?void 0:e.horizontalSpace)&&et(null==t?void 0:t.verticalSpace,null==e?void 0:e.verticalSpace):et(t.space,e.space);t.layoutType===e.layoutType&&i||this.setScrollContentSize()},this.scrollToSelectedItems=e=>{var t;const i=e.getSelectedRecordIds();if(this.isMySelected)return this.isMySelected=!1,void(this.lastSelectedRecordIds=i||[]);const o=this.checkIsSelectRecordsChange(e);if(i&&i.length>0&&o&&(o||this.needScroll)){const o=this.getNewAddedSelectedRecordsId(e),s=(null==o?void 0:o.length)>0?o:i;let n=-1;if(null===(t=null==this?void 0:this.records)||void 0===t||t.find(((e,t)=>{var i;if(!(null==e?void 0:e.getId))return!1;const o=null===(i=null==e?void 0:e.getId)||void 0===i?void 0:i.call(e);return!!(null==s?void 0:s.includes(o))&&(n=t,!0)})),-1===n){const t=e.getRecords();if(t&&t.find(((e,t)=>{var o;return(null===(o=e.getId)||void 0===o?void 0:o.call(e))===i[0]&&(n=t,!0)})),n>-1){const e=Math.ceil((n+1)/this.getPageSize());this.needScroll=!0,this.setState({page:e})}}else this.scrollToIndex(n),this.needScroll=!1,this.lastSelectedRecordIds=i||[]}},this.checkIsSelectRecordsChange=e=>{var t;const i=(null==e?void 0:e.getSelectedRecordIds())||[],o=(null==this?void 0:this.lastSelectedRecordIds)||[];return(null==i?void 0:i.length)!==(null==o?void 0:o.length)||(null===(t=null==i?void 0:i.filter((e=>!(null==o?void 0:o.includes(e)))))||void 0===t?void 0:t.length)>0},this.getNewAddedSelectedRecordsId=e=>{const t=this.lastSelectedRecordIds||[],i=e.getSelectedRecordIds()||[];return null==i?void 0:i.filter((e=>!(null==t?void 0:t.includes(e))))},this.onDSCreated=e=>{this.setState({datasource:e})},this.onResize=(e,t)=>{const o={width:e,height:t},{config:s}=this.props,{isResizingCard:n,currentCardSize:r}=this.state;if(n)return;const l=dt(this.props,this.state),a=lt(this.paginatorDiv.current,l),d=ct(this.props),c=at(o,a,d),h=this.getOldCardSizeWhenResize(o),p=s.layoutType===u.GRID?tt(this.props,o):r,g={width:p.width,height:p.height};let m=!et(null==r?void 0:r.width,null==p?void 0:p.width)||!et(null==r?void 0:r.height,null==p?void 0:p.height);if(s.lockItemRatio&&s.layoutType!==u.GRID){const t=g.width/g.height;switch(null==s?void 0:s.layoutType){case u.Column:g.height=c,g.width=c*t,et(g.width,h.width)||(m=!0);break;case u.Row:g.height=e/t,g.width=e,et(g.height,h.height)||(m=!0)}}else switch(null==s?void 0:s.layoutType){case u.Column:g.height=c;break;case u.Row:g.width=e}g.width<i||g.height<i||0===o.width||0===o.height||(this.setState({widgetRect:o,currentCardSize:g},(()=>{this.isHasInitCurrentCardSize=!0,this.editListSizeInRunTime(o),m&&this.refreshList()})),this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=void 0),s.lockItemRatio&&(this.resizeTimeout=setTimeout((()=>{this.handleResizeCard(g,!0,!1,!1,!0)}),500)),this.updateCardToolPosition(),this.setListDivSize())},this.getOldCardSizeWhenResize=e=>{const{currentCardSize:t}=this.state;return this.isHasInitCurrentCardSize?t:tt(this.props,e)},this.updateCardToolPosition=()=>{const{selectionIsSelf:e}=this.props,{hideCardTool:t}=this.state;e&&!t&&(this.setState({hideCardTool:!0}),this.updateCardToolTimeout&&(clearTimeout(this.updateCardToolTimeout),this.updateCardToolTimeout=void 0),this.updateCardToolTimeout=setTimeout((()=>{this.setState({hideCardTool:!1})}),500))},this.refreshList=(e=!0)=>{var t,i,o,s,n;this.listRef.current&&((null===(t=this.props.config)||void 0===t?void 0:t.layoutType)===u.GRID?this.resetAfterIndices():(null===(o=null===(i=this.listRef)||void 0===i?void 0:i.current)||void 0===o?void 0:o.resetAfterIndex)&&(null===(n=null===(s=this.listRef)||void 0===s?void 0:s.current)||void 0===n||n.resetAfterIndex(0,e)))},this.isDsConfigured=()=>{const{useDataSources:e}=this.props;return!!e&&!!e[0]},this.selectRecords=t=>{const{datasource:i}=this.state;if(i)if(e.MessageManager.getInstance().publishMessage(new e.DataRecordsSelectionChangeMessage(this.props.id,t)),t){this.isMySelected=!0,this.isHasPublishMessageAction=!0,i.selectRecordsByIds(t.map((e=>e.getId())));const e=this.getOutputDs();e&&e.selectRecordsByIds(t.map((e=>e.getId())))}else this.isHasPublishMessageAction=!1},this.formatMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:kt[e]},t),this.editStatus=(t,i)=>{const{dispatch:o,id:s}=this.props;o(e.appActions.widgetStatePropChange(s,t,i))},this.editWidgetConfig=e=>{window.jimuConfig.isInBuilder&&this.props.builderSupportModules.jimuForBuilderLib.getAppConfigAction().editWidgetConfig(this.props.id,e).exec()},this.scrollToIndex=(e,t="start")=>{const{config:i}=this.props;if(this.listRef.current)if((null==i?void 0:i.layoutType)===u.GRID){const i=this.getItemColumnCount(),o=Math.floor(e/i);this.listRef.current.scrollToItem({columnIndex:e-o*i,rowIndex:o,align:t})}else this.listRef.current.scrollToItem(e,t)},this.isEditing=()=>{const{appMode:t,config:i,selectionIsSelf:o,selectionIsInSelf:s}=this.props;return!!window.jimuConfig.isInBuilder&&(o||s)&&window.jimuConfig.isInBuilder&&t!==e.AppMode.Run&&i.isItemStyleConfirm},this.handleItemChange=e=>{const{config:t}=this.props,{datasource:i}=this.state;if(!i||!e)return;let o=i.getSelectedRecords()||[];if(t.cardConfigs[f.Selected].selectionMode&&t.cardConfigs[f.Selected].selectionMode!==n.None){const i=null==e?void 0:e.getId(),s=o.find((e=>e.getId()===i));t.cardConfigs[f.Selected].selectionMode===n.Single?s?(this.selectRecords([]),this.setState({showSelectionOnly:!1})):this.selectRecords([e]):(o=s?o.filter((e=>e.getId()!==i)):[e].concat(o),this.selectRecords(o))}},this.handleListPointerDown=e=>{this.setState({forceShowMask:!0}),this.mouseClickTimeout&&(clearTimeout(this.mouseClickTimeout),this.mouseClickTimeout=void 0),this.mouseClickTimeout=setTimeout((()=>{this.setState({forceShowMask:!1})}),200)},this.handleScrollUp=e=>{const t=this.getScrollStep();let i=this.getListVisibleStartIndex()-t;i<0&&(i=0),this.scrollToIndex(i,"start")},this.handleScrollDown=e=>{const t=this.getScrollStep(),{listVisibleStopIndex:i}=this,o=this.getListVisibleStartIndex();i+t>=this.records.length-1&&this.records.length<this.getTotalCount()?(this.isSwitchPage=!0,this.setState({page:this.state.page+1})):this.scrollToIndex(o+t,"start")},this.getScrollStep=()=>{const{scrollStep:e,layoutType:t}=this.props.config,i=this.getItemColumnCount();return t===u.GRID?e*i:e},this.handleSwitchPage=e=>{const t=this.getTotalPage();e<1||e>t||e!==this.state.page&&(this.isSwitchPage=!0,this.lastQueryStart=this.state.page,this.setState({page:e}))},this.handleListMouseLeave=()=>{this.isEditing()||this.setState({hoverIndex:-1})},this.handleListMouseMove=e=>{this.isEditing()||e!==this.state.hoverIndex&&this.setState({hoverIndex:e})},this.lastScrollOffset=0,this.handleListScroll=({scrollDirection:t,scrollOffset:i,scrollTop:o,scrollUpdateWasRequested:s})=>{var n,l;const{appMode:a,config:d}=this.props,c=this.listOutDivRef,{datasource:h,scrollStatus:p}=this.state;this.lastScrollOffset=(null==d?void 0:d.layoutType)===u.GRID?o:i,!c||(null!==(l=null===(n=this.records)||void 0===n?void 0:n.length)&&void 0!==l?l:0)<1||d.pageStyle!==r.Scroll||this.queryStatus===e.DataSourceStatus.Loading||!h||window.jimuConfig.isInBuilder&&a!==e.AppMode.Run||(this.isHasScrolled=!0,function(e,t){return!e||t<2}(c,this.lastScrollOffset)?"start"!==p&&this.setState({scrollStatus:"start"}):"mid"!==p&&this.setState({scrollStatus:"mid"}))},this.getTotalPage=()=>{const{totalCount:e}=this,{config:t}=this.props,i=e,o=Math.floor(i/t.itemsPerPage);return 0==i%t.itemsPerPage?o:o+1},this.getListVisibleStartIndex=()=>{const{lastScrollOffset:e}=this,{config:t}=this.props,i=this.itemSize(0),o=1*e/i;let s=Math.floor(o);const n=(o-s)*i,r=(null==t?void 0:t.layoutType)===u.GRID?null==t?void 0:t.verticalSpace:null==t?void 0:t.space,l=this.getItemColumnCount();return s=(null==t?void 0:t.layoutType)===u.GRID?s*l:s,n>i-r&&s++,s},this.handleSortOptionChange=(e,t)=>{this.setState({sortOptionName:t.label,page:1},(()=>{}))},this.handleSearchTextChange=e=>{""!==e&&e||this.handleSearchSubmit(void 0),this.setState({searchSuggestion:[]}),clearTimeout(this.suggestionsQueryTimeout),this.suggestionsQueryTimeout=setTimeout((()=>{this.getSearchSuggestions(e)}),200)},this.getSearchSuggestions=t=>{const{config:i}=this.props,{datasource:o}=this.state;if((null==t?void 0:t.length)<3)return!1;(function(t,i,o){var s;return S(this,void 0,void 0,(function*(){const n=i.searchFields.split(","),r={page:1,pageSize:10,outFields:n,returnDistinctValues:!0};if(i.searchOpen&&i.searchFields){const e=null===(s=y(t,i,o,!0))||void 0===s?void 0:s.sql;r.where=e}const l=new RegExp(`(${t})`,"gi");return function(t,i){return S(this,void 0,void 0,(function*(){return i?yield i.query(t,{scope:e.QueryScope.InRuntimeView}).then((e=>S(this,void 0,void 0,(function*(){return yield function(e,t){return S(this,void 0,void 0,(function*(){return yield Promise.resolve((null==t?void 0:t.records)||[])}))}(0,e)})))):yield Promise.resolve([])}))}(r,o).then((e=>S(this,void 0,void 0,(function*(){let i=[];return n.forEach((o=>{e.forEach((e=>{var s;const n=null===(s=null==e?void 0:e.feature)||void 0===s?void 0:s.attributes[o];if(n&&!i.includes(n)&&n.match(l)){const e={suggestionHtml:w(n,t),suggestion:n};i.push(e)}}))})),i=function(e,t){const i=e[0]?[e[0]]:[];for(let o=1;o<e.length;o++){const s=e[o];let n=!1;for(let e=0;e<i.length;e++)if(s[t]===i[e][t]){n=!0;break}n||i.push(s)}return i}(i,"suggestion"),Promise.resolve(i)}))))}))})(t,i,o).then((e=>{this.setState({searchSuggestion:e})}))},this.handleSearchSubmit=(e,t=!1)=>{(this.state.searchText!==e||t)&&this.setState({searchText:e,page:1},(()=>{}))},this.initNewCardSize=i=>{const{config:o}=this.props,{widgetRect:s}=this.state;let n=(0,e.Immutable)(i);const r=st(this.props);return r.width.unit===t.DistanceUnits.PERCENTAGE&&(n=n.set("width",100*i.width/(s.width+(null==o?void 0:o.horizontalSpace)-8)+"%")),r.height.unit===t.DistanceUnits.PERCENTAGE&&(n=n.set("height",100*i.height/s.height+"%")),null==n?void 0:n.asMutable({deep:!0})},this.handleFilterChange=e=>{this.setState({currentFilter:e,page:1},(()=>{}))},this.handleFilterApplyChange=e=>{const t={filterApplied:e,queryStart:0};this.setState(t,(()=>{}))},this.handleShowSelectionClick=e=>{const{showSelectionOnly:t}=this.state;this.setState({showSelectionOnly:!t})},this.handleClearSelectionClick=()=>{this.setState({showSelectionOnly:!1}),this.selectRecords([])},this.resetShowSelectionStatus=()=>{const{showSelectionOnly:e}=this.state;e&&this.setState({showSelectionOnly:!1})},this._getCurrentPage=()=>this.state.page,this.getTotalCount=()=>this.totalCount||0,this.selectCard=()=>{const{selectionIsInSelf:e}=this.props;e&&this.selectSelf()},this.editBuilderAndSettingStatus=e=>{this.editStatus("showCardSetting",e),this.editStatus("builderStatus",e)},this.editListSizeInRunTime=t=>{const{id:i,dispatch:o}=this.props;o(e.appActions.widgetStatePropChange(i,"widgetRect",t))},this.getSortItems=()=>{const{config:t}=this.props,i=[];return t.sorts&&t.sorts.forEach((e=>{e.rule&&e.rule.forEach((t=>{t&&t.jimuFieldName&&i.push({label:e.ruleOptionName,event:this.handleSortOptionChange})}))})),(0,e.Immutable)(i)},this.renderListTopTools=(i,o,s)=>{const{widgetRect:n,isSearchBoxVisible:r,isOpenTopToolsPopper:l}=this.state,a=(null==n?void 0:n.width)||620,d=ht(this.props),c=ut(this.props),u=this.formatMessage("listDataActionLabel",{layer:(null==i?void 0:i.getLabel())||""}),h=d?220:175;return(0,e.jsx)("div",{className:"datasource-tools w-100",css:(this.props,p=c,e.css`
    .list-data-action {
      & {
        padding-left: ${e.polished.rem(4)};
      }
      &::after {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        height: ${e.polished.rem(16)};
        border-left: 1px solid ${p?"var(--light-400)":"transparent"}
      }
    }
    .m-left {
      margin-left: ${e.polished.rem(4)};
    }
  `)},(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)("div",{className:"flex-grow-1 tool-row"},c&&(0,e.jsx)("div",null,a>=h&&(0,e.jsx)("div",{className:"tool-row row1 d-flex align-items-center w-100 justify-content-between"},this.renderSearchTools(i,o),(!r||a>=360)&&this.renderTopRightTools(i,o)),a<h&&(0,e.jsx)("div",{className:"float-right",ref:e=>this.reference=e},(0,e.jsx)(t.Button,{type:"tertiary",icon:!0,size:"sm",className:"tools-menu",title:this.formatMessage("guideStep9Title"),onClick:e=>{this.setState({isOpenTopToolsPopper:!l})}},(0,e.jsx)(wt,{size:16})),this.renderListTopToolsInPoper(i,o)))),i&&d&&(0,e.jsx)("div",{className:(0,e.classNames)("list-data-action position-relative",{"m-left":a<h}),"data-testid":"data-action"},(0,e.jsx)(t.DataActionDropDown,{type:"tertiary",widgetId:this.props.id,dataSet:{dataSource:i,records:s,name:u},size:"sm"}))),window.jimuConfig.isInBuilder&&this.isEditing()&&(0,e.jsx)("div",{className:"editing-mask-ds-tool"}));var p},this.renderListTopToolsInPoper=(i,o)=>{const{widgetRect:s,isSearchBoxVisible:n,isOpenTopToolsPopper:r}=this.state,l=this.isEditing(),a=((null==s?void 0:s.width)||620)<(ht(this.props)?220:175)&&r&&!l;return(0,e.jsx)("div",null,(0,e.jsx)(t.Popper,{placement:"bottom-start",reference:this.reference,offset:[-10,0],open:a,showArrow:!0,toggle:e=>{this.setState({isOpenTopToolsPopper:!a})}},(0,e.jsx)("div",{className:"tool-row row1 d-flex align-items-end justify-content-between",css:I(this.props)},this.renderSearchTools(i,o),!n&&this.renderTopRightTools(i,o))))},this.renderSearchTools=(i,o)=>{const s=this.isEditing()||!i||o!==e.DataSourceStatus.Loaded,{searchText:n,widgetRect:r,isSearchBoxVisible:l,showLoading:a}=this.state,d=(null==r?void 0:r.width)||620,{theme:c,config:u,appMode:h}=this.props,p=d<360?"ds-tools-line-blue":"",g=(null==u?void 0:u.searchHint)||this.formatMessage("search"),m=d<360&&l;return(0,e.jsx)("div",{className:"list-search-div flex-grow-1",css:C(this.props)},gt(this.props)&&(0,e.jsx)("div",{className:"d-flex search-box-content"},(d>=360||l)&&(0,e.jsx)("div",{className:"flex-grow-1 w-100"},(0,e.jsx)(Z,{theme:c,placeholder:g,searchText:n,onSearchTextChange:this.handleSearchTextChange,onSubmit:this.handleSearchSubmit,disabled:s,searchSuggestion:this.state.searchSuggestion,suggestionWidth:d,showLoading:a,formatMessage:this.formatMessage,isShowBackButton:m,toggleSearchBoxVisible:this.toggleSearchBoxVisible,className:"list-search ",appMode:h}),(0,e.jsx)("div",{className:(0,e.classNames)("ds-tools-line",p)})),d<360&&!l&&(0,e.jsx)(t.Button,{type:"tertiary",icon:!0,size:"sm",onClick:e=>{this.toggleSearchBoxVisible(!0)},title:this.formatMessage("search")},(0,e.jsx)(U,{size:16,color:c.colors.palette.light[800]}))))},this.toggleSearchBoxVisible=(e=!1)=>{const{widgetRect:t}=this.state;this.setState({isSearchBoxVisible:e});const i=ht(this.props)?220:175;((null==t?void 0:t.width)||620)<i&&(clearTimeout(this.showPopperTimeOut),this.showPopperTimeOut=setTimeout((()=>{this.setState({isOpenTopToolsPopper:!0})})))},this.getPageSize=()=>{const{widgetRect:e}=this.state,{config:t}=this.props,i=dt(this.props,this.state),o=at(e,lt(this.paginatorDiv.current,i),ct(this.props))||1,s=(null==t?void 0:t.layoutType)===u.GRID?this.getItemColumnCount():null;return Math.max(rt(e,o,this.props,s),1)},this.renderTopRightTools=(i,o)=>{const{sortOptionName:s,showSelectionOnly:n,currentFilter:r,filterApplied:l}=this.state,{config:a,theme:d,id:c,appMode:u}=this.props,h=this.getSortItems(),p=i&&i.getSelectedRecords(),g=p&&p.length>0;return(0,e.jsx)("div",{className:"d-flex align-items-center mr-1",ref:this.listTopRightToolsDiv},pt(this.props)&&(0,e.jsx)(A.Fragment,null,(0,e.jsx)(Te,{theme:d,items:h,appMode:u,toggleType:"tertiary",toggleArrow:!0,toggleContent:e=>s||h&&h[0].label,size:"sm",caret:!0,showActive:!0,toggleTitle:this.formatMessage("listSort"),activeLabel:s||h&&h[0].label})),mt(this.props)&&(0,e.jsx)(Ae,{filter:r||a.filter,filterInConfig:a.filter,appMode:u,applied:l,title:this.formatMessage("filter"),selectedDs:this.state.datasource,handleFilterChange:this.handleFilterChange,handleFilterApplyChange:this.handleFilterApplyChange,formatMessage:this.formatMessage,theme:d,widgetId:c}),ft(this.props)&&(0,e.jsx)(t.Button,{disabled:!g,type:"tertiary",title:n?this.formatMessage("showAll"):this.formatMessage("showSelection"),icon:!0,size:"sm",onClick:this.handleShowSelectionClick},n?(0,e.jsx)(wt,{size:16}):(0,e.jsx)(Rt,{size:16})),vt(this.props)&&(0,e.jsx)(t.Button,{disabled:!g,type:"tertiary",title:this.formatMessage("clearSelection"),icon:!0,size:"sm",onClick:this.handleClearSelectionClick},(0,e.jsx)(Ot,{size:16})))},this.renderList=(t,o)=>{const{widgetRect:s,isMount:n,currentCardSize:r}=this.state,{config:l,isRTL:a}=this.props,d=null==o?void 0:o.status;if(this.queryStatus=d,this.isHasRenderList=!0,!n)return!1;d===e.DataSourceStatus.Unloaded&&(t=void 0),this.getDsTotalCount(t,d);const c=this.getLoadingStatus(t,d),h=(null==t?void 0:t.getAutoRefreshInterval())||0;this.toggleAutoRefreshLoading(t,c);const p=dt(this.props,this.state),g=ct(this.props),m=at(s,lt(this.paginatorDiv.current,p),g)||1,f=s&&s.width||i,v=this.getOverscanCount(m),S=this.getDsSelectRecords(t),y=this.getDsRecords(t,c,m);this.isFirstLoad=!1,0===y.length&&this.resetShowSelectionStatus(),this.getlistInnerElementType();const w=this.getListStyle();return(0,e.jsx)("div",{"data-testid":"listContainer",className:"list-container animation",css:w},g&&this.renderListTopTools(t,d,S),(null==l?void 0:l.layoutType)===u.GRID&&(0,e.jsx)(Se,{className:(0,e.classNames)("widget-list-list",{"hide-list":!y||0===(null==y?void 0:y.length)}),ref:this.listRef,useIsScrolling:!0,outerRef:this.setListOutDivRef,direction:a?"rtl":"ltr",itemCount:this.records.length,overscanCount:v,itemKey:this.gridItemIndex,columnCount:this.getItemColumnCount(),columnWidth:e=>this.columnWidth(e,r.width,null==l?void 0:l.horizontalSpace),rowCount:this.getItemRowCount(),rowHeight:e=>this.rowHeight(e,r.height,null==l?void 0:l.verticalSpace),width:f,height:m,onItemsRendered:this.onItemsRendered,itemData:this.getItemsByRecords(this.records),innerElementType:this.innerElementType,onScroll:this.handleListScroll},this.itemRender),(null==l?void 0:l.layoutType)!==u.GRID&&(0,e.jsx)(Re,{className:(0,e.classNames)("widget-list-list",{"hide-list":!y||0===(null==y?void 0:y.length)}),ref:this.listRef,useIsScrolling:!0,outerRef:this.setListOutDivRef,direction:a?"rtl":"ltr",layout:l.layoutType===u.Column?"horizontal":"vertical",itemCount:this.records.length,overscanCount:v,itemKey:this.itemKey,width:f,height:m,onItemsRendered:this.onItemsRendered,itemData:this.getItemsByRecords(this.records),innerElementType:this.innerElementType,itemSize:this.itemSize,onScroll:this.handleListScroll},this.itemRender),this.checkIsShowListMask(c,y)&&(0,e.jsx)("div",{className:"editing-mask-con"},(0,e.jsx)("div",{className:"editing-mask-list"}),(null==l?void 0:l.layoutType)===u.GRID&&(0,e.jsx)("div",{className:"editing-mask-list-grid"})),p&&this.renderBottomTools(c),this.renderEmptyElement(c),d===e.DataSourceStatus.NotReady&&this.renderNotReadyTips(t),(c||h>0)&&this.renderLoading(c,h))},this.renderEmptyElement=t=>{var i;const o=!this.records||this.records.length<1,s=(null===(i=this.props.config)||void 0===i?void 0:i.noDataMessage)||this.formatMessage("noData");return!t&&o&&(0,e.jsx)("div",{className:"empty-con text-center"},(0,e.jsx)(zt,{size:16}),(0,e.jsx)("div",{className:"discribtion"},s))},this.clearMessageAction=()=>{this.handleClearSelectionClick(),e.MessageManager.getInstance().publishMessage(new e.DataRecordsSelectionChangeMessage(this.props.id,[]))},this.renderLoading=(t,i)=>{const{autoRefreshLoadingString:o}=this.state,{config:s}=this.props;let n=null==s?void 0:s.isShowAutoRefresh;return"boolean"!=typeof n&&(n=!0),(0,e.jsx)("div",{className:(0,e.classNames)("position-absolute refresh-loading-con d-flex align-items-center",this.getRefreshLoadingClass())},t&&(0,e.jsx)("div",{className:"loading-con"}),i>0&&n&&(0,e.jsx)("div",{className:"flex-grow-1 auto-refresh-loading"},o))},this.renderNotReadyTips=i=>{var o,s,n,r,l;const a=null==i?void 0:i.getLabel(),d=null===e.appConfigUtils||void 0===e.appConfigUtils?void 0:e.appConfigUtils.getWidgetIdByOutputDataSource(null===(s=null===(o=this.props)||void 0===o?void 0:o.useDataSources)||void 0===s?void 0:s[0]),c=null===(n=(0,e.getAppStore)().getState())||void 0===n?void 0:n.appConfig,u=null===(l=null===(r=null==c?void 0:c.widgets)||void 0===r?void 0:r[d])||void 0===l?void 0:l.label;return(0,e.jsx)("div",{className:"placeholder-alert-con"},(0,e.jsx)(t.Alert,{form:"tooltip",size:"small",type:"warning",text:this.formatMessage("outputDataIsNotGenerated",{outputDsLabel:a,sourceWidgetName:u})}))},this.renderBottomTools=t=>{const{scrollStatus:i,isScrollEnd:o}=this.state,{config:s,isRTL:n}=this.props;return(0,e.jsx)("div",{ref:this.paginatorDiv},(0,e.jsx)(Qe,{isRTL:n,totalPage:this.getTotalPage(),currentPage:this._getCurrentPage(),isEditing:this.isEditing(),isScrollEnd:o,pageStyle:s.pageStyle,layoutType:null==s?void 0:s.layoutType,scrollStatus:i,handleScrollUp:this.handleScrollUp,handleScrollDown:this.handleScrollDown,handleSwitchPage:this.handleSwitchPage,formatMessage:this.formatMessage,showLoading:t}))},this.getDsTotalCount=(t,i)=>{const o=null==t?void 0:t.count;this.queryStatus=i,i===e.DataSourceStatus.Loaded&&null!==o&&(this.totalCount!==o&&(this.setPageTimeout=setTimeout((()=>{this.setState({page:1})}),1)),this.totalCount=o)},this.getLoadingStatus=(t,i)=>{const{LayoutEntry:o}=this.state,{showLoading:s}=this.props;let n=!1;return(s||window.jimuConfig.isInBuilder&&!o||t&&i===e.DataSourceStatus.Loading)&&(n=!0),n},this.toggleAutoRefreshLoading=(e,t)=>{const i=(null==e?void 0:e.getAutoRefreshInterval())||0;this.resetAutoRefreshTimes(i,t),i>0&&this.setRefreshLoadingString(t)},this.setListOutDivRef=e=>{if(!e)return;const t=`bottomBoundary${this.props.id}`;this.listOutDivRef=e,this.setListDivSize();const i=document.createElement("div");i.id=t,i.className="bottom-boundary";const o=this.listOutDivRef.getElementsByTagName("div")[0];var s,n,r;this.setScrollContentSize(),o.appendChild(i),s=document.getElementById(t),n=this.listOutDivRef,r=this.intersectionObserverCallback,new IntersectionObserver((function(e,t){const i=e[0].intersectionRatio>0;r&&r(i)}),{root:n}).observe(s)},this.getDsRecords=(t,i,o)=>{const{showSelectionOnly:s,widgetRect:n}=this.state,{config:l,appMode:a}=this.props,d=(null==l?void 0:l.layoutType)===u.GRID?this.getItemColumnCount():null,c=rt(n,o,this.props,d),h=this.getDefaultRecords(c);let p=h;const g=this.getDsSelectRecords(t);return t&&l.isItemStyleConfirm&&(p=(null==t?void 0:t.dataViewId)===Pt?t&&(l.pageStyle===r.Scroll?t.getRecordsByPage(1,c*this.state.page):t.getRecordsByPage(this.state.page,c))||[]:t&&(l.pageStyle===r.Scroll?t.getRecordsByPageWithSelection(1,c*this.state.page):t.getRecordsByPageWithSelection(this.state.page,c))||[],s&&(p=g)),window.jimuConfig.isInBuilder&&a!==e.AppMode.Run&&!i&&p.length<1&&(p=h),i&&!this.isFirstLoad||(this.records=p),p},this.resetGridListAfterRowIndex=e=>{var t,i,o,s,n;if((null==this?void 0:this.records)&&(null===(t=this.records)||void 0===t?void 0:t.length)!==(null==e?void 0:e.length)){let e=this.getItemRowCount()-1;e=e>-1?e:0,(null===(o=null===(i=this.listRef)||void 0===i?void 0:i.current)||void 0===o?void 0:o.resetAfterIndices)&&(null===(n=null===(s=this.listRef)||void 0===s?void 0:s.current)||void 0===n||n.resetAfterRowIndex(e,!0))}},this.resetListAfterRecordChange=e=>{var t,i,o,s,n,r;(null==this?void 0:this.records)&&(null===(t=this.records)||void 0===t?void 0:t.length)!==(null==e?void 0:e.length)&&this.listRef.current&&((null===(i=this.props.config)||void 0===i?void 0:i.layoutType)===u.GRID?(null===(s=null===(o=this.listRef)||void 0===o?void 0:o.current)||void 0===s?void 0:s.resetAfterIndices)&&(null===(r=null===(n=this.listRef)||void 0===n?void 0:n.current)||void 0===r||r.resetAfterRowIndex(0,!0)):(this.resetTimeout&&clearTimeout(this.resetTimeout),this.resetTimeout=setTimeout((()=>{var e,t,i,o;(null===(t=null===(e=this.listRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.resetAfterIndex)&&(null===(o=null===(i=this.listRef)||void 0===i?void 0:i.current)||void 0===o||o.resetAfterIndex(0,!1))}),300)))},this.getDefaultRecords=(e=3)=>{e=e&&e>1?e:3;const t=[];for(let i=0;i<e;i++)t.push(Dt);return t},this.getDsSelectRecords=e=>{const{config:t}=this.props;let i;return e&&t.isItemStyleConfirm&&(i=e.getSelectedRecords()),i},this.getlistInnerElementType=()=>{const{config:t}=this.props,i=(null==t?void 0:t.layoutType)===u.GRID?null==t?void 0:t.verticalSpace:null==t?void 0:t.space;this.lastSpace!==i&&(this.lastSpace=i,this.innerElementType=(0,A.forwardRef)(((o,s)=>{var{style:n}=o,r=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(o,["style"]);return(0,e.jsx)("div",Object.assign({ref:s,style:Object.assign(Object.assign({},n),{height:parseFloat(n.height)-(t.layoutType===u.Column?0:i)+"px",width:parseFloat(n.width)-(t.layoutType!==u.Column?0:i)+"px"})},r))})))},this.getListStyle=()=>{var e,t;const{toolsDivWidth:i,currentCardSize:o,widgetRect:s}=this.state,{config:n,appMode:r,theme:l,isHeightAuto:a,isWidthAuto:d}=this.props,c=dt(this.props,this.state),u=lt(this.paginatorDiv.current,c),h=ct(this.props),p=tt(this.props,s),g={pageStyle:null==n?void 0:n.pageStyle,scrollBarOpen:null==n?void 0:n.scrollBarOpen,direction:null==n?void 0:n.direction,appMode:r,theme:l,isHeightAuto:a,isWidthAuto:d,currentCardSize:o,listTemplateDefaultCardSize:p,showTopTools:h,bottomToolH:u,topRightToolW:i,hasRecords:(null!==(t=null===(e=this.records)||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0,mexSize:this.getListMaxSize(),layoutType:null==n?void 0:n.layoutType,listLeftPadding:this.getListContentLeftPadding()};return b(g)},this.checkIsShowListMask=(e,t)=>{const{isInBuilder:i}=window.jimuConfig,o=this.isEditing(),s=!t||t.length<1;return i&&o&&!(!e&&s)},this.getOverscanCount=t=>{const{widgetRect:i}=this.state,{appMode:o,config:s}=this.props,n=(null==s?void 0:s.layoutType)===u.GRID?this.getItemColumnCount():null,r=rt(i,t,this.props,n);return window.jimuConfig.isInBuilder&&o!==e.AppMode.Run?0:r},this.setScrollContentSize=()=>{var e;if(!this.listOutDivRef)return;const{layoutType:t}=null===(e=this.props)||void 0===e?void 0:e.config,i=this.listOutDivRef.getElementsByTagName("div")[0];t===u.Column?i.style.height="100%":i.style.width="100%"},this.intersectionObserverCallback=t=>{var i,o;const{appMode:s,config:n}=this.props,l=this.listOutDivRef,{datasource:a}=this.state;this.setState({isScrollEnd:t}),!l||(null!==(o=null===(i=this.records)||void 0===i?void 0:i.length)&&void 0!==o?o:0)<1||n.pageStyle===r.Scroll&&this.queryStatus!==e.DataSourceStatus.Loading&&a&&(!window.jimuConfig.isInBuilder||s===e.AppMode.Run&&t)&&this.isHasScrolled&&(this.records.length<this.getTotalCount()?(this.setState({page:this.state.page+1}),this.isSwitchPage=!0):t&&this.setState({scrollStatus:"end"}))},this.setListDivSize=()=>{var e;const t=this.listOutDivRef,i=(null==t?void 0:t.clientWidth)||null,o=(null==t?void 0:t.clientHeight)||null,s=(null===(e=this.listTopRightToolsDiv.current)||void 0===e?void 0:e.clientWidth)||0,n=(null==t?void 0:t.getBoundingClientRect())||null,r={clientWidth:i,clientHeight:o};this.setState({listDivSize:r,toolsDivWidth:s,listDivBoundRect:n})},this.getContentLayout=()=>{const{layoutId:t,browserSizeMode:i}=this.props,o=(0,e.getAppStore)().getState().appConfig,s=v.searchUtils.getWidgetIdThatUseTheLayoutId(o,t);return v.searchUtils.getContentLayoutInfosInOneSizeMode(o,s,e.LayoutItemType.Widget,i)},this.getContentLayoutSetting=()=>{var t,i,o,s,n;const r=(0,e.getAppStore)().getState().appConfig,{layouts:l}=r,a=this.getContentLayout(),d=null===(t=null==a?void 0:a[0])||void 0===t?void 0:t.layoutId,c=null===(i=null==a?void 0:a[0])||void 0===i?void 0:i.layoutItemId;return null===(n=null===(s=null===(o=null==l?void 0:l[d])||void 0===o?void 0:o.content)||void 0===s?void 0:s[c])||void 0===n?void 0:n.setting},this.getListMaxSize=()=>{var t,i,o,s,n;const{boundingBox:r,heightLayoutItemSizeModes:l,layoutId:a,appMode:d,pageMode:c}=this.props,u=l===v.LayoutItemSizeModes.Custom&&(null==r?void 0:r.height),h=this.getContentLayoutSetting(),p="auto"===(null===(t=null==h?void 0:h.autoProps)||void 0===t?void 0:t.width)||"auto"===(null==h?void 0:h.widthMode),g="auto"===(null===(i=null==h?void 0:h.autoProps)||void 0===i?void 0:i.height)||"auto"===(null==h?void 0:h.heightMode)||!h,m=c===e.PageMode.AutoScroll&&g?600:this.bodySize.clientHeight,f=d===e.AppMode.Design?m:this.bodySize.clientHeight,S=u?null==r?void 0:r.height:f,y=u&&!((null===(o=null==r?void 0:r.height)||void 0===o?void 0:o.includes)&&(null===(s=null==r?void 0:r.height)||void 0===s?void 0:s.includes("%")));let w=(0,e.Immutable)({maxWidth:this.bodySize.scrollWidth,maxHeight:S});const b=(0,e.getAppStore)().getState().appConfig,{layouts:x}=b,I=null===(n=x[a])||void 0===n?void 0:n.type;if(I===e.LayoutType.ColumnLayout&&p&&(w=w.set("maxWidth",this.bodySize.clientWidth)),"ROW"===I&&g&&!y){const t=d===e.AppMode.Design?m:this.bodySize.clientHeight;w=w.set("maxHeight",t)}return w=w.set("maxHeight",this.initElementSize(w.maxHeight)),w=w.set("maxWidth",this.initElementSize(w.maxWidth)),w},this.initElementSize=e=>Number(e)?`${e}px`:"string"!=typeof e||(null==e?void 0:e.includes("px"))||(null==e?void 0:e.includes("rem"))?e:(null==e?void 0:e.includes("%"))?"100%":void 0,this.getRefreshLoadingClass=()=>{const{config:t,appMode:i}=this.props,{scrollBarOpen:o,layoutType:s}=t,n=window.jimuConfig.isInBuilder&&i===e.AppMode.Design;return!o||n?"":s===u.Column?"horizon-loading":"vertical-loading"},this.resetAutoRefreshTimes=(e,t=!1)=>{clearTimeout(this.resetAutoRefreshTime),e<=0&&clearInterval(this.autoRefreshLoadingTime),this.resetAutoRefreshTime=setTimeout((()=>{t&&e>0&&this.setState({autoRefreshLoadingString:this.formatMessage("lastUpdateAFewTime")}),this.setState({showLoading:t})}),0)},this.setRefreshLoadingString=(e=!1)=>{if(!e)return!1;let t=0;clearInterval(this.autoRefreshLoadingTime),this.autoRefreshLoadingTime=setInterval((()=>{t++,this.setState({autoRefreshLoadingString:this.getLoadingString(t)})}),6e4)},this.getLoadingString=e=>{let t=this.formatMessage("lastUpdateAFewTime");return e>1&&e<=2?t=this.formatMessage("lastUpdateAMinute"):e>2&&(t=this.formatMessage("lastUpdateTime",{updateTime:e})),t},this.onItemsRendered=({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:i,visibleStopIndex:o,visibleColumnStartIndex:s,visibleColumnStopIndex:n,visibleRowStartIndex:l,visibleRowStopIndex:a})=>{const{config:d}=this.props;this.listVisibleStartIndex=(null==d?void 0:d.layoutType)===u.GRID?this.getItemIndexByRowAndColumnIndex(l,s):i,this.listVisibleStopIndex=(null==d?void 0:d.layoutType)===u.GRID?this.getItemIndexByRowAndColumnIndex(a,n):o,this.needRefreshListOnListRendered&&(this.needRefreshListOnListRendered=!1,this.refreshList()),this.isSwitchPage&&(d.pageStyle===r.Scroll?this.records.length>this.listVisibleStopIndex+1&&(this.isSwitchPage=!1,this.onItemsRenderedTimeout=setTimeout((()=>{this.handleScrollDown(null)}),500)):this.isSwitchPage=!1)},this.getItemIndexByRowAndColumnIndex=(e,t)=>e*this.getItemColumnCount()+t,this.itemSize=e=>{const{config:t}=this.props,{currentCardSize:i}=this.state,o=(null==t?void 0:t.layoutType)===u.Column,s=(null==t?void 0:t.layoutType)===u.GRID?null==t?void 0:t.verticalSpace:null==t?void 0:t.space,n=i.width+s,r=i.height+s;return o?n:r},this.columnWidth=(e,t,i=0)=>t+i,this.rowHeight=(e,t,i=0)=>t+i,this.getItemsByRecords=t=>{const{config:i,selectionIsInSelf:o,selectionIsSelf:s,builderStatus:n,appMode:r,queryObject:l,useDataSources:a}=this.props,{datasource:d,hoverIndex:c}=this.state,u=(d&&i.isItemStyleConfirm?d.getSelectedRecordIds():[]).map((e=>e+""));return t&&t.map(((t,h)=>{const p=0===h&&window.jimuConfig.isInBuilder&&r===e.AppMode.Design?{hideCardTool:this.state.hideCardTool,selectionIsList:s,selectionIsInList:o,isEditing:this.isEditing(),builderStatus:n,lockItemRatio:i.lockItemRatio,changeIsResizingCard:this.changeIsResizingCard}:{linkParam:i.linkParam,queryObject:l,useDataSources:a};return Object.assign(Object.assign({index:h,isHover:c===h,record:i.isItemStyleConfirm?t:void 0,active:!t.fake&&i.isItemStyleConfirm&&d&&u.includes(t.getId())},this.getOtherProps()),p)}))},this.getOtherProps=()=>{var e,i;const{config:o,theme:s,id:r,appMode:l,builderSupportModules:a,layouts:d,browserSizeMode:c,dispatch:u,isRTL:h}=this.props,{datasource:p}=this.state,g=(null===(i=null===(e=st(this.props))||void 0===e?void 0:e.width)||void 0===i?void 0:i.unit)===t.DistanceUnits.PERCENTAGE;return{browserSizeMode:c,space:o.space,isRTL:h,builderSupportModules:a,formatMessage:this.formatMessage,dispatch:u,widgetId:r,interact:window.jimuConfig.isInBuilder&&a.widgetModules.interact,selectCard:this.selectCard,handleResizeCard:this.handleResizeCard,appMode:l,onChange:this.handleItemChange,hoverLayoutOpen:o.cardConfigs[f.Hover].enable,selectable:o.cardConfigs[f.Selected].selectionMode!==n.None,direction:o.direction,theme:s,LayoutEntry:this.state.LayoutEntry,layouts:d,layoutType:null==o?void 0:o.layoutType,keepAspectRatio:null==o?void 0:o.keepAspectRatio,gridItemSizeRatio:null==o?void 0:o.gridItemSizeRatio,cardConfigs:o.cardConfigs,datasourceId:p&&p.id,updateCardToolPosition:this.updateCardToolPosition,isWidthPercentage:g,horizontalSpace:null==o?void 0:o.horizontalSpace}},this.itemRender=t=>{var i;const{appMode:o,config:s}=this.props;let n=t.style;const r=(null==t?void 0:t.columnIndex)||0,l=(null==t?void 0:t.rowIndex)||0,a=this.getItemRowCount(),d=this.getItemColumnCount(),c=(null==s?void 0:s.layoutType)===u.GRID?this.getItemIndexByRowAndColumnIndex(l,r):t.index,h=t.data,p=((null===(i=this.records)||void 0===i?void 0:i.length)||0)-1===c;let g;switch(null==s?void 0:s.layoutType){case u.Column:g={width:parseFloat(n.width)-s.space+"px",height:"100%"};break;case u.Row:g={width:"100%",height:parseFloat(n.height)-s.space+"px"};break;case u.GRID:g={height:parseFloat(n.height)-(null==s?void 0:s.verticalSpace)+"px",width:parseFloat(null==n?void 0:n.width)-(null==s?void 0:s.horizontalSpace)+"px"}}switch(null==s?void 0:s.layoutType){case u.Column:n=Object.assign(Object.assign({},n),{width:p?parseFloat(n.width)-s.space+"px":`${parseFloat(n.width)}px`});break;case u.Row:n=Object.assign(Object.assign({},n),{height:p?parseFloat(n.height)-s.space+"px":`${parseFloat(n.height)}px`});break;case u.GRID:n=Object.assign(Object.assign({},n),{height:a===l+1?parseFloat(n.height)-(null==s?void 0:s.verticalSpace)+"px":`${parseFloat(n.height)}px`,width:d===r+1?parseFloat(null==n?void 0:n.width)-(null==s?void 0:s.horizontalSpace)+"px":`${parseFloat(null==n?void 0:n.width)}px`})}const m=0===c&&window.jimuConfig.isInBuilder&&o===e.AppMode.Design?E:N;return(null==h?void 0:h.length)<c+1?null:(0,e.jsx)("div",{style:n},(0,e.jsx)(m,Object.assign({listStyle:g,widgetId:this.props.id},h[c],{handleListMouseMove:this.handleListMouseMove,handleListMouseLeave:this.handleListMouseLeave,itemIdex:c})))},this.itemKey=e=>{const t=this.records[e];return`${(null==t?void 0:t.getId)&&(null==t?void 0:t.getId())||e}`},this.gridItemIndex=e=>{const{columnIndex:t,rowIndex:i}=e,o=this.getItemIndexByRowAndColumnIndex(i,t),s=this.records[o];return`${(null==s?void 0:s.getId)&&(null==s?void 0:s.getId())||o+100}`},this.getItemColumnCount=()=>{const{widgetRect:e,currentCardSize:t}=this.state,{config:o}=this.props;let s=e&&e.width||i;s-=8;const n=t.width+(null==o?void 0:o.horizontalSpace);return Math.floor((s-t.width)/n+1)||1},this.getItemRowCount=()=>Math.ceil(this.records.length/this.getItemColumnCount())||1,this.getListContentLeftPadding=()=>{const{widgetRect:e,currentCardSize:o}=this.state,{config:s}=this.props,n=e&&e.width||i,r=this.getItemColumnCount()*(o.width+(null==s?void 0:s.horizontalSpace))-(null==s?void 0:s.horizontalSpace);let l;switch(null==s?void 0:s.gridAlignment){case t.TextAlignValue.LEFT:l=0;break;case t.TextAlignValue.RIGHT:l=n-r-8;break;default:l=(n-r-8)/2}return(null==s?void 0:s.layoutType)===u.GRID&&l>0?l:0};const{config:s}=o;this.paginatorDiv=e.React.createRef(),this.listTopRightToolsDiv=e.React.createRef();const l={LayoutEntry:null,page:1,sortOptionName:s.sorts&&s.sorts[0]&&s.sorts[0].ruleOptionName,currentCardSize:tt(o,ot(o)),forceShowMask:!1,widgetRect:ot(o),showList:!0,searchText:"",currentFilter:void 0,filterApplied:!1,showSelectionOnly:!1,hideCardTool:!1,scrollStatus:"start",datasource:void 0,hoverIndex:-1,isScrolling:!1,isScrollSpeedOver:!1,isResizingCard:!1,searchSuggestion:[],isSearchBoxVisible:!1,isOpenTopToolsPopper:!1,latestUpdateTime:0,showLoading:!1,autoRefreshLoadingString:"",listDivSize:{clientWidth:null,clientHeight:null},toolsDivWidth:null,listDivBoundRect:null,isScrollEnd:!1,isMount:!1};this.selectSelf=this.selectSelf.bind(this),this.handleResizeCard=this.handleResizeCard.bind(this),this.listRef=e.React.createRef(),window.jimuConfig.isInBuilder?l.LayoutEntry=this.props.builderSupportModules.LayoutEntry:l.LayoutEntry=v.LayoutEntry,this.state=l,this.onResize=this.onResize.bind(this),this.changeIsResizingCard=this.changeIsResizingCard.bind(this),this.setRefreshLoadingString=this.setRefreshLoadingString.bind(this),this.resetAutoRefreshTimes=this.resetAutoRefreshTimes.bind(this),this.debounceOnResize=e.lodash.debounce(((e,t)=>this.onResize(e,t)),200),this.debounceResetAfterIndices=e.lodash.debounce((()=>this.resetAfterIndices()),200)}componentDidMount(){this.setState({isMount:!0}),this.getBodySize(),window.addEventListener("resize",this.getBodySize)}componentWillUnmount(){clearTimeout(this.resizeTimeout),clearTimeout(this.updateCardToolTimeout),clearTimeout(this.mouseClickTimeout),clearTimeout(this.suggestionsQueryTimeout),clearTimeout(this.showPopperTimeOut),clearTimeout(this.resetAutoRefreshTime),clearTimeout(this.setPageTimeout),clearTimeout(this.onItemsRenderedTimeout),clearInterval(this.autoRefreshLoadingTime)}componentDidUpdate(t,i){var o;const{config:s,appMode:r}=this.props,{datasource:l}=this.state;if(!window.jimuConfig.isInBuilder||r===e.AppMode.Run){const e=s.cardConfigs[f.Selected].selectionMode!==n.None;l&&e&&this.scrollToSelectedItems(l)}this.updateListInBuilder(t,i),this.appModeChange(t),(null==t?void 0:t.selectionIsInSelf)!==(null===(o=this.props)||void 0===o?void 0:o.selectionIsInSelf)&&this.setSelectionStatus(),this.setListLayoutInWidgetState(),this.setListParentSizeInWidgetState()}changeIsResizingCard(e){this.setState({isResizingCard:e})}handleResizeCard(e,t=!1,i,o,s=!1){if(t){const n=this.initNewCardSize(e);window.jimuConfig.isInBuilder&&this.props.builderSupportModules.widgetModules.handleResizeCard(this.props,n,i,o,t,s)}else this.setState({currentCardSize:e},(()=>{this.refreshList(!1)}))}selectSelf(){window.jimuConfig.isInBuilder&&this.props.builderSupportModules.widgetModules.selectSelf(this.props)}getOutputDs(){const t=this.props.outputDataSources&&this.props.outputDataSources[0],i=this.props.useDataSources&&this.props.useDataSources[0];if(t&&i)return e.DataSourceManager.getInstance().getDataSource(t)}render(){const{config:i,id:o,appMode:s,browserSizeMode:n,selectionIsInSelf:r,selectionIsSelf:a,useDataSources:d,builderStatus:c,layouts:h}=this.props,p=(0,e.getAppStore)().getState().appConfig,{forceShowMask:g,datasource:m,widgetRect:f,page:S}=this.state,w=window.jimuConfig.isInBuilder,b=(0,e.classNames)("jimu-widget","widget-list","list-widget-"+o);if(!i.itemStyle)return(0,e.jsx)(t.WidgetPlaceholder,{widgetId:this.props.id,icon:l(65354),message:this.formatMessage("placeHolderTip")});const I=dt(this.props,this.state),C=at(f,lt(this.paginatorDiv.current,I),ct(this.props)),R=(null==i?void 0:i.layoutType)===u.GRID?this.getItemColumnCount():null,T=rt(f,C,this.props,R);this.pageSize=T;const M=T;let O=function(t,i,o){var s,n,r;const l={returnGeometry:!0},{config:a,stateProps:d,useDataSources:c}=i,{sortOptionName:u,searchText:h,currentFilter:p,filterApplied:g,datasource:m}=t,f=c&&c[0];if(!m||!f)return null;if(!m.query)return null;let v;if(a.sortOpen&&a.sorts&&(v=a.sorts.find((e=>e.ruleOptionName===u)),v=v||a.sorts[0],(null===(n=null===(s=null==v?void 0:v.rule)||void 0===s?void 0:s[0])||void 0===n?void 0:n.jimuFieldName)||(v=void 0),v)){const e=[];v.rule.forEach((t=>{t.jimuFieldName&&e.push(`${t.jimuFieldName} ${t.order}`)})),l.orderByFields=e}if(a.filterOpen&&g&&a.filter&&p&&p.sql&&(l.where=(l.where||"1=1")+" AND ",l.where+=`(${p.sql})`),d){const t=null==d?void 0:d[e.MessageType.ExtentChange];t&&(l.geometry=t.queryExtent,t.querySQL&&(l.where=(l.where||"1=1")+" AND ",l.where+=`(${t.querySQL})`));const i=d[e.MessageType.DataRecordsSelectionChange];i&&i.querySQL&&(l.where=(l.where||"1=1")+" AND ",l.where+=`(${i.querySQL})`)}if(a.searchOpen&&a.searchFields&&h){l.where=(l.where||"1=1")+" AND ";const e=null===(r=y(h,a,m))||void 0===r?void 0:r.sql;l.where+=e}return o>0&&(l.page=t.page,l.pageSize=o),l}(this.state,this.props,M);if(!function(t,i,o){return!!o&&(t=o.getRealQueryParams(t,"query"),i=o.getRealQueryParams(i,"query"),!(!t||!i)&&(delete t.page,delete t.pageSize,delete t.resultOffset,delete t.resultRecordCount,delete i.page,delete i.pageSize,delete i.resultOffset,delete i.resultRecordCount,e.utils.isDeepEqual(t,i)))}(O,this.lastQuery,m)&&m){const e=O;1!==S?(O=this.lastQuery,this.lastQuery=e,this.setState({page:1})):this.lastQuery=e}const L=null==p?void 0:p.layouts[v.searchUtils.findLayoutId(h[c],n,p.mainSizeMode)],j=L&&L.type;return(0,e.jsx)("div",{className:b,css:x(this.props,this.isEditing(),I),onPointerDown:t=>w&&s!==e.AppMode.Run&&!a&&!r&&this.handleListPointerDown(t)},(0,e.jsx)("div",{className:"widget-list d-flex"},this.isDsConfigured()?(0,e.jsx)(e.DataSourceComponent,{query:m?O:null,useDataSource:d&&d[0],onDataSourceCreated:this.onDSCreated,widgetId:this.props.id,queryCount:!0},this.renderList):this.renderList(),!this.isHasRenderList&&(0,e.jsx)("div",{className:"list-loading-con w-100 h-100"},(0,e.jsx)("div",{className:"jimu-secondary-loading"}))),w&&s!==e.AppMode.Run&&(g||!r&&!a||!i.isItemStyleConfirm&&j)&&(0,e.jsx)("div",{className:"list-with-mask"}),(0,e.jsx)(e.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:this.debounceOnResize}))}}Et.versionManager=Je,Et.mapExtraStateProps=(e,t)=>{var i,o,s,n,r,l,a,d,c,u,h,p,g,m,S,y,w,b,x,I,C,R;const T=e&&e.appConfig,{layouts:M,layoutId:O,layoutItemId:L,builderSupportModules:j,id:z}=t,D=e&&e.browserSizeMode,k=e&&e.widgetsState&&e.widgetsState[t.id]&&e.widgetsState[t.id].builderStatus||f.Regular;let P;if(T){const t=T&&e.appConfig.layouts&&e.appConfig.layouts[v.searchUtils.findLayoutId(M[k],D,T.mainSizeMode)];P=t&&t.type}const E=null===(i=T.layouts)||void 0===i?void 0:i[O],A=null===(s=null===(o=null==E?void 0:E.content)||void 0===o?void 0:o[L])||void 0===s?void 0:s.setting,N=(null===(n=null==A?void 0:A.autoProps)||void 0===n?void 0:n.height)===v.LayoutItemSizeModes.Auto||!0===(null===(r=null==A?void 0:A.autoProps)||void 0===r?void 0:r.height),$=(null===(l=null==A?void 0:A.autoProps)||void 0===l?void 0:l.width)===v.LayoutItemSizeModes.Auto||!0===(null===(a=null==A?void 0:A.autoProps)||void 0===a?void 0:a.width);let B;if(window.jimuConfig.isInBuilder){const e=null===(h=null===(u=null===(c=null===(d=T.layouts)||void 0===d?void 0:d[O])||void 0===c?void 0:c.content)||void 0===u?void 0:u[L])||void 0===h?void 0:h.bbox;B=e&&{left:e.left,top:e.top}}const _=e&&e.appRuntimeInfo&&e.appRuntimeInfo.selection,H=_&&j&&j.widgetModules&&j.widgetModules.selectionInList(_,z,T,!1);let F;H&&(F=Object.keys(M).find((e=>v.searchUtils.findLayoutId(M[e],D,T.mainSizeMode)===_.layoutId)));const U=!(!_||_.layoutId!==O||_.layoutItemId!==L),W=null===(p=null==e?void 0:e.appRuntimeInfo)||void 0===p?void 0:p.currentPageId,G=null===(S=null===(m=null===(g=null==e?void 0:e.appConfig)||void 0===g?void 0:g.pages)||void 0===m?void 0:m[W])||void 0===S?void 0:S.mode;return{selectionIsSelf:U,selectionIsInSelf:!!H,selectionStatus:F,appMode:null===(y=null==e?void 0:e.appRuntimeInfo)||void 0===y?void 0:y.appMode,browserSizeMode:e&&e.browserSizeMode,builderStatus:e&&e.widgetsState&&e.widgetsState[t.id]&&e.widgetsState[t.id].builderStatus||f.Regular,showLoading:null===(b=null===(w=null==e?void 0:e.widgetsState)||void 0===w?void 0:w[t.id])||void 0===b?void 0:b.showLoading,isRTL:e&&e.appContext&&e.appContext.isRTL,subLayoutType:P,left:B&&B.left,top:B&&B.top,isHeightAuto:N,isWidthAuto:$,queryObject:e.queryObject,boundingBox:null===(I=null===(x=null==E?void 0:E.content)||void 0===x?void 0:x[L])||void 0===I?void 0:I.bbox,heightLayoutItemSizeModes:null===(C=null==A?void 0:A.autoProps)||void 0===C?void 0:C.height,parentSize:(null===(R=e.widgetsState[t.id])||void 0===R?void 0:R.parentSize)||null,pageMode:G}};const At=Et})(),a})())}}}));