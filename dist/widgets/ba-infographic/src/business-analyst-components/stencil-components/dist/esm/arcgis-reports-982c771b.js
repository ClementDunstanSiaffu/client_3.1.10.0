class ACLUtils{static notDef(e){return null==e}static isDef(e){return!ACLUtils.notDef(e)}static hasText(e){return ACLUtils.isDef(e)&&"string"==typeof e&&e.length>0&&e.trim().length>0}static isNumber(e){return!isNaN(parseFloat(e))&&!isNaN(e-0)}static _hasProperty(e,t){return ACLUtils.hasText(e[t])}static fixId(e){return!e||e.length<=0?"":"#"===e[0]?e:"#"+e}static parseThemeString(e){return this.hasText(e)?JSON.parse(e):{}}static parseBufferSizes(e){if(null==typeof e)return[1];let t=[];try{if(!this.hasText(e))return[1];{let r=e.split(",");for(let e=0;e<r.length;e++){if(e>=3)continue;let n=parseFloat(r[e]);t.push(n)}}}catch(e){return console.log(e),[1]}return t}}var TokenProvider=function(){function e(){}return e.getToken=function(){return new Promise((function(t){t(e.token.access_token)}))},e.setToken=function(e,t){e&&e.length>0&&t&&t.length>0&&(this.token.access_token=t,this.token.username=e)},e.token={access_token:"_It_RKcC9CUuiX4PdwbaLdMO9AQYfjZjTHy-YMDVkOPXEdMpbznCnLpWRgqYsL8II7Yqs2OTRr8VwMEI60Td8T8i4xgVcsnQgkv-7e1IxuV-0jAzK94fScw6Blt4T4t7RTGm13zpCqeF0yVTk_9PXGJ-41OHwBtI_cRYemQ1OvEO3l3CuJGOT8cqn_sZbM3Ut2Dr6MYrgvGLw8h3wNg6NkQskDX_9WJeW9Ur4UU2odk.",expires_in:null,persist:"true",ssl:"true",username:"mark_ba"},e}(),__awaiter$4=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator$4=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},SettingsHelper=function(){function e(){}return e.getEnvironment=function(){return new Promise((function(t){t(e.environment)}))},e.setEnvironment=function(e){e&&e.length>0?this.environment=e:console.log("ba-reports error: setEnvironment with invalid args")},e.getPortalBaseUrl=function(){return __awaiter$4(this,void 0,void 0,(function(){var t;return __generator$4(this,(function(r){switch(r.label){case 0:return[4,e.getEnvironment()];case 1:return t=r.sent(),console.log("env:",t),[2,"https://"+("dev"===t?"devext":"qa"===t?"qaext":"www")+".arcgis.com"]}}))}))},e.isTrueString=function(e){return"true"===String(e).toLowerCase()},e.environment="prod",e}(),__awaiter$3=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator$3=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ArcGISClient=function(){function e(){}return e.executeSelf=function(){return new Promise((function(t,r){TokenProvider.getToken().then((function(n){n===e._lastSelfToken?t(e._selfResult):e.executeRequest({taskPath:"/portals/self",data:{culture:"en-us"}}).then((function(r){e._lastSelfToken=n,e._selfResult=r,t(r)})).catch((function(t){e._lastSelfToken="",e._selfResult="",r(t)}))})).catch((function(e){return r(e)}))}))},e.getGeoenrichmentUrl=function(){return e.getHelperServiceUrl("geoenrichment")},e.getHelperServiceUrl=function(t){return new Promise((function(r,n){e.executeSelf().then((function(e){var o=e.helperServices;if(o){var i=o[t];if(i){var a=Array.isArray(i)?i[0].url:i.url;a?r(a):n(t+" helper service is not configured.")}else n(t+" helper service is not configured.")}else n("Helper services are not configured.")})).catch((function(e){return n(e)}))}))},e.getPortalResource=function(t){return e.executeRequest({taskPath:"/portals/self/resources/"+t})},e.getItemData=function(t){return e.executeRequest({taskPath:"/content/items/"+t+"/data"})},e.searchAllItems=function(e,t){var r=this;return new Promise((function(n,o){var i=[],a=r,s=function(e,t,r){a.searchItems(e,t,r).then((function(r){r.items.length&&(i=i.concat(r.items));var o=r.context;o.nextStart>0?s(e,t,o):n(i)}),(function(e){i&&i.length?n(i):o(e)}))};s(e,t,null)}))},e.searchItems=function(t,r,n){return new Promise((function(o,i){var a=r?JSON.parse(JSON.stringify(r)):{};if(n){a.q=r.q;var s=n.total,c=n.nextStart;s&&c&&(c>0&&s>=c?a.start=c:o({items:[],context:n})),n.sortField&&n.sortOrder&&(a.sortOrder=n.sortOrder,a.sortField=n.sortField)}else{var u=[];Object.getOwnPropertyNames(t).forEach((function(e){u.push(e+':"'+t[e]+'"')})),u.length&&(a.q=u.join(" AND "))}e.portalSearch(a).then((function(e){var t=e.results,r={query:e.query,total:e.total,nextStart:e.nextStart,sortOrder:null,sortField:null};a.sortOrder&&a.sortField&&(r.sortOrder=a.sortOrder,r.sortField=a.sortField),o({items:t,context:r})})).catch(i)}))},e.portalSearch=function(t){return e.executeRequest({taskPath:"/search",data:t})},e.getPortalUrl=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$3(this,(function(e){switch(e.label){case 0:return[4,SettingsHelper.getPortalBaseUrl()];case 1:return[2,e.sent()+"/sharing/rest"]}}))}))},e.executeRequest=function(t){var r=this;return new Promise((function(n,o){TokenProvider.getToken().then((function(i){return __awaiter$3(r,void 0,void 0,(function(){var r,a,s;return __generator$3(this,(function(c){switch(c.label){case 0:for(a in t.data||(t.data={}),t.data.f||(t.data.f="json"),t.data.token=i,t.data.langCode="en-us",r=new FormData,t.data)r.append(a,t.data[a]);return Object.prototype.hasOwnProperty.call(t,"url")?(s=t.url,[3,3]):[3,1];case 1:return[4,e.getPortalUrl()];case 2:s=c.sent(),c.label=3;case 3:return t.taskPath&&(s+=t.taskPath),fetch(s,{method:"POST",body:r}).then((function(e){if(!e.ok)throw new Error("Network response ended with error.");return"bin"===t.data.f?e.blob():e.json()})).then((function(e){e.error?o(e.error):n(e)})).catch((function(e){console.error("Error:",e),o(e)})),[2]}}))}))})).catch((function(e){return o(e)}))}))},e}(),WebAppSettings=function(){function e(){}return e.getBusinessAnalystOrganizationalSettings=function(){return ArcGISClient.getPortalResource("BusinessAnalyst_Organizational_Settings.json")},e.getDisabledReports=function(){return new Promise((function(t){var r=function(e){t({}),console.log(e)};ArcGISClient.executeSelf().then((function(n){var o=n.user.roleId||n.user.role;e.getBusinessAnalystOrganizationalSettings().then((function(e){var r=e["userRoles.disabledAreas.reports"];r&&r[o]?t(r[o]):t({})})).catch(r)})).catch(r)}))},e.getUserGalleryInfographicReportIds=function(){return new Promise((function(t,r){e._searchGalleryInfographicPreferencesItem().then((function(e){if(e){var n=e.id;ArcGISClient.getItemData(n).then((function(e){t(e&&e.data&&e.data.myGalleryInfographicReportIds)})).catch((function(e){return r(e)}))}else r(null)})).catch((function(e){return r(e)}))}))},e._searchGalleryInfographicPreferencesItem=function(){return e._searchUserItem("esriFavoriteReportTemplates")},e._searchUserItem=function(e){return new Promise((function(t,r){ArcGISClient.executeSelf().then((function(n){var o=n.user.username,i={type:"Web Mapping Application",typekeywords:e,owner:o};ArcGISClient.searchItems(i,{num:1},void 0).then((function(e){t(e&&e.length&&e[0])})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},e}(),__awaiter$2=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator$2=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ReportTemplatesManager=function(){function e(){}return e._condenseResultsArray=function(e){return e.map((function(e){return{id:e.id,title:e.title}}))},e.getDefaultHierarchy=function(e){return new Promise((function(t,r){GEClient.execute({taskPath:"/Geoenrichment/Countries/"+e}).then((function(e){for(var n,o=0;o<e.countries[0].hierarchies.length;o++){var i=e.countries[0].hierarchies[o];if(i.default){n=i.ID.toString();break}}n?t(n):r()})).catch(r)}))},e.getReportTemplates=function(t,r){return void 0===r&&(r=!1),new Promise((function(n,o){var i={ge:void 0,shared:void 0,user:void 0,favoriteIds:void 0};ArcGISClient.executeSelf().then((function(a){var s=a.user.username;Promise.allSettled([e._getSharedCustomReportTemplateItems(s),e._getMyCustomReportTemplateItems(s),e._getFavoriteReportsIds(s,t)]).then((function(a){i.ge=a[0].value?a[0].value:[],i.shared=e._createReportTemplateInfos(a[1]&&a[1].value?a[1].value:[],t),i.user=e._createReportTemplateInfos(a[2]&&a[2].value?a[2].value:[],t),i.favoriteIds=a[3]&&a[3].value?a[3].value:[],WebAppSettings.getDisabledReports().then((function(t){var o=i.ge,a=i.shared;null!=o&&(i.ge=o.filter((function(e){return!t[e.reportID]})),null!=a&&(i.shared=a.filter((function(e){return!t[e.reportID.itemid]})))),r||(i.ge=e._condenseResultsArray(i.ge),i.shared=e._condenseResultsArray(i.shared),i.user=e._condenseResultsArray(i.user),i.favoriteIds=e._condenseResultsArray(i.favoriteIds)),n(i)})).catch((function(e){return o(e)}))}))})).catch((function(e){return o(e)}))}))},e._getGEReportTemplates=function(t){return new Promise((function(r,n){var o=e._geReportTemplatesCache[t];o?r(o):GEClient.execute({taskPath:"/GeoEnrichment/Reports/"+t}).then((function(n){var o=n.reports;e._geReportTemplatesCache[t]=o,r(o)})).catch(n)}))},e._getSharedCustomReportTemplateItems=function(t){var r='type:"Report Template" (access:shared OR access:org) typekeywords:(esriWebReport NOT esriWebInfographicReport) NOT owner:'+t;return e._searchItems(r,e._removeInfographicTemplates)},e._getMyCustomReportTemplateItems=function(t){var r='type:"Report Template" typekeywords:(esriWebReport NOT esriWebInfographicReport) owner:'+t;return e._searchItems(r,e._removeInfographicTemplates)},e._removeInfographicTemplates=function(e){return!SettingsHelper.isTrueString(e.properties.isGraphicReport)},e.getInfographicReportTemplateItems=function(t,r){var n=this;return void 0===r&&(r=!1),new Promise((function(o,i){var a={public:void 0,shared:void 0,user:void 0,favoriteIds:void 0};ArcGISClient.executeSelf().then((function(s){var c=s.user.username,u=s.user.orgId;Promise.allSettled([e._getEsriInfographicReportTemplateItems(),e._getSharedInfographicReportTemplateItems(c,u),e._getUserInfographicReportTemplateItems(c),e._getFavoriteReportsIds(c,t)]).then((function(s){return __awaiter$2(n,void 0,void 0,(function(){var n,c,u,l,f,h,p;return __generator$2(this,(function(g){switch(g.label){case 0:return n=e._byCountry(t),a.public=s[0].value?s[0].value.filter(n):[],a.shared=s[1].value?s[1].value.filter(n):[],a.user=s[2].value?s[2].value.filter(n):[],a.favoriteIds=s[3].value?s[3].value:[],console.log(a),null!=(c=a.user)&&c.sort((function(e,t){return e.title.localeCompare(t.title)})),[4,e.getDefaultHierarchy(t)];case 1:return u=g.sent(),l=function(e){return e.properties.hierarchy===u},null!=(f=a.public)&&(a.public=f.filter(l)),null!=(h=a.shared)&&(a.shared=h.filter(l)),null!=(p=a.user)&&(a.user=p.filter(l)),console.log(a.public),WebAppSettings.getDisabledReports().then((function(t){var n=function(e){return!t[e.id]},i=a.public;null!=i&&(a.public=i.filter(n));var s=a.shared;null!=s&&(a.shared=s.filter(n)),r||(a.public=e._condenseResultsArray(a.public),a.shared=e._condenseResultsArray(a.shared),a.user=e._condenseResultsArray(a.user),a.favoriteIds=e._condenseResultsArray(a.favoriteIds)),o(a)})).catch((function(e){return i(e)})),[2]}}))}))}))})).catch((function(e){return i(e)}))}))},e._byCountry=function(e){return function(t){var r=t&&t.properties&&t.properties.countries.toLowerCase();return r&&r.indexOf(e.toLowerCase())>=0}},e._getEsriInfographicReportTemplateItems=function(){return e._searchItems('type:"Report Template" typekeywords:esriWebStandardInfographicReport owner:esri_reports',e._infographicFilter)},e._getSharedInfographicReportTemplateItems=function(t,r){var n='type:"Report Template" (access:shared OR access:org OR (access:public AND orgid:'+r+"))  typekeywords:esriWebInfographicReport  NOT owner:"+t;return e._searchItems(n,e._infographicFilter)},e._getUserInfographicReportTemplateItems=function(t){return new Promise((function(r,n){var o='type:"Report Template" typekeywords:esriWebInfographicReport  owner:'+t,i=e._searchItems(o,e._infographicFilter),a=e._getUserGalleryInfographicReportTemplateItems();Promise.allSettled([i,a]).then((function(e){var t=e[0].value?e[0].value:[],n=e[1].value?e[1].value:[];r(t.concat(n))}),(function(e){n(e)}))}))},e._getFavoriteReportsIds=function(t,r){return new Promise((function(n,o){var i='type:"Web Mapping Application" typekeywords:"BAUserData.FavoriteReports" owner:'+t;e._searchItems(i,null).then((function(e){var t=e&&e[0];t?ArcGISClient.getItemData(t.id).then((function(e){if(e){var t=e.data&&e.data["favorites"+r];if(t){var o=t.map((function(e){return e.reportID}));n(o)}else n([])}else n([])})).catch((function(e){return o(e)})):n([])})).catch((function(e){return o(e)}))}))},e._getUserGalleryInfographicReportTemplateItems=function(){return new Promise((function(t,r){WebAppSettings.getUserGalleryInfographicReportIds().then((function(n){if(n&&n.length){var o=n.map((function(e){return"id:"+e})).join(" OR ");e._searchItems(o,e._infographicFilter).then((function(e){t(e)})).catch((function(e){return r(e)}))}else t([])})).catch((function(e){return r(e)}))}))},e._searchItems=function(e,t){return new Promise((function(r,n){var o={start:1,num:1e3,sortField:"title",sortOrder:"asc",q:e};ArcGISClient.searchAllItems({},o).then((function(e){var n=t?e.filter(t):e;r(n)})).catch((function(e){return n(e)}))}))},e._createReportTemplateInfos=function(e,t){var r=[];return e.forEach((function(e){var n=e.properties;if(n){var o=n.countries;if(SettingsHelper.isTrueString(n.isComparisonReport))return;if(o&&-1!==o.indexOf(t)){var i={reportID:{itemid:e.id},formats:n.formats&&n.formats.split(","),headers:[],metadata:{author:n.author,categories:[],countries:o,coverage:n.coverage,hierarchy:n.hierarchy,keywords:n.keywords,owner:e.owner,title:e.title,type:n.type}};r.push(i)}}})),r},e._infographicFilter=function(e){var t=e.properties;return SettingsHelper.isTrueString(t.isGraphicReport)&&!SettingsHelper.isTrueString(t.isSingleInfographic)&&!SettingsHelper.isTrueString(t.isHidden)&&!SettingsHelper.isTrueString(t.isBlank)},e._geReportTemplatesCache={},e}(),__awaiter$1=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator$1=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},GEClient=function(){function e(){}return e.getInfographicTemplatesList=function(e,t){return void 0===t&&(t=!1),__awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(r){switch(r.label){case 0:return[4,ReportTemplatesManager.getInfographicReportTemplateItems(e||"US",t)];case 1:return[2,r.sent()]}}))}))},e.getClassicReportsTemplatesList=function(e,t){return void 0===t&&(t=!1),__awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(r){switch(r.label){case 0:return[4,ReportTemplatesManager.getReportTemplates(e||"US",t)];case 1:return[2,r.sent()]}}))}))},e.getDefaultHierarchy=function(e){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return[4,ReportTemplatesManager.getDefaultHierarchy(e)];case 1:return[2,t.sent()]}}))}))},e.execute=function(e){return new Promise((function(t,r){ArcGISClient.getGeoenrichmentUrl().then((function(n){var o=e?JSON.parse(JSON.stringify(e)):{};o.data||(o.data={}),o.data.forStorage=!1,ArcGISClient.executeRequest({url:n+o.taskPath,data:o.data}).then(t).catch(r)})).catch(r)}))},e.createReport=function(e){return new Promise((function(t,r){ArcGISClient.getGeoenrichmentUrl().then((function(n){var o=n.toString()+"/GeoEnrichment/CreateReport";ArcGISClient.executeRequest({url:o,data:e}).then(t).catch(r)})).catch(r)}))},e.enrich=function(e){var t=this;return new Promise((function(r,n){return __awaiter$1(t,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,SettingsHelper.getPortalBaseUrl()];case 1:return t=i.sent(),o="https://www.arcgis.com"===t?"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver/Geoenrichment/Enrich":"https://qaext.arcgis.com"===t?"https://geoenrichqa.arcgis.com/arcgis/rest/services/World/geoenrichmentserver/Geoenrichment/Enrich":"https://devext.arcgis.com"===t?"https://geoenrichdev.arcgis.com/arcgis/rest/services/World/geoenrichmentserver/Geoenrichment/Enrich":"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver/Geoenrichment/Enrich",console.log("enrichURL",o),e.forStorage=!1,ArcGISClient.executeRequest({url:o,data:e}).then((function(e){var t=e&&e.results&&e.results.length&&e.results[0],o=t&&t.value&&t.value.FeatureSet&&t.value.FeatureSet.length&&t.value.FeatureSet[0];if(o.features&&o.features.length)r(e);else{var i=e&&e.messages&&e.messages.length&&e.messages[0].description;i||(i="getfacts-no-data"),n(i)}}),(function(e){n(e)})),[2]}}))}))}))},e}(),__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function setToken(e,t){try{return null!=e&&e.length>0?null!=t&&t.length>0?(TokenProvider.setToken(e,t),"ok"):"invalid token":"invalid username"}catch(e){return e}}function setEnvironment(e){try{return null!=e&&e.length>0?(SettingsHelper.setEnvironment(e),"ok"):"invalid environment"}catch(e){return e}}function getInfographicTemplatesList(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,GEClient.getInfographicTemplatesList(e,t)];case 1:return[2,r.sent()]}}))}))}function getClassicReportsTemplatesList(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,GEClient.getClassicReportsTemplatesList(e,t)];case 1:return[2,r.sent()]}}))}))}export{ACLUtils as A,GEClient as G,SettingsHelper as S,TokenProvider as T,setEnvironment as a,getClassicReportsTemplatesList as b,getInfographicTemplatesList as g,setToken as s};