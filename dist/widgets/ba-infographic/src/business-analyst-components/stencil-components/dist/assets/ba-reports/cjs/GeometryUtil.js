"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var DebugLog_1=__importDefault(require("./DebugLog")),GeometryUtil=function(){function e(){}return e.getRings=function(e,t,i,s){if(!s||s.length<=0||s.length>3||"miles"!=i&&"kilometers"!=i||!e||!t)throw console.log("GeometryUtil: invalid args",e,t,s),"GeometryUtil: invalid args";for(var a=[],r=0;r<s.length;r++){var n=this.getAnalysisAreaRings(e,t,i,s,r);a.push(n)}return a},e.i18n=function(e){return e},e.getAnalysisAreaRings=function(t,i,s,a,r){if(!t||!i||null==s||!a||a.length<0||a.length>3)throw DebugLog_1.default.log("arcgis-infographic analysisAreas invalid args: ",t,i,s,a),"GeometryUtil.getAnalysisAreaRings: invalid args";var n=1==a[r]?"miles"==s?e.i18n("mile"):e.i18n("kilometer"):"miles"==s?e.i18n("miles"):e.i18n("kilometers");function l(){var t="miles"==s?" "+e.i18n("mile"):" "+e.i18n("kilometer");return"Ring: "+a[r]+t+" radius"}function o(){return a[r]+" "+n}function A(){return a[r]+" "+n}var u={feature:{geometry:{rings:[]},attributes:{RING:r+1,DESCRIPTION:"",latitude:t,longitude:i,name:o(),shortName:A(),description:l(),symbol:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:t,longitude:i,location:{geometry:{x:i,y:t,spatialReference:{wkid:4326}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}},name:o(),address:"",shortName:A(),locationName:o(),description:l()},g=e._generateRing(t,i,s,a[r]);return u.feature.geometry.rings.push(g),u},e.getAnalysisAreasFromRings=function(e){for(var t={analysisAreas:[]},i=0;i<e.length;i++){var s=e[i],a="minutes"==s.units.toLowerCase(),r=s.units.toLowerCase(),n=a?"minutes":r.indexOf("miles")>=0?"miles":"kilometers",l=n.substr(0,n.length-1),o=s.value.toString()+" "+l+" "+s.transport,A=a?" Time: ":" Distance: ",u=s.value.toString()+" "+(1==s.value)?l:n,g=("drive"==s.transport?"Drive":"Walk")+A+u,S={feature:{geometry:{rings:s.rings,spatialReference:{wkid:4326}},attributes:{RING:i,SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:s.latitude,longitude:s.longitude,name:"",address:"",shortName:o,locationName:"",description:g,location:{geometry:{x:s.longitude,y:s.latitude,spatialReference:{wkid:"4326"}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}}};t.analysisAreas.push(S)}var d=JSON.stringify(t).replace('{"analysisAreas"','"analysisAreas"');return d.substr(0,d.length-1)},e.getAnalysisAreasFromPolygon=function(e){if(!(e&&e.rings&&e.spatial&&e.latitude&&e.longitude))return DebugLog_1.default.log("getAnalysisAreasFromPolygon","invalid args",e),"";var t={analysisAreas:[{feature:{geometry:{rings:e.rings,spatialReference:e.spatial},attributes:{RING:1,SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:e.latitude,longitude:e.longitude,description:"feature polygon"}]},i=JSON.stringify(t).replace('{"analysisAreas"','"analysisAreas"');return i.substr(0,i.length-1)},e.getAnalysisAreasFromEnrichBuffers=function(e){if(!e||e.length<=0)return DebugLog_1.default.log("getAnalysisAreasFromEnrichBuffers","invalid args",e),"";for(var t,i,s={analysisAreas:[],spatialReference:e[0].spatial},a=0;a<e.length;a++){var r=e[a];if(r&&r.latitude&&r.longitude&&r.rings){var n="minutes"==r.units.toLowerCase(),l=1==r.value,o=r.units.toLowerCase(),A=n?"minutes":o.toLowerCase().indexOf("miles")>=0?"miles":"kilometers",u=A.substr(0,A.length-1),g=r.value.toString()+" "+u+" "+r.transport,S=n?" Time: ":" Distance: ",d=r.value.toString()+" "+l?u:A,m=("drive"==r.transport?"Drive":"Walk")+S+d;t||(t=r.latitude),i||(i=r.longitude);var y={feature:{geometry:{rings:r.rings},attributes:{RING:1,SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:t,longitude:i,description:m,shortName:g,location:{geometry:{x:i,y:t,spatialReference:{wkid:4326}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}}};s.analysisAreas.push(y)}}var h=JSON.stringify(s).replace('{"analysisAreas"','"analysisAreas"');return h.substr(0,h.length-1)},e.getDemoPolygon=function(){return'"analysisAreas": [       {         "feature": {           "geometry": {             "rings": [               [                 [                   -118.000083501802,                   34.0609396322877                 ],                 [                   -118.000083501802,                   34.0700406810389                 ],                 [                   -118.000083501802,                   34.0791407522251                 ],                 [                   -118.000083501802,                   34.0882398457216                 ],                 [                   -117.989097176058,                   34.0882398457216                 ],                 [                   -117.989097176058,                   34.0973379614042                 ],                 [                   -117.978110850314,                   34.1064350991486                 ],                 [                   -117.96712452457,                   34.1064350991486                 ],                 [                   -117.956138198827,                   34.1064350991486                 ],                 [                   -117.956138198827,                   34.1155312878821                 ],                 [                   -117.956138198827,                   34.1246264693743                 ],                 [                   -117.945151873083,                   34.1246264693743                 ],                 [                   -117.945151873083,                   34.1155312878821                 ],                 [                   -117.945151873083,                   34.1064350991486                 ],                 [                   -117.945151873083,                   34.0973379614042                 ],                 [                   -117.945151873083,                   34.0882398457216                 ],                 [                   -117.945151873083,                   34.0791407522251                 ],                 [                   -117.956138198827,                   34.0791407522251                 ],                 [                   -117.956138198827,                   34.0700406810389                 ],                 [                   -117.96712452457,                   34.0700406810389                 ],                 [                   -117.978110850314,                   34.0700406810389                 ],                 [                   -117.978110850314,                   34.0609396322877                 ],                 [                   -117.989097176058,                   34.0609396322877                 ],                 [                   -118.000083501802,                   34.0609396322877                 ]               ]             ],             "spatialReference": {               "wkid": 4326             }           },           "attributes": {             "OBJECTID": 6,             "NAME": "06 103",             "DESCRIPTION": "Area: 8.1 square miles",             "CREATED": 1518736922977,             "MODIFIED": 1518736922977,             "CREATOR": "fasil_ba",             "EDITOR": "fasil_ba",             "REGION": "US",             "FLAGS": 2,             "SYMBOL": {"color":[255,255,178,230],"outline":{"color":[0,0,0,255],"width":1.5,"type":"esriSLS","style":"esriSLSSolid","marker":null},"type":"esriSFS","style":"esriSFSSolid"},             "STATEFP": "06",             "UNSDLEA": "03690",             "GEOID": "0603690",             "NAME_": "Baldwin Park Unified School District",             "LSAD": "00",             "LOGRADE": "KG",             "HIGRADE": "12",             "MTFCC": "G5420",             "SDTYP": " ",             "FUNCSTAT": "E",             "ALAND": 22081431,             "AWATER": 626574,             "INTPTLAT": "+34.0896602",             "INTPTLON": "-117.9687223",             "GEOID2": 603690,             "COUNT_": 0,             "COUNT_1": 0,             "OID1": 75,             "YEAR_1": 1314,             "COUNTY_1": 19,             "DISTRICT_1": 1964287,             "DISTRICT_2": "Baldwin Park Unified",             "GEOGRAPH_1": "Baldwin Park Unified School District, CA",             "GEOID_12": 603690,             "HISP_1": 16310,             "PCTHISP_1": 86.91,             "AMIND_1": 62,             "PCTAMIND_1": 0.33,             "ASIAN_1": 731,             "PCTASIAN_1": 3.9,             "PAC_1": 32,             "PCTPAC_1": 0.17,             "FIL_1": 326,             "PCTFIL_1": 1.74,             "AFAM_1": 635,             "PCTAFAM_1": 3.38,             "WHITE_1": 552,             "PCTWHITE_1": 2.94,             "TWOORMOR_1": 107,             "PCTTWOOR_1": 0.57,             "NONEREPO_1": 12,             "PCTNONER_1": 0.06,             "TOTAL_1": 18767,             "NONWHITE_1": 18203,             "PCTNONWH_1": 97,             "SHAPE__Area": null,             "SHAPE__Length": null           }         },         "name": "06 103",         "address": "06 103",         "shortName": "06 103",         "description": "Area: 8.1 square miles"       }]'},e._generateRing=function(e,t,i,s){e&&t&&("miles"==i||"kilometers"==i)&&null!=s||console.log("ERROR: _generateRing invalid args [",e,t,i,s,"]");var a=[];function r(e){return e*Math.PI/180}function n(e){return 180*e/Math.PI}for(var l="miles"==i?1609.344*s:1e3*s,o=r(e),A=r(t),u=l/6371e3,g=0;g<=360;g+=4){var S=r(g),d=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(S)),m=(A+Math.atan2(Math.sin(S)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(d))+Math.PI)%(2*Math.PI)-Math.PI,y=[];y.push(n(m)),y.push(n(d)),a.push(y)}return a},e}();exports.default=GeometryUtil;