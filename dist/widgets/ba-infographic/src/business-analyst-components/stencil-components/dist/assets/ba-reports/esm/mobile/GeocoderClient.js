import{BaReportsLanguage}from"./Lang";import Environments from"../Environments";var GeocoderClient=function(){function e(e,o){this.token=e,this.geocoderUrl=o||Environments.getUrl("geocode"),this.geocoderUrl.endsWith("/")||(this.geocoderUrl+="/")}return e.prototype.suggest=function(e,o){var t=this;return new Promise((function(n,r){if(e&&e.length){var i=new URLSearchParams({text:e});(null==o?void 0:o.location)&&i.set("location",o.location),t._request(t.geocoderUrl+"suggest",i).then((function(e){n(e.suggestions)})).catch((function(e){r(e)}))}else n([])}))},e.prototype.geocode=function(e,o){var t=this;return new Promise((function(n,r){if(e&&e.length){var i=new URLSearchParams({maxLocations:(null==o?void 0:o.maxLocations)||10,singleLine:e});(null==o?void 0:o.location)&&i.set("location",o.location),(null==o?void 0:o.outFields)&&i.set("outFields",o.outFields),(null==o?void 0:o.magicKey)&&i.set("magicKey",o.magicKey),t._request(t.geocoderUrl+"findAddressCandidates",i).then((function(e){n(e)})).catch((function(e){r(e)}))}else n([])}))},e.prototype._request=function(e,o){var t=this;return new Promise((function(n,r){o.set("token",t.token),o.set("f","json");var i=e+"?"+o.toString();fetch(i,{method:"GET"}).then((function(e){if(!e.ok)throw new Error(BaReportsLanguage.i18n("network-response-error"));return e.json()})).then((function(e){e.error?r(e.error):n(e)})).catch((function(e){r(e)}))}))},e}();export default GeocoderClient;